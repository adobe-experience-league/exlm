/**
 * @license
 *
 * Copyright 2023 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Dx=Object.create;var cl=Object.defineProperty;var Vx=Object.getOwnPropertyDescriptor;var Nx=Object.getOwnPropertyNames;var Mx=Object.getPrototypeOf,Lx=Object.prototype.hasOwnProperty;var Qx=t=>cl(t,"__esModule",{value:!0});var Bx=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Se=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var jx=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Nx(e))!Lx.call(t,a)&&a!=="default"&&cl(t,a,{get:()=>e[a],enumerable:!(r=Vx(e,a))||r.enumerable});return t},Ge=t=>jx(Qx(cl(t!=null?Dx(Mx(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Pf=Se((dq,Af)=>{"use strict";function Rv(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(t=`${t}`,t=t.replace(/[ \t\n\f\r]/g,""),t.length%4==0&&(t=t.replace(/==?$/,"")),t.length%4==1||/[^+/0-9A-Za-z]/.test(t))return null;let e="",r=0,a=0;for(let n=0;n<t.length;n++)r<<=6,r|=Pv(t[n]),a+=6,a===24&&(e+=String.fromCharCode((r&16711680)>>16),e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255),r=a=0);return a===12?(r>>=4,e+=String.fromCharCode(r)):a===18&&(r>>=2,e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255)),e}var Av="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Pv(t){let e=Av.indexOf(t);return e<0?void 0:e}Af.exports=Rv});var Ef=Se((pq,wf)=>{"use strict";function wv(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let e;for(t=`${t}`,e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return null;let r="";for(e=0;e<t.length;e+=3){let a=[void 0,void 0,void 0,void 0];a[0]=t.charCodeAt(e)>>2,a[1]=(t.charCodeAt(e)&3)<<4,t.length>e+1&&(a[1]|=t.charCodeAt(e+1)>>4,a[2]=(t.charCodeAt(e+1)&15)<<2),t.length>e+2&&(a[2]|=t.charCodeAt(e+2)>>6,a[3]=t.charCodeAt(e+2)&63);for(let n=0;n<a.length;n++)typeof a[n]=="undefined"?r+="=":r+=Iv(a[n])}return r}var Ev="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Iv(t){if(t>=0&&t<64)return Ev[t]}wf.exports=wv});var Dl=Se((fq,If)=>{"use strict";var kv=Pf(),Ov=Ef();If.exports={atob:kv,btoa:Ov}});var $m=Se((yT,_m)=>{"use strict";var ud=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;if(!ud)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!ud.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');_m.exports.AbortController=ud.AbortController});var Km=Se((ET,Ym)=>{Ym.exports=fetch});var Jm=Se(fi=>{"use strict";var xs=fi&&fi.__assign||function(){return xs=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},xs.apply(this,arguments)};Object.defineProperty(fi,"__esModule",{value:!0});var Zb={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function eR(t){var e=xs(xs({},Zb),t);return e.numOfAttempts<1&&(e.numOfAttempts=1),e}fi.getSanitizedOptions=eR});var Xm=Se(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});function tR(t){var e=Math.random()*t;return Math.round(e)}fd.fullJitter=tR});var Zm=Se(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});function rR(t){return t}md.noJitter=rR});var eg=Se(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});var aR=Xm(),nR=Zm();function oR(t){switch(t.jitter){case"full":return aR.fullJitter;case"none":default:return nR.noJitter}}gd.JitterFactory=oR});var Sd=Se(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});var iR=eg(),sR=function(){function t(e){this.options=e,this.attempt=0}return t.prototype.apply=function(){var e=this;return new Promise(function(r){return setTimeout(r,e.jitteredDelay)})},t.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(t.prototype,"jitteredDelay",{get:function(){var e=iR.JitterFactory(this.options);return e(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){var e=this.options.startingDelay,r=this.options.timeMultiple,a=this.numOfDelayedAttempts,n=e*Math.pow(r,a);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),t}();hd.Delay=sR});var tg=Se(Sr=>{"use strict";var cR=Sr&&Sr.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var o in n)n.hasOwnProperty(o)&&(a[o]=n[o])},t(e,r)};return function(e,r){t(e,r);function a(){this.constructor=e}e.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),uR=Sr&&Sr.__awaiter||function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function s(l){try{u(a.next(l))}catch(d){i(d)}}function c(l){try{u(a.throw(l))}catch(d){i(d)}}function u(l){l.done?o(l.value):n(l.value).then(s,c)}u((a=a.apply(t,e||[])).next())})},lR=Sr&&Sr.__generator||function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},a,n,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(o=u[0]&2?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],n=0}finally{a=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Sr,"__esModule",{value:!0});var dR=Sd(),pR=function(t){cR(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.apply=function(){return uR(this,void 0,void 0,function(){return lR(this,function(r){return[2,this.isFirstAttempt?!0:t.prototype.apply.call(this)]})})},Object.defineProperty(e.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),e}(dR.Delay);Sr.SkipFirstDelay=pR});var rg=Se(mi=>{"use strict";var fR=mi&&mi.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var o in n)n.hasOwnProperty(o)&&(a[o]=n[o])},t(e,r)};return function(e,r){t(e,r);function a(){this.constructor=e}e.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(mi,"__esModule",{value:!0});var mR=Sd(),gR=function(t){fR(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(mR.Delay);mi.AlwaysDelay=gR});var ag=Se(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});var hR=tg(),SR=rg();function yR(t,e){var r=CR(t);return r.setAttemptNumber(e),r}yd.DelayFactory=yR;function CR(t){return t.delayFirstAttempt?new SR.AlwaysDelay(t):new hR.SkipFirstDelay(t)}});var ng=Se(xa=>{"use strict";var Cd=xa&&xa.__awaiter||function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function s(l){try{u(a.next(l))}catch(d){i(d)}}function c(l){try{u(a.throw(l))}catch(d){i(d)}}function u(l){l.done?o(l.value):n(l.value).then(s,c)}u((a=a.apply(t,e||[])).next())})},xd=xa&&xa.__generator||function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},a,n,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(o=u[0]&2?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],n=0}finally{a=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(xa,"__esModule",{value:!0});var xR=Jm(),vR=ag();function FR(t,e){return e===void 0&&(e={}),Cd(this,void 0,void 0,function(){var r,a;return xd(this,function(n){switch(n.label){case 0:return r=xR.getSanitizedOptions(e),a=new bR(t,r),[4,a.execute()];case 1:return[2,n.sent()]}})})}xa.backOff=FR;var bR=function(){function t(e,r){this.request=e,this.options=r,this.attemptNumber=0}return t.prototype.execute=function(){return Cd(this,void 0,void 0,function(){var e,r;return xd(this,function(a){switch(a.label){case 0:if(this.attemptLimitReached)return[3,7];a.label=1;case 1:return a.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return a.sent(),[4,this.request()];case 3:return[2,a.sent()];case 4:return e=a.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(r=a.sent(),!r||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(t.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),t.prototype.applyDelay=function(){return Cd(this,void 0,void 0,function(){var e;return xd(this,function(r){switch(r.label){case 0:return e=vR.DelayFactory(this.options,this.attemptNumber),[4,e.apply()];case 1:return r.sent(),[2]}})})},t}()});var Ns=Se((Od,qd)=>{(function(t,e){typeof Od=="object"&&typeof qd!="undefined"?qd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs=e()})(Od,function(){"use strict";var t=1e3,e=6e4,r=36e5,a="millisecond",n="second",o="minute",i="hour",s="day",c="week",u="month",l="quarter",d="year",f="date",p="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(B){var q=["th","st","nd","rd"],V=B%100;return"["+B+(q[(V-20)%10]||q[V]||q[0])+"]"}},C=function(B,q,V){var _=String(B);return!_||_.length>=q?B:""+Array(q+1-_.length).join(V)+B},F={s:C,z:function(B){var q=-B.utcOffset(),V=Math.abs(q),_=Math.floor(V/60),M=V%60;return(q<=0?"+":"-")+C(_,2,"0")+":"+C(M,2,"0")},m:function B(q,V){if(q.date()<V.date())return-B(V,q);var _=12*(V.year()-q.year())+(V.month()-q.month()),M=q.clone().add(_,u),Y=V-M<0,Z=q.clone().add(_+(Y?-1:1),u);return+(-(_+(V-M)/(Y?M-Z:Z-M))||0)},a:function(B){return B<0?Math.ceil(B)||0:Math.floor(B)},p:function(B){return{M:u,y:d,w:c,d:s,D:f,h:i,m:o,s:n,ms:a,Q:l}[B]||String(B||"").toLowerCase().replace(/s$/,"")},u:function(B){return B===void 0}},D="en",Q={};Q[D]=v;var te="$isDayjsObject",ae=function(B){return B instanceof he||!(!B||!B[te])},oe=function B(q,V,_){var M;if(!q)return D;if(typeof q=="string"){var Y=q.toLowerCase();Q[Y]&&(M=Y),V&&(Q[Y]=V,M=Y);var Z=q.split("-");if(!M&&Z.length>1)return B(Z[0])}else{var ce=q.name;Q[ce]=q,M=ce}return!_&&M&&(D=M),M||!_&&D},X=function(B,q){if(ae(B))return B.clone();var V=typeof q=="object"?q:{};return V.date=B,V.args=arguments,new he(V)},K=F;K.l=oe,K.i=ae,K.w=function(B,q){return X(B,{locale:q.$L,utc:q.$u,x:q.$x,$offset:q.$offset})};var he=function(){function B(V){this.$L=oe(V.locale,null,!0),this.parse(V),this.$x=this.$x||V.x||{},this[te]=!0}var q=B.prototype;return q.parse=function(V){this.$d=function(_){var M=_.date,Y=_.utc;if(M===null)return new Date(NaN);if(K.u(M))return new Date;if(M instanceof Date)return new Date(M);if(typeof M=="string"&&!/Z$/i.test(M)){var Z=M.match(m);if(Z){var ce=Z[2]-1||0,ge=(Z[7]||"0").substring(0,3);return Y?new Date(Date.UTC(Z[1],ce,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,ge)):new Date(Z[1],ce,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,ge)}}return new Date(M)}(V),this.init()},q.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},q.$utils=function(){return K},q.isValid=function(){return this.$d.toString()!==p},q.isSame=function(V,_){var M=X(V);return this.startOf(_)<=M&&M<=this.endOf(_)},q.isAfter=function(V,_){return X(V)<this.startOf(_)},q.isBefore=function(V,_){return this.endOf(_)<X(V)},q.$g=function(V,_,M){return K.u(V)?this[_]:this.set(M,V)},q.unix=function(){return Math.floor(this.valueOf()/1e3)},q.valueOf=function(){return this.$d.getTime()},q.startOf=function(V,_){var M=this,Y=!!K.u(_)||_,Z=K.p(V),ce=function(yt,Ie){var ze=K.w(M.$u?Date.UTC(M.$y,Ie,yt):new Date(M.$y,Ie,yt),M);return Y?ze:ze.endOf(s)},ge=function(yt,Ie){return K.w(M.toDate()[yt].apply(M.toDate("s"),(Y?[0,0,0,0]:[23,59,59,999]).slice(Ie)),M)},Re=this.$W,Ee=this.$M,Ue=this.$D,Er="set"+(this.$u?"UTC":"");switch(Z){case d:return Y?ce(1,0):ce(31,11);case u:return Y?ce(1,Ee):ce(0,Ee+1);case c:var It=this.$locale().weekStart||0,lr=(Re<It?Re+7:Re)-It;return ce(Y?Ue-lr:Ue+(6-lr),Ee);case s:case f:return ge(Er+"Hours",0);case i:return ge(Er+"Minutes",1);case o:return ge(Er+"Seconds",2);case n:return ge(Er+"Milliseconds",3);default:return this.clone()}},q.endOf=function(V){return this.startOf(V,!1)},q.$set=function(V,_){var M,Y=K.p(V),Z="set"+(this.$u?"UTC":""),ce=(M={},M[s]=Z+"Date",M[f]=Z+"Date",M[u]=Z+"Month",M[d]=Z+"FullYear",M[i]=Z+"Hours",M[o]=Z+"Minutes",M[n]=Z+"Seconds",M[a]=Z+"Milliseconds",M)[Y],ge=Y===s?this.$D+(_-this.$W):_;if(Y===u||Y===d){var Re=this.clone().set(f,1);Re.$d[ce](ge),Re.init(),this.$d=Re.set(f,Math.min(this.$D,Re.daysInMonth())).$d}else ce&&this.$d[ce](ge);return this.init(),this},q.set=function(V,_){return this.clone().$set(V,_)},q.get=function(V){return this[K.p(V)]()},q.add=function(V,_){var M,Y=this;V=Number(V);var Z=K.p(_),ce=function(Ee){var Ue=X(Y);return K.w(Ue.date(Ue.date()+Math.round(Ee*V)),Y)};if(Z===u)return this.set(u,this.$M+V);if(Z===d)return this.set(d,this.$y+V);if(Z===s)return ce(1);if(Z===c)return ce(7);var ge=(M={},M[o]=e,M[i]=r,M[n]=t,M)[Z]||1,Re=this.$d.getTime()+V*ge;return K.w(Re,this)},q.subtract=function(V,_){return this.add(-1*V,_)},q.format=function(V){var _=this,M=this.$locale();if(!this.isValid())return M.invalidDate||p;var Y=V||"YYYY-MM-DDTHH:mm:ssZ",Z=K.z(this),ce=this.$H,ge=this.$m,Re=this.$M,Ee=M.weekdays,Ue=M.months,Er=M.meridiem,It=function(Ie,ze,dr,Ir){return Ie&&(Ie[ze]||Ie(_,Y))||dr[ze].slice(0,Ir)},lr=function(Ie){return K.s(ce%12||12,Ie,"0")},yt=Er||function(Ie,ze,dr){var Ir=Ie<12?"AM":"PM";return dr?Ir.toLowerCase():Ir};return Y.replace(S,function(Ie,ze){return ze||function(dr){switch(dr){case"YY":return String(_.$y).slice(-2);case"YYYY":return K.s(_.$y,4,"0");case"M":return Re+1;case"MM":return K.s(Re+1,2,"0");case"MMM":return It(M.monthsShort,Re,Ue,3);case"MMMM":return It(Ue,Re);case"D":return _.$D;case"DD":return K.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return It(M.weekdaysMin,_.$W,Ee,2);case"ddd":return It(M.weekdaysShort,_.$W,Ee,3);case"dddd":return Ee[_.$W];case"H":return String(ce);case"HH":return K.s(ce,2,"0");case"h":return lr(1);case"hh":return lr(2);case"a":return yt(ce,ge,!0);case"A":return yt(ce,ge,!1);case"m":return String(ge);case"mm":return K.s(ge,2,"0");case"s":return String(_.$s);case"ss":return K.s(_.$s,2,"0");case"SSS":return K.s(_.$ms,3,"0");case"Z":return Z}return null}(Ie)||Z.replace(":","")})},q.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},q.diff=function(V,_,M){var Y,Z=this,ce=K.p(_),ge=X(V),Re=(ge.utcOffset()-this.utcOffset())*e,Ee=this-ge,Ue=function(){return K.m(Z,ge)};switch(ce){case d:Y=Ue()/12;break;case u:Y=Ue();break;case l:Y=Ue()/3;break;case c:Y=(Ee-Re)/6048e5;break;case s:Y=(Ee-Re)/864e5;break;case i:Y=Ee/r;break;case o:Y=Ee/e;break;case n:Y=Ee/t;break;default:Y=Ee}return M?Y:K.a(Y)},q.daysInMonth=function(){return this.endOf(u).$D},q.$locale=function(){return Q[this.$L]},q.locale=function(V,_){if(!V)return this.$L;var M=this.clone(),Y=oe(V,_,!0);return Y&&(M.$L=Y),M},q.clone=function(){return K.w(this.$d,this)},q.toDate=function(){return new Date(this.valueOf())},q.toJSON=function(){return this.isValid()?this.toISOString():null},q.toISOString=function(){return this.$d.toISOString()},q.toString=function(){return this.$d.toUTCString()},B}(),ve=he.prototype;return X.prototype=ve,[["$ms",a],["$s",n],["$m",o],["$H",i],["$W",s],["$M",u],["$y",d],["$D",f]].forEach(function(B){ve[B[1]]=function(q){return this.$g(q,B[0],B[1])}}),X.extend=function(B,q){return B.$i||(B(q,he,X),B.$i=!0),X},X.locale=oe,X.isDayjs=ae,X.unix=function(B){return X(1e3*B)},X.en=Q[D],X.Ls=Q,X.p={},X})});var Tg=Se((Td,Dd)=>{(function(t,e){typeof Td=="object"&&typeof Dd!="undefined"?Dd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs_plugin_quarterOfYear=e()})(Td,function(){"use strict";var t="month",e="quarter";return function(r,a){var n=a.prototype;n.quarter=function(s){return this.$utils().u(s)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(s-1))};var o=n.add;n.add=function(s,c){return s=Number(s),this.$utils().p(c)===e?this.add(3*s,t):o.bind(this)(s,c)};var i=n.startOf;n.startOf=function(s,c){var u=this.$utils(),l=!!u.u(c)||c;if(u.p(s)===e){var d=this.quarter()-1;return l?this.month(3*d).startOf(t).startOf("day"):this.month(3*d+2).endOf(t).endOf("day")}return i.bind(this)(s,c)}}})});var Dg=Se((Vd,Nd)=>{(function(t,e){typeof Vd=="object"&&typeof Nd!="undefined"?Nd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs_plugin_customParseFormat=e()})(Vd,function(){"use strict";var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,a=/\d\d?/,n=/\d*[^-_:/,()\s\d]+/,o={},i=function(p){return(p=+p)+(p>68?1900:2e3)},s=function(p){return function(m){this[p]=+m}},c=[/[+-]\d\d:?(\d\d)?|Z/,function(p){(this.zone||(this.zone={})).offset=function(m){if(!m||m==="Z")return 0;var S=m.match(/([+-]|\d\d)/g),v=60*S[1]+(+S[2]||0);return v===0?0:S[0]==="+"?-v:v}(p)}],u=function(p){var m=o[p];return m&&(m.indexOf?m:m.s.concat(m.f))},l=function(p,m){var S,v=o.meridiem;if(v){for(var C=1;C<=24;C+=1)if(p.indexOf(v(C,0,m))>-1){S=C>12;break}}else S=p===(m?"pm":"PM");return S},d={A:[n,function(p){this.afternoon=l(p,!1)}],a:[n,function(p){this.afternoon=l(p,!0)}],S:[/\d/,function(p){this.milliseconds=100*+p}],SS:[r,function(p){this.milliseconds=10*+p}],SSS:[/\d{3}/,function(p){this.milliseconds=+p}],s:[a,s("seconds")],ss:[a,s("seconds")],m:[a,s("minutes")],mm:[a,s("minutes")],H:[a,s("hours")],h:[a,s("hours")],HH:[a,s("hours")],hh:[a,s("hours")],D:[a,s("day")],DD:[r,s("day")],Do:[n,function(p){var m=o.ordinal,S=p.match(/\d+/);if(this.day=S[0],m)for(var v=1;v<=31;v+=1)m(v).replace(/\[|\]/g,"")===p&&(this.day=v)}],M:[a,s("month")],MM:[r,s("month")],MMM:[n,function(p){var m=u("months"),S=(u("monthsShort")||m.map(function(v){return v.slice(0,3)})).indexOf(p)+1;if(S<1)throw new Error;this.month=S%12||S}],MMMM:[n,function(p){var m=u("months").indexOf(p)+1;if(m<1)throw new Error;this.month=m%12||m}],Y:[/[+-]?\d+/,s("year")],YY:[r,function(p){this.year=i(p)}],YYYY:[/\d{4}/,s("year")],Z:c,ZZ:c};function f(p){var m,S;m=p,S=o&&o.formats;for(var v=(p=m.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(oe,X,K){var he=K&&K.toUpperCase();return X||S[K]||t[K]||S[he].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(ve,B,q){return B||q.slice(1)})})).match(e),C=v.length,F=0;F<C;F+=1){var D=v[F],Q=d[D],te=Q&&Q[0],ae=Q&&Q[1];v[F]=ae?{regex:te,parser:ae}:D.replace(/^\[|\]$/g,"")}return function(oe){for(var X={},K=0,he=0;K<C;K+=1){var ve=v[K];if(typeof ve=="string")he+=ve.length;else{var B=ve.regex,q=ve.parser,V=oe.slice(he),_=B.exec(V)[0];q.call(X,_),oe=oe.replace(_,"")}}return function(M){var Y=M.afternoon;if(Y!==void 0){var Z=M.hours;Y?Z<12&&(M.hours+=12):Z===12&&(M.hours=0),delete M.afternoon}}(X),X}}return function(p,m,S){S.p.customParseFormat=!0,p&&p.parseTwoDigitYear&&(i=p.parseTwoDigitYear);var v=m.prototype,C=v.parse;v.parse=function(F){var D=F.date,Q=F.utc,te=F.args;this.$u=Q;var ae=te[1];if(typeof ae=="string"){var oe=te[2]===!0,X=te[3]===!0,K=oe||X,he=te[2];X&&(he=te[2]),o=this.$locale(),!oe&&he&&(o=S.Ls[he]),this.$d=function(V,_,M){try{if(["x","X"].indexOf(_)>-1)return new Date((_==="X"?1e3:1)*V);var Y=f(_)(V),Z=Y.year,ce=Y.month,ge=Y.day,Re=Y.hours,Ee=Y.minutes,Ue=Y.seconds,Er=Y.milliseconds,It=Y.zone,lr=new Date,yt=ge||(Z||ce?1:lr.getDate()),Ie=Z||lr.getFullYear(),ze=0;Z&&!ce||(ze=ce>0?ce-1:lr.getMonth());var dr=Re||0,Ir=Ee||0,il=Ue||0,sl=Er||0;return It?new Date(Date.UTC(Ie,ze,yt,dr,Ir,il,sl+60*It.offset*1e3)):M?new Date(Date.UTC(Ie,ze,yt,dr,Ir,il,sl)):new Date(Ie,ze,yt,dr,Ir,il,sl)}catch{return new Date("")}}(D,ae,Q),this.init(),he&&he!==!0&&(this.$L=this.locale(he).$L),K&&D!=this.format(ae)&&(this.$d=new Date("")),o={}}else if(ae instanceof Array)for(var ve=ae.length,B=1;B<=ve;B+=1){te[1]=ae[B-1];var q=S.apply(this,te);if(q.isValid()){this.$d=q.$d,this.$L=q.$L,this.init();break}B===ve&&(this.$d=new Date(""))}else C.call(this,F)}}})});var uh=Se((ZL,ch)=>{var xA=/(^|; )Coveo-Pendragon=([^;]*)/;ch.exports=()=>xA.exec(document.cookie)?.pop()||null});var lh=Se((Wd,Hd)=>{(function(t,e){typeof Wd=="object"&&typeof Hd!="undefined"?Hd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs_plugin_timezone=e()})(Wd,function(){"use strict";var t={year:0,month:1,day:2,hour:3,minute:4,second:5},e={};return function(r,a,n){var o,i=function(l,d,f){f===void 0&&(f={});var p=new Date(l),m=function(S,v){v===void 0&&(v={});var C=v.timeZoneName||"short",F=S+"|"+C,D=e[F];return D||(D=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:S,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:C}),e[F]=D),D}(d,f);return m.formatToParts(p)},s=function(l,d){for(var f=i(l,d),p=[],m=0;m<f.length;m+=1){var S=f[m],v=S.type,C=S.value,F=t[v];F>=0&&(p[F]=parseInt(C,10))}var D=p[3],Q=D===24?0:D,te=p[0]+"-"+p[1]+"-"+p[2]+" "+Q+":"+p[4]+":"+p[5]+":000",ae=+l;return(n.utc(te).valueOf()-(ae-=ae%1e3))/6e4},c=a.prototype;c.tz=function(l,d){l===void 0&&(l=o);var f=this.utcOffset(),p=this.toDate(),m=p.toLocaleString("en-US",{timeZone:l}),S=Math.round((p-new Date(m))/1e3/60),v=n(m,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(p.getTimezoneOffset()/15)-S,!0);if(d){var C=v.utcOffset();v=v.add(f-C,"minute")}return v.$x.$timezone=l,v},c.offsetName=function(l){var d=this.$x.$timezone||n.tz.guess(),f=i(this.valueOf(),d,{timeZoneName:l}).find(function(p){return p.type.toLowerCase()==="timezonename"});return f&&f.value};var u=c.startOf;c.startOf=function(l,d){if(!this.$x||!this.$x.$timezone)return u.call(this,l,d);var f=n(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return u.call(f,l,d).tz(this.$x.$timezone,!0)},n.tz=function(l,d,f){var p=f&&d,m=f||d||o,S=s(+n(),m);if(typeof l!="string")return n(l).tz(m);var v=function(Q,te,ae){var oe=Q-60*te*1e3,X=s(oe,ae);if(te===X)return[oe,te];var K=s(oe-=60*(X-te)*1e3,ae);return X===K?[oe,X]:[Q-60*Math.min(X,K)*1e3,Math.max(X,K)]}(n.utc(l,p).valueOf(),S,m),C=v[0],F=v[1],D=n(C).utcOffset(F);return D.$x.$timezone=m,D},n.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},n.tz.setDefault=function(l){o=l}}})});var dh=Se((zd,Gd)=>{(function(t,e){typeof zd=="object"&&typeof Gd!="undefined"?Gd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs_plugin_utc=e()})(zd,function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(a,n,o){var i=n.prototype;o.utc=function(p){var m={date:p,utc:!0,args:arguments};return new n(m)},i.utc=function(p){var m=o(this.toDate(),{locale:this.$L,utc:!0});return p?m.add(this.utcOffset(),t):m},i.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),s.call(this,p)};var c=i.init;i.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else c.call(this)};var u=i.utcOffset;i.utcOffset=function(p,m){var S=this.$utils().u;if(S(p))return this.$u?0:S(this.$offset)?u.call(this):this.$offset;if(typeof p=="string"&&(p=function(D){D===void 0&&(D="");var Q=D.match(e);if(!Q)return null;var te=(""+Q[0]).match(r)||["-",0,0],ae=te[0],oe=60*+te[1]+ +te[2];return oe===0?0:ae==="+"?oe:-oe}(p),p===null))return this;var v=Math.abs(p)<=16?60*p:p,C=this;if(m)return C.$offset=v,C.$u=p===0,C;if(p!==0){var F=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(C=this.local().add(v+F,t)).$offset=v,C.$x.$localOffset=F}else C=this.utc();return C};var l=i.format;i.format=function(p){var m=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,m)},i.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(p){return p==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=i.diff;i.diff=function(p,m,S){if(p&&this.$u===p.$u)return f.call(this,p,m,S);var v=this.local(),C=o(p).local();return f.call(v,C,m,S)}}})});var bh=Se((tB,Fh)=>{"use strict";function TA(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Fh.exports=DA;function DA(t,e,r){var a=r&&r.stringify||TA,n=1;if(typeof t=="object"&&t!==null){var o=e.length+n;if(o===1)return t;var i=new Array(o);i[0]=a(t);for(var s=1;s<o;s++)i[s]=a(e[s]);return i.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var u="",l=1-n,d=-1,f=t&&t.length||0,p=0;p<f;){if(t.charCodeAt(p)===37&&p+1<f){switch(d=d>-1?d:0,t.charCodeAt(p+1)){case 100:case 102:if(l>=c||e[l]==null)break;d<p&&(u+=t.slice(d,p)),u+=Number(e[l]),d=p+2,p++;break;case 105:if(l>=c||e[l]==null)break;d<p&&(u+=t.slice(d,p)),u+=Math.floor(Number(e[l])),d=p+2,p++;break;case 79:case 111:case 106:if(l>=c||e[l]===void 0)break;d<p&&(u+=t.slice(d,p));var m=typeof e[l];if(m==="string"){u+="'"+e[l]+"'",d=p+2,p++;break}if(m==="function"){u+=e[l].name||"<anonymous>",d=p+2,p++;break}u+=a(e[l]),d=p+2,p++;break;case 115:if(l>=c)break;d<p&&(u+=t.slice(d,p)),u+=String(e[l]),d=p+2,p++;break;case 37:d<p&&(u+=t.slice(d,p)),u+="%",d=p+2,p++,l--;break}++l}++p}return d===-1?t:(d<f&&(u+=t.slice(d)),u)}});var Ih=Se((rB,dc)=>{"use strict";var Rh=bh();dc.exports=Fr;var Ai=YA().console||{},VA={mapHttpRequest:lc,mapHttpResponse:lc,wrapRequestSerializer:ep,wrapResponseSerializer:ep,wrapErrorSerializer:ep,req:lc,res:lc,err:Ph,errWithCause:Ph};function cc(t,e){return t==="silent"?1/0:e.levels.values[t]}var Jd=Symbol("pino.logFuncs"),Xd=Symbol("pino.hierarchy"),NA={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Ah(t,e){let r={logger:e,parent:t[Xd]};e[Xd]=r}function MA(t,e,r){let a={};e.forEach(n=>{a[n]=r[n]?r[n]:Ai[n]||Ai[NA[n]||"log"]||Pi}),t[Jd]=a}function LA(t,e){return Array.isArray(t)?t.filter(function(a){return a!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Fr(t){t=t||{},t.browser=t.browser||{};let e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");let r=t.browser.write||Ai;t.browser.write&&(t.browser.asObject=!0);let a=t.serializers||{},n=LA(t.browser.serialize,a),o=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);let i=Object.keys(t.customLevels||{}),s=["error","fatal","warn","info","debug","trace"].concat(i);typeof r=="function"&&s.forEach(function(S){r[S]=r}),(t.enabled===!1||t.browser.disabled)&&(t.level="silent");let c=t.level||"info",u=Object.create(r);u.log||(u.log=Pi),MA(u,s,r),Ah({},u),Object.defineProperty(u,"levelVal",{get:d}),Object.defineProperty(u,"level",{get:f,set:p});let l={transmit:e,serialize:n,asObject:t.browser.asObject,levels:s,timestamp:HA(t)};u.levels=QA(t),u.level=c,u.setMaxListeners=u.getMaxListeners=u.emit=u.addListener=u.on=u.prependListener=u.once=u.prependOnceListener=u.removeListener=u.removeAllListeners=u.listeners=u.listenerCount=u.eventNames=u.write=u.flush=Pi,u.serializers=a,u._serialize=n,u._stdErrSerialize=o,u.child=m,e&&(u._logEvent=Zd());function d(){return cc(this.level,this)}function f(){return this._level}function p(S){if(S!=="silent"&&!this.levels.values[S])throw Error("unknown level "+S);this._level=S,wa(this,l,u,"error"),wa(this,l,u,"fatal"),wa(this,l,u,"warn"),wa(this,l,u,"info"),wa(this,l,u,"debug"),wa(this,l,u,"trace"),i.forEach(v=>{wa(this,l,u,v)})}function m(S,v){if(!S)throw new Error("missing bindings for child Pino");v=v||{},n&&S.serializers&&(v.serializers=S.serializers);let C=v.serializers;if(n&&C){var F=Object.assign({},a,C),D=t.browser.serialize===!0?Object.keys(F):n;delete S.serializers,uc([S],D,F,this._stdErrSerialize)}function Q(ae){this._childLevel=(ae._childLevel|0)+1,this.bindings=S,F&&(this.serializers=F,this._serialize=D),e&&(this._logEvent=Zd([].concat(ae._logEvent.bindings,S)))}Q.prototype=this;let te=new Q(this);return Ah(this,te),te.level=this.level,te}return u}function QA(t){let e=t.customLevels||{},r=Object.assign({},Fr.levels.values,e),a=Object.assign({},Fr.levels.labels,BA(e));return{values:r,labels:a}}function BA(t){let e={};return Object.keys(t).forEach(function(r){e[t[r]]=r}),e}Fr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Fr.stdSerializers=VA;Fr.stdTimeFunctions=Object.assign({},{nullTime:wh,epochTime:Eh,unixTime:zA,isoTime:GA});function jA(t){let e=[];t.bindings&&e.push(t.bindings);let r=t[Xd];for(;r.parent;)r=r.parent,r.logger.bindings&&e.push(r.logger.bindings);return e.reverse()}function wa(t,e,r,a){if(t[a]=cc(t.level,r)>cc(a,r)?Pi:r[Jd][a],!e.transmit&&t[a]===Pi)return;t[a]=_A(t,e,r,a);let n=jA(t);n.length!==0&&(t[a]=UA(n,t[a]))}function UA(t,e){return function(){return e.apply(this,[...t,...arguments])}}function _A(t,e,r,a){return function(n){return function(){let i=e.timestamp(),s=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ai?Ai:this;for(var u=0;u<s.length;u++)s[u]=arguments[u];if(e.serialize&&!e.asObject&&uc(s,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(c,$A(this,a,s,i)):n.apply(c,s),e.transmit){let l=e.transmit.level||t._level,d=r.levels.values[l],f=r.levels.values[a];if(f<d)return;WA(this,{ts:i,methodLevel:a,methodValue:f,transmitLevel:l,transmitValue:r.levels.values[e.transmit.level||t._level],send:e.transmit.send,val:cc(t._level,r)},s)}}}(t[Jd][a])}function $A(t,e,r,a){t._serialize&&uc(r,t._serialize,t.serializers,t._stdErrSerialize);let n=r.slice(),o=n[0],i={};a&&(i.time=a),i.level=t.levels.values[e];let s=(t._childLevel|0)+1;if(s<1&&(s=1),o!==null&&typeof o=="object"){for(;s--&&typeof n[0]=="object";)Object.assign(i,n.shift());o=n.length?Rh(n.shift(),n):void 0}else typeof o=="string"&&(o=Rh(n.shift(),n));return o!==void 0&&(i.msg=o),i}function uc(t,e,r,a){for(let n in t)if(a&&t[n]instanceof Error)t[n]=Fr.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(let o in t[n])e&&e.indexOf(o)>-1&&o in r&&(t[n][o]=r[o](t[n][o]))}function WA(t,e,r){let a=e.send,n=e.ts,o=e.methodLevel,i=e.methodValue,s=e.val,c=t._logEvent.bindings;uc(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(u){return c.indexOf(u)===-1}),t._logEvent.level.label=o,t._logEvent.level.value=i,a(o,t._logEvent,s),t._logEvent=Zd(c)}function Zd(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Ph(t){let e={type:t.constructor.name,msg:t.message,stack:t.stack};for(let r in t)e[r]===void 0&&(e[r]=t[r]);return e}function HA(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?wh:Eh}function lc(){return{}}function ep(t){return t}function Pi(){}function wh(){return!1}function Eh(){return Date.now()}function zA(){return Math.round(Date.now()/1e3)}function GA(){return new Date(Date.now()).toISOString()}function YA(){function t(e){return typeof e!="undefined"&&e}try{return typeof globalThis!="undefined"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}dc.exports.default=Fr;dc.exports.pino=Fr});var Zo=()=>global.crypto,Jp=()=>{typeof window=="undefined"&&(Zo()||(global.crypto=Bx("crypto")),!Zo().getRandomValues&&Zo().webcrypto&&(global.crypto.getRandomValues=Zo().webcrypto.getRandomValues.bind(Zo().webcrypto)))};function et(t){for(var e=arguments.length,r=Array(e>1?e-1:0),a=1;a<e;a++)r[a-1]=arguments[a];if(!1)var n,o;throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function pr(t){return!!t&&!!t[fe]}function Ct(t){var e;return!!t&&(function(r){if(!r||typeof r!="object")return!1;var a=Object.getPrototypeOf(r);if(a===null)return!0;var n=Object.hasOwnProperty.call(a,"constructor")&&a.constructor;return n===Object||typeof n=="function"&&Function.toString.call(n)===Yx}(t)||Array.isArray(t)||!!t[uf]||!!((e=t.constructor)===null||e===void 0?void 0:e[uf])||ul(t)||ll(t))}function ga(t,e,r){r===void 0&&(r=!1),Ha(t)===0?(r?Object.keys:Ga)(t).forEach(function(a){r&&typeof a=="symbol"||e(a,t[a],t)}):t.forEach(function(a,n){return e(n,a,t)})}function Ha(t){var e=t[fe];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:ul(t)?2:ll(t)?3:0}function za(t,e){return Ha(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Ux(t,e){return Ha(t)===2?t.get(e):t[e]}function Xp(t,e,r){var a=Ha(t);a===2?t.set(e,r):a===3?t.add(r):t[e]=r}function Zp(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function ul(t){return zx&&t instanceof Map}function ll(t){return Gx&&t instanceof Set}function kr(t){return t.o||t.t}function dl(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=lf(t);delete e[fe];for(var r=Ga(e),a=0;a<r.length;a++){var n=r[a],o=e[n];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[n]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[n]})}return Object.create(Object.getPrototypeOf(t),e)}function pl(t,e){return e===void 0&&(e=!1),fl(t)||pr(t)||!Ct(t)||(Ha(t)>1&&(t.set=t.add=t.clear=t.delete=_x),Object.freeze(t),e&&ga(t,function(r,a){return pl(a,!0)},!0)),t}function _x(){et(2)}function fl(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function kt(t){var e=Fl[t];return e||et(18,t),e}function $x(t,e){Fl[t]||(Fl[t]=e)}function ml(){return ei}function gl(t,e){e&&(kt("Patches"),t.u=[],t.s=[],t.v=e)}function Gi(t){hl(t),t.p.forEach(Wx),t.p=null}function hl(t){t===ei&&(ei=t.l)}function ef(t){return ei={p:[],l:ei,h:t,m:!0,_:0}}function Wx(t){var e=t[fe];e.i===0||e.i===1?e.j():e.g=!0}function Sl(t,e){e._=e.p.length;var r=e.p[0],a=t!==void 0&&t!==r;return e.h.O||kt("ES5").S(e,t,a),a?(r[fe].P&&(Gi(e),et(4)),Ct(t)&&(t=Yi(e,t),e.l||Ki(e,t)),e.u&&kt("Patches").M(r[fe].t,t,e.u,e.s)):t=Yi(e,r,[]),Gi(e),e.u&&e.v(e.u,e.s),t!==cf?t:void 0}function Yi(t,e,r){if(fl(e))return e;var a=e[fe];if(!a)return ga(e,function(s,c){return tf(t,a,e,s,c,r)},!0),e;if(a.A!==t)return e;if(!a.P)return Ki(t,a.t,!0),a.t;if(!a.I){a.I=!0,a.A._--;var n=a.i===4||a.i===5?a.o=dl(a.k):a.o,o=n,i=!1;a.i===3&&(o=new Set(n),n.clear(),i=!0),ga(o,function(s,c){return tf(t,a,n,s,c,r,i)}),Ki(t,n,!1),r&&t.u&&kt("Patches").N(a,r,t.u,t.s)}return a.o}function tf(t,e,r,a,n,o,i){if(pr(n)){var s=Yi(t,n,o&&e&&e.i!==3&&!za(e.R,a)?o.concat(a):void 0);if(Xp(r,a,s),!pr(s))return;t.m=!1}else i&&r.add(n);if(Ct(n)&&!fl(n)){if(!t.h.D&&t._<1)return;Yi(t,n),e&&e.A.l||Ki(t,n)}}function Ki(t,e,r){r===void 0&&(r=!1),!t.l&&t.h.D&&t.m&&pl(e,r)}function yl(t,e){var r=t[fe];return(r?kr(r):t)[e]}function rf(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var a=Object.getOwnPropertyDescriptor(r,e);if(a)return a;r=Object.getPrototypeOf(r)}}function Or(t){t.P||(t.P=!0,t.l&&Or(t.l))}function Cl(t){t.o||(t.o=dl(t.t))}function xl(t,e,r){var a=ul(e)?kt("MapSet").F(e,r):ll(e)?kt("MapSet").T(e,r):t.O?function(n,o){var i=Array.isArray(n),s={i:i?1:0,A:o?o.A:ml(),P:!1,I:!1,R:{},l:o,t:n,k:null,o:null,j:null,C:!1},c=s,u=ti;i&&(c=[s],u=ri);var l=Proxy.revocable(c,u),d=l.revoke,f=l.proxy;return s.k=f,s.j=d,f}(e,r):kt("ES5").J(e,r);return(r?r.A:ml()).p.push(a),a}function Hx(t){return pr(t)||et(22,t),function e(r){if(!Ct(r))return r;var a,n=r[fe],o=Ha(r);if(n){if(!n.P&&(n.i<4||!kt("ES5").K(n)))return n.t;n.I=!0,a=af(r,o),n.I=!1}else a=af(r,o);return ga(a,function(i,s){n&&Ux(n.t,i)===s||Xp(a,i,e(s))}),o===3?new Set(a):a}(t)}function af(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return dl(t)}function nf(){function t(i,s){var c=o[i];return c?c.enumerable=s:o[i]=c={configurable:!0,enumerable:s,get:function(){var u=this[fe];return ti.get(u,i)},set:function(u){var l=this[fe];ti.set(l,i,u)}},c}function e(i){for(var s=i.length-1;s>=0;s--){var c=i[s][fe];if(!c.P)switch(c.i){case 5:a(c)&&Or(c);break;case 4:r(c)&&Or(c)}}}function r(i){for(var s=i.t,c=i.k,u=Ga(c),l=u.length-1;l>=0;l--){var d=u[l];if(d!==fe){var f=s[d];if(f===void 0&&!za(s,d))return!0;var p=c[d],m=p&&p[fe];if(m?m.t!==f:!Zp(p,f))return!0}}var S=!!s[fe];return u.length!==Ga(s).length+(S?0:1)}function a(i){var s=i.k;if(s.length!==i.t.length)return!0;var c=Object.getOwnPropertyDescriptor(s,s.length-1);if(c&&!c.get)return!0;for(var u=0;u<s.length;u++)if(!s.hasOwnProperty(u))return!0;return!1}function n(i){i.g&&et(3,JSON.stringify(kr(i)))}var o={};$x("ES5",{J:function(i,s){var c=Array.isArray(i),u=function(d,f){if(d){for(var p=Array(f.length),m=0;m<f.length;m++)Object.defineProperty(p,""+m,t(m,!0));return p}var S=lf(f);delete S[fe];for(var v=Ga(S),C=0;C<v.length;C++){var F=v[C];S[F]=t(F,d||!!S[F].enumerable)}return Object.create(Object.getPrototypeOf(f),S)}(c,i),l={i:c?5:4,A:s?s.A:ml(),P:!1,I:!1,R:{},l:s,t:i,k:u,o:null,g:!1,C:!1};return Object.defineProperty(u,fe,{value:l,writable:!0}),u},S:function(i,s,c){c?pr(s)&&s[fe].A===i&&e(i.p):(i.u&&function u(l){if(l&&typeof l=="object"){var d=l[fe];if(d){var f=d.t,p=d.k,m=d.R,S=d.i;if(S===4)ga(p,function(Q){Q!==fe&&(f[Q]!==void 0||za(f,Q)?m[Q]||u(p[Q]):(m[Q]=!0,Or(d)))}),ga(f,function(Q){p[Q]!==void 0||za(p,Q)||(m[Q]=!1,Or(d))});else if(S===5){if(a(d)&&(Or(d),m.length=!0),p.length<f.length)for(var v=p.length;v<f.length;v++)m[v]=!1;else for(var C=f.length;C<p.length;C++)m[C]=!0;for(var F=Math.min(p.length,f.length),D=0;D<F;D++)p.hasOwnProperty(D)||(m[D]=!0),m[D]===void 0&&u(p[D])}}}}(i.p[0]),e(i.p))},K:function(i){return i.i===4?r(i):a(i)}})}var of,ei,vl=typeof Symbol!="undefined"&&typeof Symbol("x")=="symbol",zx=typeof Map!="undefined",Gx=typeof Set!="undefined",sf=typeof Proxy!="undefined"&&Proxy.revocable!==void 0&&typeof Reflect!="undefined",cf=vl?Symbol.for("immer-nothing"):((of={})["immer-nothing"]=!0,of),uf=vl?Symbol.for("immer-draftable"):"__$immer_draftable",fe=vl?Symbol.for("immer-state"):"__$immer_state",AO=typeof Symbol!="undefined"&&Symbol.iterator||"@@iterator";var Yx=""+Object.prototype.constructor,Ga=typeof Reflect!="undefined"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,lf=Object.getOwnPropertyDescriptors||function(t){var e={};return Ga(t).forEach(function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)}),e},Fl={},ti={get:function(t,e){if(e===fe)return t;var r=kr(t);if(!za(r,e))return function(n,o,i){var s,c=rf(o,i);return c?"value"in c?c.value:(s=c.get)===null||s===void 0?void 0:s.call(n.k):void 0}(t,r,e);var a=r[e];return t.I||!Ct(a)?a:a===yl(t.t,e)?(Cl(t),t.o[e]=xl(t.A.h,a,t)):a},has:function(t,e){return e in kr(t)},ownKeys:function(t){return Reflect.ownKeys(kr(t))},set:function(t,e,r){var a=rf(kr(t),e);if(a==null?void 0:a.set)return a.set.call(t.k,r),!0;if(!t.P){var n=yl(kr(t),e),o=n==null?void 0:n[fe];if(o&&o.t===r)return t.o[e]=r,t.R[e]=!1,!0;if(Zp(r,n)&&(r!==void 0||za(t.t,e)))return!0;Cl(t),Or(t)}return t.o[e]===r&&(r!==void 0||e in t.o)||Number.isNaN(r)&&Number.isNaN(t.o[e])||(t.o[e]=r,t.R[e]=!0),!0},deleteProperty:function(t,e){return yl(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,Cl(t),Or(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=kr(t),a=Reflect.getOwnPropertyDescriptor(r,e);return a&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:a.enumerable,value:r[e]}},defineProperty:function(){et(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){et(12)}},ri={};ga(ti,function(t,e){ri[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),ri.deleteProperty=function(t,e){return ri.set.call(this,t,e,void 0)},ri.set=function(t,e,r){return ti.set.call(this,t[0],e,r,t[0])};var Kx=function(){function t(r){var a=this;this.O=sf,this.D=!0,this.produce=function(n,o,i){if(typeof n=="function"&&typeof o!="function"){var s=o;o=n;var c=a;return function(S){var v=this;S===void 0&&(S=s);for(var C=arguments.length,F=Array(C>1?C-1:0),D=1;D<C;D++)F[D-1]=arguments[D];return c.produce(S,function(Q){var te;return(te=o).call.apply(te,[v,Q].concat(F))})}}var u;if(typeof o!="function"&&et(6),i!==void 0&&typeof i!="function"&&et(7),Ct(n)){var l=ef(a),d=xl(a,n,void 0),f=!0;try{u=o(d),f=!1}finally{f?Gi(l):hl(l)}return typeof Promise!="undefined"&&u instanceof Promise?u.then(function(S){return gl(l,i),Sl(S,l)},function(S){throw Gi(l),S}):(gl(l,i),Sl(u,l))}if(!n||typeof n!="object"){if((u=o(n))===void 0&&(u=n),u===cf&&(u=void 0),a.D&&pl(u,!0),i){var p=[],m=[];kt("Patches").M(n,u,p,m),i(p,m)}return u}et(21,n)},this.produceWithPatches=function(n,o){if(typeof n=="function")return function(u){for(var l=arguments.length,d=Array(l>1?l-1:0),f=1;f<l;f++)d[f-1]=arguments[f];return a.produceWithPatches(u,function(p){return n.apply(void 0,[p].concat(d))})};var i,s,c=a.produce(n,o,function(u,l){i=u,s=l});return typeof Promise!="undefined"&&c instanceof Promise?c.then(function(u){return[u,i,s]}):[c,i,s]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var e=t.prototype;return e.createDraft=function(r){Ct(r)||et(8),pr(r)&&(r=Hx(r));var a=ef(this),n=xl(this,r,void 0);return n[fe].C=!0,hl(a),n},e.finishDraft=function(r,a){var n=r&&r[fe],o=n.A;return gl(o,a),Sl(void 0,o)},e.setAutoFreeze=function(r){this.D=r},e.setUseProxies=function(r){r&&!sf&&et(20),this.O=r},e.applyPatches=function(r,a){var n;for(n=a.length-1;n>=0;n--){var o=a[n];if(o.path.length===0&&o.op==="replace"){r=o.value;break}}n>-1&&(a=a.slice(n+1));var i=kt("Patches").$;return pr(r)?i(r,a):this.produce(r,function(s){return i(s,a)})},t}(),Ye=new Kx,Jx=Ye.produce,PO=Ye.produceWithPatches.bind(Ye),wO=Ye.setAutoFreeze.bind(Ye),EO=Ye.setUseProxies.bind(Ye),IO=Ye.applyPatches.bind(Ye),kO=Ye.createDraft.bind(Ye),OO=Ye.finishDraft.bind(Ye),Ji=Jx;function qr(t){return qr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qr(t)}function bl(t,e){if(qr(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var a=r.call(t,e||"default");if(qr(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rl(t){var e=bl(t,"string");return qr(e)==="symbol"?e:String(e)}function Al(t,e,r){return e=Rl(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function df(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,a)}return r}function Xi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?df(Object(r),!0).forEach(function(a){Al(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):df(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function Ve(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var pf=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Pl=function(){return Math.random().toString(36).substring(7).split("").join(".")},Zi={INIT:"@@redux/INIT"+Pl(),REPLACE:"@@redux/REPLACE"+Pl(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Pl()}};function Xx(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function wl(t,e,r){var a;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ve(0));if(typeof e=="function"&&typeof r=="undefined"&&(r=e,e=void 0),typeof r!="undefined"){if(typeof r!="function")throw new Error(Ve(1));return r(wl)(t,e)}if(typeof t!="function")throw new Error(Ve(2));var n=t,o=e,i=[],s=i,c=!1;function u(){s===i&&(s=i.slice())}function l(){if(c)throw new Error(Ve(3));return o}function d(S){if(typeof S!="function")throw new Error(Ve(4));if(c)throw new Error(Ve(5));var v=!0;return u(),s.push(S),function(){if(!!v){if(c)throw new Error(Ve(6));v=!1,u();var F=s.indexOf(S);s.splice(F,1),i=null}}}function f(S){if(!Xx(S))throw new Error(Ve(7));if(typeof S.type=="undefined")throw new Error(Ve(8));if(c)throw new Error(Ve(9));try{c=!0,o=n(o,S)}finally{c=!1}for(var v=i=s,C=0;C<v.length;C++){var F=v[C];F()}return S}function p(S){if(typeof S!="function")throw new Error(Ve(10));n=S,f({type:Zi.REPLACE})}function m(){var S,v=d;return S={subscribe:function(F){if(typeof F!="object"||F===null)throw new Error(Ve(11));function D(){F.next&&F.next(l())}D();var Q=v(D);return{unsubscribe:Q}}},S[pf]=function(){return this},S}return f({type:Zi.INIT}),a={dispatch:f,subscribe:d,getState:l,replaceReducer:p},a[pf]=m,a}function Zx(t){Object.keys(t).forEach(function(e){var r=t[e],a=r(void 0,{type:Zi.INIT});if(typeof a=="undefined")throw new Error(Ve(12));if(typeof r(void 0,{type:Zi.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(Ve(13))})}function es(t){for(var e=Object.keys(t),r={},a=0;a<e.length;a++){var n=e[a];typeof t[n]=="function"&&(r[n]=t[n])}var o=Object.keys(r),i,s;try{Zx(r)}catch(c){s=c}return function(u,l){if(u===void 0&&(u={}),s)throw s;if(!1)var d;for(var f=!1,p={},m=0;m<o.length;m++){var S=o[m],v=r[S],C=u[S],F=v(C,l);if(typeof F=="undefined"){var D=l&&l.type;throw new Error(Ve(14))}p[S]=F,f=f||F!==C}return f=f||o.length!==Object.keys(u).length,f?p:u}}function Ya(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===0?function(a){return a}:e.length===1?e[0]:e.reduce(function(a,n){return function(){return a(n.apply(void 0,arguments))}})}function ff(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(a){return function(){var n=a.apply(void 0,arguments),o=function(){throw new Error(Ve(15))},i={getState:n.getState,dispatch:function(){return o.apply(void 0,arguments)}},s=e.map(function(c){return c(i)});return o=Ya.apply(void 0,s)(n.dispatch),Xi(Xi({},n),{},{dispatch:o})}}}function mf(t){var e=function(a){var n=a.dispatch,o=a.getState;return function(i){return function(s){return typeof s=="function"?s(n,o,t):i(s)}}};return e}var gf=mf();gf.withExtraArgument=mf;var El=gf;var hf=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function a(){this.constructor=e}e.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),ev=function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},a,n,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(o=u[0]&2?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],n=0}finally{a=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Ka=function(t,e){for(var r=0,a=e.length,n=t.length;r<a;r++,n++)t[n]=e[r];return t},tv=Object.defineProperty,rv=Object.defineProperties,av=Object.getOwnPropertyDescriptors,Sf=Object.getOwnPropertySymbols,nv=Object.prototype.hasOwnProperty,ov=Object.prototype.propertyIsEnumerable,yf=function(t,e,r){return e in t?tv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r},Ja=function(t,e){for(var r in e||(e={}))nv.call(e,r)&&yf(t,r,e[r]);if(Sf)for(var a=0,n=Sf(e);a<n.length;a++){var r=n[a];ov.call(e,r)&&yf(t,r,e[r])}return t},Il=function(t,e){return rv(t,av(e))},iv=function(t,e,r){return new Promise(function(a,n){var o=function(c){try{s(r.next(c))}catch(u){n(u)}},i=function(c){try{s(r.throw(c))}catch(u){n(u)}},s=function(c){return c.done?a(c.value):Promise.resolve(c.value).then(o,i)};s((r=r.apply(t,e)).next())})};var sv=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Ya:Ya.apply(null,arguments)},YO=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(t){return t}};function cv(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var r=e;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return e===r}function h(t,e){function r(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];if(e){var o=e.apply(void 0,a);if(!o)throw new Error("prepareAction did not return an object");return Ja(Ja({type:t,payload:o.payload},"meta"in o&&{meta:o.meta}),"error"in o&&{error:o.error})}return{type:t,payload:a[0]}}return r.toString=function(){return""+t},r.type=t,r.match=function(a){return a.type===t},r}var uv=function(t){hf(e,t);function e(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var n=t.apply(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return t.prototype.concat.apply(this,r)},e.prototype.prepend=function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return r.length===1&&Array.isArray(r[0])?new(e.bind.apply(e,Ka([void 0],r[0].concat(this)))):new(e.bind.apply(e,Ka([void 0],r.concat(this))))},e}(Array),lv=function(t){hf(e,t);function e(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var n=t.apply(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return t.prototype.concat.apply(this,r)},e.prototype.prepend=function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return r.length===1&&Array.isArray(r[0])?new(e.bind.apply(e,Ka([void 0],r[0].concat(this)))):new(e.bind.apply(e,Ka([void 0],r.concat(this))))},e}(Array);function Cf(t){return Ct(t)?Ji(t,function(){}):t}function dv(t){return typeof t=="boolean"}function pv(){return function(e){return fv(e)}}function fv(t){t===void 0&&(t={});var e=t.thunk,r=e===void 0?!0:e,a=t.immutableCheck,n=a===void 0?!0:a,o=t.serializableCheck,i=o===void 0?!0:o,s=t.actionCreatorCheck,c=s===void 0?!0:s,u=new uv;if(r&&(dv(r)?u.push(El):u.push(El.withExtraArgument(r.extraArgument))),!1){if(n)var l;if(i)var d;if(c)var f}return u}var kl=!0;function xf(t){var e=pv(),r=t||{},a=r.reducer,n=a===void 0?void 0:a,o=r.middleware,i=o===void 0?e():o,s=r.devTools,c=s===void 0?!0:s,u=r.preloadedState,l=u===void 0?void 0:u,d=r.enhancers,f=d===void 0?void 0:d,p;if(typeof n=="function")p=n;else if(cv(n))p=es(n);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var m=i;if(typeof m=="function"&&(m=m(e),!kl&&!Array.isArray(m)))throw new Error("when using a middleware builder function, an array of middleware must be returned");if(!kl&&m.some(function(Q){return typeof Q!="function"}))throw new Error("each middleware provided to configureStore must be a function");var S=ff.apply(void 0,m),v=Ya;c&&(v=sv(Ja({trace:!kl},typeof c=="object"&&c)));var C=new lv(S),F=C;Array.isArray(f)?F=Ka([S],f):typeof f=="function"&&(F=f(C));var D=v.apply(void 0,F);return wl(p,l,D)}function mv(t){var e={},r=[],a,n={addCase:function(o,i){var s=typeof o=="string"?o:o.type;if(!s)throw new Error("`builder.addCase` cannot be called with an empty action type");if(s in e)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return e[s]=i,n},addMatcher:function(o,i){return r.push({matcher:o,reducer:i}),n},addDefaultCase:function(o){return a=o,n}};return t(n),[e,r,a]}function gv(t){return typeof t=="function"}function O(t,e,r,a){r===void 0&&(r=[]);var n=typeof e=="function"?mv(e):[e,r,a],o=n[0],i=n[1],s=n[2],c;if(gv(t))c=function(){return Cf(t())};else{var u=Cf(t);c=function(){return u}}function l(d,f){d===void 0&&(d=c());var p=Ka([o[f.type]],i.filter(function(m){var S=m.matcher;return S(f)}).map(function(m){var S=m.reducer;return S}));return p.filter(function(m){return!!m}).length===0&&(p=[s]),p.reduce(function(m,S){if(S)if(pr(m)){var v=m,C=S(v,f);return C===void 0?m:C}else{if(Ct(m))return Ji(m,function(F){return S(F,f)});var C=S(m,f);if(C===void 0){if(m===null)return m;throw Error("A case reducer on a non-draftable value must not return undefined")}return C}return m},d)}return l.getInitialState=c,l}var hv="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Sv=function(t){t===void 0&&(t=21);for(var e="",r=t;r--;)e+=hv[Math.random()*64|0];return e},yv=["name","message","stack","code"],Ol=function(){function t(e,r){this.payload=e,this.meta=r}return t}(),vf=function(){function t(e,r){this.payload=e,this.meta=r}return t}(),Cv=function(t){if(typeof t=="object"&&t!==null){for(var e={},r=0,a=yv;r<a.length;r++){var n=a[r];typeof t[n]=="string"&&(e[n]=t[n])}return e}return{message:String(t)}},J=function(){function t(e,r,a){var n=h(e+"/fulfilled",function(l,d,f,p){return{payload:l,meta:Il(Ja({},p||{}),{arg:f,requestId:d,requestStatus:"fulfilled"})}}),o=h(e+"/pending",function(l,d,f){return{payload:void 0,meta:Il(Ja({},f||{}),{arg:d,requestId:l,requestStatus:"pending"})}}),i=h(e+"/rejected",function(l,d,f,p,m){return{payload:p,error:(a&&a.serializeError||Cv)(l||"Rejected"),meta:Il(Ja({},m||{}),{arg:f,requestId:d,rejectedWithValue:!!p,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"})}}),s=!1,c=typeof AbortController!="undefined"?AbortController:function(){function l(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return l.prototype.abort=function(){},l}();function u(l){return function(d,f,p){var m=(a==null?void 0:a.idGenerator)?a.idGenerator(l):Sv(),S=new c,v,C=!1;function F(Q){v=Q,S.abort()}var D=function(){return iv(this,null,function(){var Q,te,ae,oe,X,K,he;return ev(this,function(ve){switch(ve.label){case 0:return ve.trys.push([0,4,,5]),oe=(Q=a==null?void 0:a.condition)==null?void 0:Q.call(a,l,{getState:f,extra:p}),vv(oe)?[4,oe]:[3,2];case 1:oe=ve.sent(),ve.label=2;case 2:if(oe===!1||S.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return C=!0,X=new Promise(function(B,q){return S.signal.addEventListener("abort",function(){return q({name:"AbortError",message:v||"Aborted"})})}),d(o(m,l,(te=a==null?void 0:a.getPendingMeta)==null?void 0:te.call(a,{requestId:m,arg:l},{getState:f,extra:p}))),[4,Promise.race([X,Promise.resolve(r(l,{dispatch:d,getState:f,extra:p,requestId:m,signal:S.signal,abort:F,rejectWithValue:function(B,q){return new Ol(B,q)},fulfillWithValue:function(B,q){return new vf(B,q)}})).then(function(B){if(B instanceof Ol)throw B;return B instanceof vf?n(B.payload,m,l,B.meta):n(B,m,l)})])];case 3:return ae=ve.sent(),[3,5];case 4:return K=ve.sent(),ae=K instanceof Ol?i(null,m,l,K.payload,K.meta):i(K,m,l),[3,5];case 5:return he=a&&!a.dispatchConditionRejection&&i.match(ae)&&ae.meta.condition,he||d(ae),[2,ae]}})})}();return Object.assign(D,{abort:F,requestId:m,arg:l,unwrap:function(){return D.then(xv)}})}}return Object.assign(u,{pending:o,rejected:i,fulfilled:n,typePrefix:e})}return t.withTypes=function(){return t},t}();function xv(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function vv(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var Fv="task",Ff="listener",bf="completed",ql="cancelled",ZO="task-"+ql,eq="task-"+bf,tq=Ff+"-"+ql,rq=Ff+"-"+bf,aq=function(){function t(e){this.code=e,this.name="TaskAbortError",this.message=Fv+" "+ql+" (reason: "+e+")"}return t}();var Tl="listenerMiddleware";var nq=h(Tl+"/add"),oq=h(Tl+"/removeAll"),iq=h(Tl+"/remove");var Rf,sq=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:typeof global!="undefined"?global:globalThis):function(t){return(Rf||(Rf=Promise.resolve())).then(t).catch(function(e){return setTimeout(function(){throw e},0)})},bv=function(t){return function(e){setTimeout(e,t)}},cq=typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:bv(10);nf();var kf=Ge(Dl()),Xa=(t,e=5)=>t+Math.random().toString(36).substring(2,2+e);function ts(t){return Array.isArray(t)}function Of(t,e){return[...t.reduce((r,a)=>{let n=e(a);return r.has(n)||r.set(n,a),r},new Map).values()]}function qv(t){return(typeof btoa!="undefined"?btoa:kf.btoa)(encodeURI(t))}function rs(t,e){let{[t]:r,...a}=e;return a}function as(t){return qv(JSON.stringify(t))}var Tv=new Set(["1",1,"yes",!0]);function ns(){if(typeof navigator=="undefined"||typeof window=="undefined")return!1;let t=navigator,e=window;return[t.globalPrivacyControl,t.doNotTrack,t.msDoNotTrack,e.doNotTrack].some(r=>Tv.has(r))}function qf(t){let e={};for(let[r,a]of t)e[r]=a;return e}function Tf(t,e,r){return clearTimeout(e),setTimeout(t,r)}function Vl(t,e){return Object.fromEntries(Object.entries(t).map(([r,a])=>[r,e(a,r)]))}function Tr(t){if(typeof t!="object"||!t)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}function Dv(){let t=null,e=null;return{promise:new Promise((a,n)=>{t=a,e=n}),resolve:t,reject:e}}function Df(t){let{promise:e,resolve:r}=Dv();return{promise:e,middleware:()=>n=>o=>{n(o),t(o)&&r(o)}}}function Vv({definition:t,engine:e,props:r}){return"build"in t?t.build(e):t.buildWithProps(e,r)}function Vf({definitionsMap:t,engine:e,propsMap:r}){return Vl(t,(a,n)=>Vv({definition:a,engine:e,props:r==null?void 0:r[n]}))}function Nf({searchAction:t,controllers:e}){return{controllers:Vl(e,r=>({state:Tr(r.state)})),searchAction:Tr(t)}}function Nl(t,e){let r=function(...a){return t(...a)};for(let[a,n]of Object.entries(e))r[a]=n;return r}async function Nv({config:t,environment:e,event:r,listenerManager:a}){let{url:n,token:o,mode:i}=t;i!=="disabled"&&(a.call(r),e.send(n,o,r))}var Mv=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Lv(t){return typeof t=="string"&&Mv.test(t)}function Qv(t){let e="visitorId";return{getClientId:()=>{let r=t.get(),a=r.storage,n=a.getItem(e),o=n&&Lv(n)?n:r.generateUUID();return a.setItem(e,o),o},clear:()=>{t.get().storage.removeItem(e)}}}var Mf="0.6.8";function Bv(t){let{trackingId:e}=t;return{trackingId:e}}function jv(){return`relay@${Mf}`}function Lf(t,e,r,a){let{getReferrer:n,getLocation:o,getUserAgent:i}=r,s=Bv(e),c=a.getClientId();return Object.freeze({type:t,config:s,ts:Date.now(),source:jv(),clientId:c,userAgent:i(),referrer:n(),location:o()})}function Uv(t,e,r,a,n){return{...e,meta:Lf(t,r,a,n)}}var _v="*";function $v(){let t=[];function e({type:c,callback:u}){return t.findIndex(l=>l.type===c&&l.callback===u)}function r(c,u){return c.type==="*"||u===c.type}function a(c){return e(c)<0&&t.push(c),()=>s(c.type,c.callback)}function n(c){t.forEach(u=>{if(r(u,c.meta.type))try{u.callback(c)}catch(l){console.error(l)}})}function o(c){if(c===_v)t.length=0;else for(let u=t.length-1;u>=0;u--)t[u].type===c&&t.splice(u,1)}function i(c){let u=e(c);u>=0&&t.splice(u,1)}function s(c,u){u?i({type:c,callback:u}):o(c)}return{add:a,call:n,remove:s}}function Qf({url:t,token:e,trackingId:r,...a}){return Object.freeze({url:t,token:e,trackingId:r,...!!a.mode&&{mode:a.mode}})}function Wv(t){let e=Qf(t);return{get:()=>e,update:r=>{e=Qf({...e,...r})}}}function Hv(){let t=typeof window!="undefined";return{sendMessage(e){t&&window.postMessage(e,"*")}}}var Ml=zv();function zv(){let t="coveo_",e=r=>{let a=r.split(".").slice(-2);return a.length==2?a.join("."):""};return{getItem(r){let a=`${t}${r}=`,n=document.cookie.split(";");for(let o of n){let i=o.replace(/^\s+/,"");if(i.lastIndexOf(a,0)===0)return i.substring(a.length,i.length)}return null},setItem(r,a,n){let o=e(window.location.hostname),i=`;expires=${new Date(new Date().getTime()+n).toUTCString()}`,s=o?`;domain=${o}`:"";document.cookie=`${t}${r}=${a}${i}${s};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function Gv(){return{getItem(t){return Ml.getItem(t)||localStorage.getItem(t)},removeItem(t){Ml.removeItem(t),localStorage.removeItem(t)},setItem(t,e){let r=31556952e3;localStorage.setItem(t,e),Ml.setItem(t,e,r)}}}async function Ll(t,e){return fetch(t,e).catch(r=>{throw new Error(`${r.message}: The "host" value is invalid or a network error occured, according to the FetchAPI's response.`,{cause:r})})}function Yv(){let t=document.referrer;return t===""?null:t}function Kv(){return{runtime:"browser",fetch:(t,e)=>Ll(t,e),send:async(t,e,r)=>{let a=navigator.sendBeacon(`${t}?access_token=${e}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(Hv().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:t,token:e}),!a)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Yv(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:Gv()}}function Bf(){return{getItem(){return null},removeItem(){},setItem(){}}}function Jv(){return{runtime:"node",fetch:(t,e)=>Ll(t,e),send:async(t,e,r)=>{let a={"Content-Type":"application/json",Authorization:`Bearer ${e}`};Ll(t,{method:"POST",body:JSON.stringify([r]),headers:a})},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>crypto.randomUUID(),storage:Bf()}}function Xv(){return Zv()?Kv():Jv()}function Zv(){try{return typeof window=="object"}catch{return!1}}function eF(){return{runtime:"null",fetch:()=>Promise.resolve(new Response(JSON.stringify(""))),send:async()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:Bf()}}function tF(t){return t.get().mode=="disabled"?eF():Xv()}function rF(t){return{get:()=>Object.freeze(tF(t))}}function jf(t){let e=Wv(t),r=$v(),a=rF(e),n=Qv(a);return{emit:(o,i)=>{let s=e.get(),c=a.get(),u=Uv(o,i,s,c,n);return Nv({config:s,environment:c,event:u,listenerManager:r})},getMeta:o=>Lf(o,e.get(),a.get(),n),on:(o,i)=>r.add({type:o,callback:i}),off:(o,i)=>r.remove(o,i),updateConfig:o=>e.update(o),version:Mf,clearStorage:()=>{n.clear()}}}function Ot(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function x(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function s(l){try{u(a.next(l))}catch(d){i(d)}}function c(l){try{u(a.throw(l))}catch(d){i(d)}}function u(l){l.done?o(l.value):n(l.value).then(s,c)}u((a=a.apply(t,e||[])).next())})}var ne;(function(t){t.search="search",t.click="click",t.custom="custom",t.view="view",t.collect="collect"})(ne||(ne={}));function aF(){return typeof window!="undefined"}function Ql(){return typeof navigator!="undefined"}function Za(){return typeof document!="undefined"}function Bl(){try{return typeof localStorage!="undefined"}catch{return!1}}function nF(){try{return typeof sessionStorage!="undefined"}catch{return!1}}function Uf(){return Ql()&&navigator.cookieEnabled}var oF=[ne.click,ne.custom,ne.search,ne.view],iF=(t,e)=>oF.indexOf(t)!==-1?Object.assign({language:Za()?document.documentElement.lang:"unknown",userAgent:Ql()?navigator.userAgent:"unknown"},e):e,en=class{static set(e,r,a){var n,o,i,s;a&&(o=new Date,o.setTime(o.getTime()+a)),s=window.location.hostname,s.indexOf(".")===-1?_f(e,r,o):(i=s.split("."),n=i[i.length-2]+"."+i[i.length-1],_f(e,r,o,n))}static get(e){for(var r=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){var o=a[n];if(o=o.replace(/^\s+/,""),o.lastIndexOf(r,0)===0)return o.substring(r.length,o.length)}return null}static erase(e){en.set(e,"",-1)}};function _f(t,e,r,a){document.cookie=`${t}=${e}`+(r?`;expires=${r.toUTCString()}`:"")+(a?`;domain=${a}`:"")+";path=/;SameSite=Lax"}function sF(){return Bl()?localStorage:Uf()?new Dr:nF()?sessionStorage:new tn}var Dr=class{getItem(e){return en.get(`${Dr.prefix}${e}`)}removeItem(e){en.erase(`${Dr.prefix}${e}`)}setItem(e,r,a){en.set(`${Dr.prefix}${e}`,r,a)}};Dr.prefix="coveo_";var $f=class{constructor(){this.cookieStorage=new Dr}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,r){localStorage.setItem(e,r),this.cookieStorage.setItem(e,r,31556926e3)}},tn=class{getItem(e){return null}removeItem(e){}setItem(e,r){}},ai="__coveo.analytics.history",Wf=20,Hf=1e3*60,zf=75,ni=class{constructor(e){this.store=e||sF()}addElement(e){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let r=this.getHistoryWithInternalTime();r!=null?this.isValidEntry(e)&&this.setHistory([e].concat(r)):this.setHistory([e])}addElementAsync(e){return x(this,void 0,void 0,function*(){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let r=yield this.getHistoryWithInternalTimeAsync();r!=null?this.isValidEntry(e)&&this.setHistory([e].concat(r)):this.setHistory([e])})}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return x(this,void 0,void 0,function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))})}getHistoryWithInternalTime(){try{let e=this.store.getItem(ai);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return x(this,void 0,void 0,function*(){try{let e=yield this.store.getItem(ai);return e?JSON.parse(e):[]}catch{return[]}})}setHistory(e){try{this.store.setItem(ai,JSON.stringify(e.slice(0,Wf)))}catch{}}clear(){try{this.store.removeItem(ai)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort((a,n)=>(n.internalTime||0)-(a.internalTime||0))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,zf)),e}isValidEntry(e){let r=this.getMostRecentElement();return r&&r.value==e.value?(e.internalTime||0)-(r.internalTime||0)>Hf:!0}stripInternalTime(e){return Array.isArray(e)?e.map(r=>{let{name:a,time:n,value:o}=r;return{name:a,time:n,value:o}}):[]}stripEmptyQuery(e){let{name:r,time:a,value:n}=e;return r&&typeof n=="string"&&r.toLowerCase()==="query"&&n.trim()===""?{name:r,time:a}:e}stripEmptyQueries(e){return e.map(r=>this.stripEmptyQuery(r))}},Gf=Object.freeze({__proto__:null,HistoryStore:ni,MAX_NUMBER_OF_HISTORY_ELEMENTS:Wf,MAX_VALUE_SIZE:zf,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:Hf,STORE_KEY:ai,default:ni}),cF=(t,e)=>x(void 0,void 0,void 0,function*(){return t===ne.view?(yield uF(e.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},e)):e}),uF=t=>x(void 0,void 0,void 0,function*(){let e=new ni,r={name:"PageView",value:t,time:new Date().toISOString()};yield e.addElementAsync(r)}),os,lF=new Uint8Array(16);function dF(){if(!os&&(os=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!os))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return os(lF)}var pF=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function is(t){return typeof t=="string"&&pF.test(t)}var Te=[];for(let t=0;t<256;++t)Te.push((t+256).toString(16).slice(1));function Yf(t,e=0){return(Te[t[e+0]]+Te[t[e+1]]+Te[t[e+2]]+Te[t[e+3]]+"-"+Te[t[e+4]]+Te[t[e+5]]+"-"+Te[t[e+6]]+Te[t[e+7]]+"-"+Te[t[e+8]]+Te[t[e+9]]+"-"+Te[t[e+10]]+Te[t[e+11]]+Te[t[e+12]]+Te[t[e+13]]+Te[t[e+14]]+Te[t[e+15]]).toLowerCase()}function fF(t){if(!is(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}function mF(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var gF="6ba7b810-9dad-11d1-80b4-00c04fd430c8",hF="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function SF(t,e,r){function a(n,o,i,s){var c;if(typeof n=="string"&&(n=mF(n)),typeof o=="string"&&(o=fF(o)),((c=o)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+n.length);if(u.set(o),u.set(n,o.length),u=r(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,i){s=s||0;for(let l=0;l<16;++l)i[s+l]=u[l];return i}return Yf(u)}try{a.name=t}catch{}return a.DNS=gF,a.URL=hF,a}var yF=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Kf={randomUUID:yF};function ha(t,e,r){if(Kf.randomUUID&&!e&&!t)return Kf.randomUUID();t=t||{};let a=t.random||(t.rng||dF)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,e){r=r||0;for(let n=0;n<16;++n)e[r+n]=a[n];return e}return Yf(a)}function CF(t,e,r,a){switch(t){case 0:return e&r^~e&a;case 1:return e^r^a;case 2:return e&r^e&a^r&a;case 3:return e^r^a}}function jl(t,e){return t<<e|t>>>32-e}function xF(t){let e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){let i=unescape(encodeURIComponent(t));t=[];for(let s=0;s<i.length;++s)t.push(i.charCodeAt(s))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);let a=t.length/4+2,n=Math.ceil(a/16),o=new Array(n);for(let i=0;i<n;++i){let s=new Uint32Array(16);for(let c=0;c<16;++c)s[c]=t[i*64+c*4]<<24|t[i*64+c*4+1]<<16|t[i*64+c*4+2]<<8|t[i*64+c*4+3];o[i]=s}o[n-1][14]=(t.length-1)*8/Math.pow(2,32),o[n-1][14]=Math.floor(o[n-1][14]),o[n-1][15]=(t.length-1)*8&4294967295;for(let i=0;i<n;++i){let s=new Uint32Array(80);for(let p=0;p<16;++p)s[p]=o[i][p];for(let p=16;p<80;++p)s[p]=jl(s[p-3]^s[p-8]^s[p-14]^s[p-16],1);let c=r[0],u=r[1],l=r[2],d=r[3],f=r[4];for(let p=0;p<80;++p){let m=Math.floor(p/20),S=jl(c,5)+CF(m,u,l,d)+f+e[m]+s[p]>>>0;f=d,d=l,l=jl(u,30)>>>0,u=c,c=S}r[0]=r[0]+c>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+f>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var vF=SF("v5",80,xF),Jf=vF,Xf="2.28.23",Zf=t=>`${t.protocol}//${t.hostname}${t.pathname.indexOf("/")===0?t.pathname:`/${t.pathname}`}${t.search}`,oi={pageview:"pageview",event:"event"},Ul=class{constructor({client:e,uuidGenerator:r=ha}){this.client=e,this.uuidGenerator=r}},em=class extends Ul{constructor({client:e,uuidGenerator:r=ha}){super({client:e,uuidGenerator:r});this.actionData={},this.pageViewId=r(),this.nextPageViewId=this.pageViewId,this.currentLocation=Zf(window.location),this.lastReferrer=Za()?document.referrer:"",this.addHooks()}getApi(e){switch(e){case"setAction":return this.setAction;default:return null}}setAction(e,r){this.action=e,this.actionData=r}clearData(){this.clearPluginData(),this.action=void 0,this.actionData={}}getLocationInformation(e,r){return Object.assign({hitType:e},this.getNextValues(e,r))}updateLocationInformation(e,r){this.updateLocationForNextPageView(e,r)}getDefaultContextInformation(e){let r={title:Za()?document.title:"",encoding:Za()?document.characterSet:"UTF-8"},a={screenResolution:`${screen.width}x${screen.height}`,screenColor:`${screen.colorDepth}-bit`},n={language:navigator.language,userAgent:navigator.userAgent},o={time:Date.now(),eventId:this.uuidGenerator()};return Object.assign(Object.assign(Object.assign(Object.assign({},o),a),n),r)}updateLocationForNextPageView(e,r){let{pageViewId:a,referrer:n,location:o}=this.getNextValues(e,r);this.lastReferrer=n,this.pageViewId=a,this.currentLocation=o,e===oi.pageview&&(this.nextPageViewId=this.uuidGenerator(),this.hasSentFirstPageView=!0)}getNextValues(e,r){return{pageViewId:e===oi.pageview?this.nextPageViewId:this.pageViewId,referrer:e===oi.pageview&&this.hasSentFirstPageView?this.currentLocation:this.lastReferrer,location:e===oi.pageview?this.getCurrentLocationFromPayload(r):this.currentLocation}}getCurrentLocationFromPayload(e){if(e.page){let r=n=>n.replace(/^\/?(.*)$/,"/$1");return`${(n=>n.split("/").slice(0,3).join("/"))(this.currentLocation)}${r(e.page)}`}else return Zf(window.location)}},qt=class{constructor(e,r){if(!is(e))throw Error("Not a valid uuid");this.clientId=e,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let e=Math.floor(Date.now()/1e3)-this.creationDate;return e<0||e>qt.expirationTime}validate(e,r){return!this.expired&&this.matchReferrer(e,r)}matchReferrer(e,r){try{let a=new URL(e);return r.some(n=>new RegExp(n.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(a.host))}catch{return!1}}static fromString(e){let r=e.split(".");if(r.length!==2)return null;let[a,n]=r;if(a.length!==32||isNaN(parseInt(n)))return null;let o=a.substring(0,8)+"-"+a.substring(8,12)+"-"+a.substring(12,16)+"-"+a.substring(16,20)+"-"+a.substring(20,32);return is(o)?new qt(o,Number.parseInt(n)*1e3):null}};qt.cvo_cid="cvo_cid";qt.expirationTime=120;var tm=class extends Ul{constructor({client:e,uuidGenerator:r=ha}){super({client:e,uuidGenerator:r})}getApi(e){switch(e){case"decorate":return this.decorate;case"acceptFrom":return this.acceptFrom;default:return null}}decorate(e){return x(this,void 0,void 0,function*(){if(!this.client.getCurrentVisitorId)throw new Error("Could not retrieve current clientId");try{let r=new URL(e),a=yield this.client.getCurrentVisitorId();return r.searchParams.set(qt.cvo_cid,new qt(a,Date.now()).toString()),r.toString()}catch{throw new Error("Invalid URL provided")}})}acceptFrom(e){this.client.setAcceptedLinkReferrers(e)}};tm.Id="link";var tt=Object.keys;function ss(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}var _l={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},FF=tt(_l).map(t=>_l[t]),bF=[...FF].join("|"),RF=new RegExp(`^(${bF}$)`),AF={svcAction:"svc_action",svcActionData:"svc_action_data"},PF=t=>tt(t).filter(e=>t[e]!==void 0).reduce((e,r)=>{let a=_l[r]||r;return Object.assign(Object.assign({},e),{[a]:t[r]})},{}),wF=t=>RF.test(t),EF=[wF],rm={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},am={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},Ne={action:"pa",list:"pal",listSource:"pls"},cs={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},IF=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],$l={id:"quoteId",affiliation:"quoteAffiliation"},Wl={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},kF={add:Ne,bookmark_add:Ne,bookmark_remove:Ne,click:Ne,checkout:Ne,checkout_option:Ne,detail:Ne,impression:Ne,remove:Ne,refund:Object.assign(Object.assign({},Ne),cs),purchase:Object.assign(Object.assign({},Ne),cs),quickview:Ne,quote:Object.assign(Object.assign({},Ne),$l),review:Object.assign(Object.assign({},Ne),Wl)},OF=tt(rm).map(t=>rm[t]),qF=tt(am).map(t=>am[t]),TF=tt(Ne).map(t=>Ne[t]),DF=tt(cs).map(t=>cs[t]),VF=tt(Wl).map(t=>Wl[t]),NF=tt($l).map(t=>$l[t]),MF=[...OF,"custom"].join("|"),LF=[...qF,"custom"].join("|"),nm="(pr[0-9]+)",om="(il[0-9]+pi[0-9]+)",QF=new RegExp(`^${nm}(${MF})$`),BF=new RegExp(`^(${om}(${LF}))|(il[0-9]+nm)$`),jF=new RegExp(`^(${TF.join("|")})$`),UF=new RegExp(`^(${DF.join("|")})$`),_F=new RegExp(`^${nm}custom$`),$F=new RegExp(`^${om}custom$`),WF=new RegExp(`^(${[...IF,...VF,...NF].join("|")})$`),HF=t=>QF.test(t),zF=t=>BF.test(t),GF=t=>jF.test(t),YF=t=>UF.test(t),KF=t=>WF.test(t),JF=[zF,HF,GF,YF,KF],XF=[_F,$F],ZF={anonymizeIp:"aip"},eb={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},tb={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},rb=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],ab=Object.assign(Object.assign(Object.assign(Object.assign({},ZF),eb),tb),rb.reduce((t,e)=>Object.assign(Object.assign({},t),{[e]:e}),{})),Hl=Object.assign(Object.assign({},ab),AF),nb=t=>{let e=!!t.action&&kF[t.action]||{};return tt(t).reduce((r,a)=>{let n=e[a]||Hl[a]||a;return Object.assign(Object.assign({},r),{[n]:t[a]})},{})},ob=tt(Hl).map(t=>Hl[t]),ib=t=>ob.indexOf(t)!==-1,sb=t=>t==="custom",cb=t=>[...JF,...EF,ib,sb].some(e=>e(t)),ub=t=>tt(t).reduce((e,r)=>{let a=lb(r);return a?Object.assign(Object.assign({},e),db(a,t[r])):Object.assign(Object.assign({},e),{[r]:t[r]})},{}),lb=t=>{let e;return[...XF].every(r=>{var a;return e=(a=r.exec(t))===null||a===void 0?void 0:a[1],!Boolean(e)}),e},db=(t,e)=>tt(e).reduce((r,a)=>Object.assign(Object.assign({},r),{[`${t}${a}`]:e[a]}),{}),im=class{constructor(e){this.opts=e}sendEvent(e,r){return x(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:a,preprocessRequest:n}=this.opts,o=yield this.getQueryParamsForEventType(e),{url:i,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${a}/analytics/${e}?${o}`,r,n),c=this.encodeForEventType(e,s),u=new Blob([c],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,u)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,r,a){return x(this,void 0,void 0,function*(){let n=e,o=r;if(a){let i=yield a({url:e,body:JSON.stringify(r)},"analyticsBeacon"),{url:s,body:c}=i;n=s||e;try{o=JSON.parse(c)}catch(u){console.error("Unable to process the request body as a JSON string",u)}}return{payload:o,url:n}})}encodeForEventType(e,r){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,r):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},r))}getQueryParamsForEventType(e){return x(this,void 0,void 0,function*(){let{token:r,visitorIdProvider:a}=this.opts,n=yield a.getCurrentVisitorId();return[r&&this.isEventTypeLegacy(e)?`access_token=${r}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter(o=>!!o).join("&")})}isEventTypeLegacy(e){return[ne.click,ne.custom,ne.search,ne.view].indexOf(e)!==-1}encodeForLegacyType(e,r){return`${e}Event=${encodeURIComponent(JSON.stringify(r))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter(r=>!!e[r]).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(this.encodeValue(e[r]))}`).join("&")}encodeValue(e){return typeof e=="number"||typeof e=="string"||typeof e=="boolean"?e:JSON.stringify(e)}},sm=class{sendEvent(e,r){return x(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return x(this,void 0,void 0,function*(){return Promise.resolve()})}},cm=window.fetch,zl=class{constructor(e){this.opts=e}sendEvent(e,r){return x(this,void 0,void 0,function*(){let{baseUrl:a,visitorIdProvider:n,preprocessRequest:o}=this.opts,i=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",s={url:`${a}/analytics/${e}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(r)},c=Object.assign(Object.assign({},s),o?yield o(s,"analyticsFetch"):{}),{url:u}=c,l=Ot(c,["url"]),d=yield cm(u,l);if(d.ok){let f=yield d.json();return f.visitorId&&n.setCurrentVisitorId(f.visitorId),f}else{try{d.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,d,r),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return x(this,void 0,void 0,function*(){let{baseUrl:e}=this.opts,r=`${e}/analytics/visit`;yield cm(r,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(e){return[ne.click,ne.custom,ne.search,ne.view].indexOf(e)!==-1}getVisitorIdParam(){return x(this,void 0,void 0,function*(){let{visitorIdProvider:e}=this.opts,r=yield e.getCurrentVisitorId();return r?`?visitor=${r}`:""})}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},um=class{constructor(e,r){Bl()&&Uf()?this.storage=new $f:Bl()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new tn),this.client=new zl(e),this.beaconClient=new im(e),window.addEventListener("beforeunload",()=>{let a=r();for(let{eventType:n,payload:o}of a)this.beaconClient.sendEvent(n,o)})}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},lm=class{constructor(e,r){this.storage=r||new tn,this.client=new zl(e)}getClientDependingOnEventType(e){return this.client}},dm=class{constructor(){this.storage=new tn,this.client=new sm}getClientDependingOnEventType(e){return this.client}},pb="xx",fb=t=>(t==null?void 0:t.startsWith(pb))||!1,mb=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function gb(){return typeof navigator!="undefined"&&navigator.product=="ReactNative"}var hb=["1",1,"yes",!0];function ii(){return Ql()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(t=>hb.indexOf(t)!==-1)}var pm="v15",fm={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Sb(t=fm.default,e=pm,r=!1){if(t=t.replace(/\/$/,""),r)return`${t}/${e}`;let a=t.endsWith("/rest")||t.endsWith("/rest/ua");return`${t}${a?"":"/rest"}/${e}`}var yb="38824e1f-37f5-42d3-8372-a4b8fa9df946",je=class{get defaultOptions(){return{endpoint:fm.default,isCustomEndpoint:!1,token:"",version:pm,beforeSendHooks:[],afterSendHooks:[]}}get version(){return Xf}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[cF,iF].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let r={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};this.runtime=this.options.runtimeEnvironment||this.initRuntime(r),ii()&&(this.clear(),this.runtime.storage=new tn),this.addEventTypeMapping(ne.view,{newEventType:ne.view,addClientIdParameter:!0}),this.addEventTypeMapping(ne.click,{newEventType:ne.click,addClientIdParameter:!0}),this.addEventTypeMapping(ne.custom,{newEventType:ne.custom,addClientIdParameter:!0}),this.addEventTypeMapping(ne.search,{newEventType:ne.search,addClientIdParameter:!0})}initRuntime(e){return aF()&&Za()?new um(e,()=>{let r=[...this.bufferedRequests];return this.bufferedRequests=[],r}):(gb()&&console.warn(mb),new lm(e))}get storage(){return this.runtime.storage}determineVisitorId(){return x(this,void 0,void 0,function*(){try{return this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||ha()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),ha()}})}getCurrentVisitorId(){return x(this,void 0,void 0,function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId})}setCurrentVisitorId(e){return x(this,void 0,void 0,function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)})}setClientId(e,r){return x(this,void 0,void 0,function*(){if(is(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!r)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(Jf(e,Jf(r,yb)))}})}getParameters(e,...r){return x(this,void 0,void 0,function*(){return yield this.resolveParameters(e,...r)})}getPayload(e,...r){return x(this,void 0,void 0,function*(){let a=yield this.resolveParameters(e,...r);return yield this.resolvePayloadForParameters(e,a)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(ha()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(ii())return null;try{let r=new URL(e).searchParams.get(qt.cvo_cid);if(r==null)return null;let a=qt.fromString(r);return!a||!Za()||!a.validate(document.referrer,this.acceptedLinkReferrers)?null:a.clientId}catch{}return null}resolveParameters(e,...r){return x(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:a=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:o=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[e]||{};return yield[p=>a.length>0?this.parseVariableArgumentsPayload(a,p):p[0],p=>x(this,void 0,void 0,function*(){return Object.assign(Object.assign({},p),{visitorId:n?yield this.getCurrentVisitorId():""})}),p=>x(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},p),{clientId:yield this.getCurrentVisitorId()}):p}),p=>o?this.ensureAnonymousUserWhenUsingApiKey(p):p,p=>this.beforeSendHooks.reduce((m,S)=>x(this,void 0,void 0,function*(){let v=yield m;return yield S(e,v)}),p)].reduce((p,m)=>x(this,void 0,void 0,function*(){let S=yield p;return yield m(S)}),Promise.resolve(r))})}resolvePayloadForParameters(e,r){return x(this,void 0,void 0,function*(){let{usesMeasurementProtocol:a=!1}=this.eventTypeMapping[e]||{};return yield[d=>this.setTrackingIdIfTrackingIdNotPresent(d),d=>this.removeEmptyPayloadValues(d,e),d=>this.validateParams(d,e),d=>a?nb(d):d,d=>a?this.removeUnknownParameters(d):d,d=>a?this.processCustomParameters(d):this.mapCustomParametersToCustomData(d)].reduce((d,f)=>x(this,void 0,void 0,function*(){let p=yield d;return yield f(p)}),Promise.resolve(r))})}makeEvent(e,...r){return x(this,void 0,void 0,function*(){let{newEventType:a=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...r),o=yield this.resolvePayloadForParameters(e,n);return{eventType:a,payload:o,log:i=>x(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:a,payload:Object.assign(Object.assign({},o),i)}),yield Promise.all(this.afterSendHooks.map(s=>s(e,Object.assign(Object.assign({},n),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(e,...r){return x(this,void 0,void 0,function*(){return(yield this.makeEvent(e,...r)).log({})})}deferExecution(){return new Promise(e=>setTimeout(e,0))}sendFromBuffer(){return x(this,void 0,void 0,function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:r,payload:a}=e;return this.runtime.getClientDependingOnEventType(r).sendEvent(r,a)}})}clear(){this.storage.removeItem("visitorId"),new ni().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return x(this,void 0,void 0,function*(){return this.makeEvent(ne.search,e)})}sendSearchEvent(e){var{searchQueryUid:r}=e,a=Ot(e,["searchQueryUid"]);return x(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(a)).log({searchQueryUid:r})})}makeClickEvent(e){return x(this,void 0,void 0,function*(){return this.makeEvent(ne.click,e)})}sendClickEvent(e){var{searchQueryUid:r}=e,a=Ot(e,["searchQueryUid"]);return x(this,void 0,void 0,function*(){return(yield this.makeClickEvent(a)).log({searchQueryUid:r})})}makeCustomEvent(e){return x(this,void 0,void 0,function*(){return this.makeEvent(ne.custom,e)})}sendCustomEvent(e){var{lastSearchQueryUid:r}=e,a=Ot(e,["lastSearchQueryUid"]);return x(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(a)).log({lastSearchQueryUid:r})})}makeViewEvent(e){return x(this,void 0,void 0,function*(){return this.makeEvent(ne.view,e)})}sendViewEvent(e){return x(this,void 0,void 0,function*(){return(yield this.makeViewEvent(e)).log({})})}getVisit(){return x(this,void 0,void 0,function*(){let r=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=r.visitorId,r})}getHealth(){return x(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,r){this.eventTypeMapping[e]=r}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every(r=>typeof r=="string"))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,r){let a={};for(let n=0,o=r.length;n<o;n++){let i=r[n];if(typeof i=="string")a[e[n]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},a),i)}return a}isKeyAllowedEmpty(e,r){return({[ne.search]:["queryText"]}[e]||[]).indexOf(r)!==-1}removeEmptyPayloadValues(e,r){let a=n=>typeof n!="undefined"&&n!==null&&n!=="";return Object.keys(e).filter(n=>this.isKeyAllowedEmpty(r,n)||a(e[n])).reduce((n,o)=>Object.assign(Object.assign({},n),{[o]:e[o]}),{})}removeUnknownParameters(e){return Object.keys(e).filter(a=>{if(cb(a))return!0;console.log(a,"is not processed by coveoua")}).reduce((a,n)=>Object.assign(Object.assign({},a),{[n]:e[n]}),{})}processCustomParameters(e){let{custom:r}=e,a=Ot(e,["custom"]),n={};r&&ss(r)&&(n=this.lowercaseKeys(r));let o=ub(a);return Object.assign(Object.assign({},n),o)}mapCustomParametersToCustomData(e){let{custom:r}=e,a=Ot(e,["custom"]);if(r&&ss(r)){let n=this.lowercaseKeys(r);return Object.assign(Object.assign({},a),{customData:Object.assign(Object.assign({},n),e.customData)})}else return e}lowercaseKeys(e){let r=Object.keys(e),a={};return r.forEach(n=>{a[n.toLowerCase()]=e[n]}),a}validateParams(e,r){let{anonymizeIp:a}=e,n=Ot(e,["anonymizeIp"]);return a!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${a}`.toLowerCase())==-1&&(n.anonymizeIp=1),(r==ne.view||r==ne.click||r==ne.search||r==ne.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),r==ne.view&&(n.location=this.limit(n.location,128)),(r=="pageview"||r=="event")&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:r}=e,a=Ot(e,["userId"]);return fb(this.options.token)&&!r?(a.userId="anonymous",a):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:r}=e,a=Ot(e,["trackingId"]);return r?e:(a.hasOwnProperty("custom")&&ss(a.custom)&&(a.custom.hasOwnProperty("context_website")||a.custom.hasOwnProperty("siteName"))&&(a.trackingId=a.custom.context_website||a.custom.siteName),a.hasOwnProperty("customData")&&ss(a.customData)&&(a.customData.hasOwnProperty("context_website")||a.customData.hasOwnProperty("siteName"))&&(a.trackingId=a.customData.context_website||a.customData.siteName),a)}limit(e,r){return typeof e!="string"?e:e.substring(0,r)}get baseUrl(){return Sb(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},De;(function(t){t.contextChanged="contextChanged",t.expandToFullUI="expandToFullUI",t.openUserActions="openUserActions",t.showPrecedingSessions="showPrecedingSessions",t.showFollowingSessions="showFollowingSessions",t.clickViewedDocument="clickViewedDocument",t.clickPageView="clickPageView",t.createArticle="createArticle"})(De||(De={}));var g;(function(t){t.interfaceLoad="interfaceLoad",t.interfaceChange="interfaceChange",t.didyoumeanAutomatic="didyoumeanAutomatic",t.didyoumeanClick="didyoumeanClick",t.resultsSort="resultsSort",t.searchboxSubmit="searchboxSubmit",t.searchboxClear="searchboxClear",t.searchboxAsYouType="searchboxAsYouType",t.breadcrumbFacet="breadcrumbFacet",t.breadcrumbResetAll="breadcrumbResetAll",t.documentQuickview="documentQuickview",t.documentOpen="documentOpen",t.omniboxAnalytics="omniboxAnalytics",t.omniboxFromLink="omniboxFromLink",t.searchFromLink="searchFromLink",t.triggerNotify="notify",t.triggerExecute="execute",t.triggerQuery="query",t.undoTriggerQuery="undoQuery",t.triggerRedirect="redirect",t.pagerResize="pagerResize",t.pagerNumber="pagerNumber",t.pagerNext="pagerNext",t.pagerPrevious="pagerPrevious",t.pagerScrolling="pagerScrolling",t.staticFilterClearAll="staticFilterClearAll",t.staticFilterSelect="staticFilterSelect",t.staticFilterDeselect="staticFilterDeselect",t.facetClearAll="facetClearAll",t.facetSearch="facetSearch",t.facetSelect="facetSelect",t.facetSelectAll="facetSelectAll",t.facetDeselect="facetDeselect",t.facetExclude="facetExclude",t.facetUnexclude="facetUnexclude",t.facetUpdateSort="facetUpdateSort",t.facetShowMore="showMoreFacetResults",t.facetShowLess="showLessFacetResults",t.queryError="query",t.queryErrorBack="errorBack",t.queryErrorClear="errorClearQuery",t.queryErrorRetry="errorRetry",t.recommendation="recommendation",t.recommendationInterfaceLoad="recommendationInterfaceLoad",t.recommendationOpen="recommendationOpen",t.likeSmartSnippet="likeSmartSnippet",t.dislikeSmartSnippet="dislikeSmartSnippet",t.expandSmartSnippet="expandSmartSnippet",t.collapseSmartSnippet="collapseSmartSnippet",t.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",t.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",t.sendSmartSnippetReason="sendSmartSnippetReason",t.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",t.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",t.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",t.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",t.openSmartSnippetSource="openSmartSnippetSource",t.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",t.openSmartSnippetInlineLink="openSmartSnippetInlineLink",t.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",t.recentQueryClick="recentQueriesClick",t.clearRecentQueries="clearRecentQueries",t.recentResultClick="recentResultClick",t.clearRecentResults="clearRecentResults",t.noResultsBack="noResultsBack",t.showMoreFoldedResults="showMoreFoldedResults",t.showLessFoldedResults="showLessFoldedResults",t.copyToClipboard="copyToClipboard",t.caseSendEmail="Case.SendEmail",t.feedItemTextPost="FeedItem.TextPost",t.caseAttach="caseAttach",t.caseDetach="caseDetach",t.retryGeneratedAnswer="retryGeneratedAnswer",t.likeGeneratedAnswer="likeGeneratedAnswer",t.dislikeGeneratedAnswer="dislikeGeneratedAnswer",t.openGeneratedAnswerSource="openGeneratedAnswerSource",t.generatedAnswerStreamEnd="generatedAnswerStreamEnd",t.generatedAnswerSourceHover="generatedAnswerSourceHover",t.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",t.generatedAnswerHideAnswers="generatedAnswerHideAnswers",t.generatedAnswerShowAnswers="generatedAnswerShowAnswers",t.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",t.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(g||(g={}));var Gl={[g.triggerNotify]:"queryPipelineTriggers",[g.triggerExecute]:"queryPipelineTriggers",[g.triggerQuery]:"queryPipelineTriggers",[g.triggerRedirect]:"queryPipelineTriggers",[g.queryError]:"errors",[g.queryErrorBack]:"errors",[g.queryErrorClear]:"errors",[g.queryErrorRetry]:"errors",[g.pagerNext]:"getMoreResults",[g.pagerPrevious]:"getMoreResults",[g.pagerNumber]:"getMoreResults",[g.pagerResize]:"getMoreResults",[g.pagerScrolling]:"getMoreResults",[g.facetSearch]:"facet",[g.facetShowLess]:"facet",[g.facetShowMore]:"facet",[g.recommendation]:"recommendation",[g.likeSmartSnippet]:"smartSnippet",[g.dislikeSmartSnippet]:"smartSnippet",[g.expandSmartSnippet]:"smartSnippet",[g.collapseSmartSnippet]:"smartSnippet",[g.openSmartSnippetFeedbackModal]:"smartSnippet",[g.closeSmartSnippetFeedbackModal]:"smartSnippet",[g.sendSmartSnippetReason]:"smartSnippet",[g.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[g.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[g.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[g.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[g.clearRecentQueries]:"recentQueries",[g.recentResultClick]:"recentlyClickedDocuments",[g.clearRecentResults]:"recentlyClickedDocuments",[g.showLessFoldedResults]:"folding",[g.caseDetach]:"case",[g.likeGeneratedAnswer]:"generatedAnswer",[g.dislikeGeneratedAnswer]:"generatedAnswer",[g.openGeneratedAnswerSource]:"generatedAnswer",[g.generatedAnswerStreamEnd]:"generatedAnswer",[g.generatedAnswerSourceHover]:"generatedAnswer",[g.generatedAnswerCopyToClipboard]:"generatedAnswer",[g.generatedAnswerHideAnswers]:"generatedAnswer",[g.generatedAnswerShowAnswers]:"generatedAnswer",[g.generatedAnswerFeedbackSubmit]:"generatedAnswer",[De.expandToFullUI]:"interface",[De.openUserActions]:"User Actions",[De.showPrecedingSessions]:"User Actions",[De.showFollowingSessions]:"User Actions",[De.clickViewedDocument]:"User Actions",[De.clickPageView]:"User Actions",[De.createArticle]:"createArticle"},Sa=class{constructor(){this.runtime=new dm,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(ne.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(ne.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(ne.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(ne.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Xf}};function Cb(t){let e="";return t.filter(r=>{let a=r!==e;return e=r,a})}function xb(t){return t.map(e=>e.replace(/;/g,""))}function mm(t){let e=256,r=t.join(";");return r.length<=e?r:mm(t.slice(1))}var gm=t=>{let e=xb(t),r=Cb(e);return mm(r)};function hm(t){let e=typeof t.partialQueries=="string"?t.partialQueries:gm(t.partialQueries),r=typeof t.suggestions=="string"?t.suggestions:gm(t.suggestions);return Object.assign(Object.assign({},t),{partialQueries:e,suggestions:r})}var ya=class{constructor(e,r){this.opts=e,this.provider=r;let a=e.enableAnalytics===!1||ii();this.coveoAnalyticsClient=a?new Sa:new je(e)}disable(){this.coveoAnalyticsClient instanceof je&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Sa}enable(){this.coveoAnalyticsClient=new je(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(g.interfaceLoad)}logInterfaceLoad(){return x(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(g.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return x(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(g.recommendation)}logRecommendation(){return x(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(e,r){return this.makeClickEvent(g.recommendationOpen,e,r)}logRecommendationOpen(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(e){return this.makeSearchEvent(g.staticFilterClearAll,e)}logStaticFilterClearAll(e){return x(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(e){return this.makeSearchEvent(g.staticFilterSelect,e)}logStaticFilterSelect(e){return x(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(e){return this.makeSearchEvent(g.staticFilterDeselect,e)}logStaticFilterDeselect(e){return x(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(g.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return x(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(e){return this.makeSearchEvent(g.interfaceChange,e)}logInterfaceChange(e){return x(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(g.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return x(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(g.didyoumeanClick)}logDidYouMeanClick(){return x(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(e){return this.makeSearchEvent(g.resultsSort,e)}logResultsSort(e){return x(this,void 0,void 0,function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(g.searchboxSubmit)}logSearchboxSubmit(){return x(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(g.searchboxClear)}logSearchboxClear(){return x(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(g.searchboxAsYouType)}logSearchboxAsYouType(){return x(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(e){return this.makeSearchEvent(g.breadcrumbFacet,e)}logBreadcrumbFacet(e){return x(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(g.breadcrumbResetAll)}logBreadcrumbResetAll(){return x(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(e,r){return this.makeClickEvent(g.documentQuickview,e,r)}logDocumentQuickview(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(e,r){return this.makeClickEvent(g.documentOpen,e,r)}logDocumentOpen(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(e){return this.makeSearchEvent(g.omniboxAnalytics,hm(e))}logOmniboxAnalytics(e){return x(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(e){return this.makeSearchEvent(g.omniboxFromLink,hm(e))}logOmniboxFromLink(e){return x(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(g.searchFromLink)}logSearchFromLink(){return x(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(e){return this.makeCustomEvent(g.triggerNotify,e)}logTriggerNotify(e){return x(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(e){return this.makeCustomEvent(g.triggerExecute,e)}logTriggerExecute(e){return x(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(g.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return x(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(e){return this.makeSearchEvent(g.undoTriggerQuery,e)}logUndoTriggerQuery(e){return x(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(e){return this.makeCustomEvent(g.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return x(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(e){return this.makeCustomEvent(g.pagerResize,e)}logPagerResize(e){return x(this,void 0,void 0,function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(e){return this.makeCustomEvent(g.pagerNumber,e)}logPagerNumber(e){return x(this,void 0,void 0,function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(e){return this.makeCustomEvent(g.pagerNext,e)}logPagerNext(e){return x(this,void 0,void 0,function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(e){return this.makeCustomEvent(g.pagerPrevious,e)}logPagerPrevious(e){return x(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(g.pagerScrolling)}logPagerScrolling(){return x(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(e){return this.makeSearchEvent(g.facetClearAll,e)}logFacetClearAll(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(e){return this.makeSearchEvent(g.facetSearch,e)}logFacetSearch(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(e){return this.makeSearchEvent(g.facetSelect,e)}logFacetSelect(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(e){return this.makeSearchEvent(g.facetDeselect,e)}logFacetDeselect(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(e){return this.makeSearchEvent(g.facetExclude,e)}logFacetExclude(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(e){return this.makeSearchEvent(g.facetUnexclude,e)}logFacetUnexclude(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(e){return this.makeSearchEvent(g.facetSelectAll,e)}logFacetSelectAll(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(e){return this.makeSearchEvent(g.facetUpdateSort,e)}logFacetUpdateSort(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(e){return this.makeCustomEvent(g.facetShowMore,e)}logFacetShowMore(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(e){return this.makeCustomEvent(g.facetShowLess,e)}logFacetShowLess(e){return x(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(e){return this.makeCustomEvent(g.queryError,e)}logQueryError(e){return x(this,void 0,void 0,function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return x(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(g.queryErrorBack);return{description:e.description,log:()=>x(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(g.queryErrorBack)})}})}logQueryErrorBack(){return x(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return x(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(g.queryErrorRetry);return{description:e.description,log:()=>x(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(g.queryErrorRetry)})}})}logQueryErrorRetry(){return x(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return x(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(g.queryErrorClear);return{description:e.description,log:()=>x(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(g.queryErrorClear)})}})}logQueryErrorClear(){return x(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(g.likeSmartSnippet)}logLikeSmartSnippet(){return x(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(g.dislikeSmartSnippet)}logDislikeSmartSnippet(){return x(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(g.expandSmartSnippet)}logExpandSmartSnippet(){return x(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(g.collapseSmartSnippet)}logCollapseSmartSnippet(){return x(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(g.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return x(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(g.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return x(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(e,r){return this.makeCustomEvent(g.sendSmartSnippetReason,{reason:e,details:r})}logSmartSnippetFeedbackReason(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(g.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return x(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(g.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return x(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(g.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return x(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(g.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return x(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(e,r){return this.makeClickEvent(g.openSmartSnippetSource,e,r)}logOpenSmartSnippetSource(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(e,r){return this.makeClickEvent(g.openSmartSnippetSuggestionSource,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}makeCopyToClipboard(e,r){return this.makeClickEvent(g.copyToClipboard,e,r)}logCopyToClipboard(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(e,r)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(e,r){return this.makeClickEvent(g.openSmartSnippetInlineLink,e,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},r)}logOpenSmartSnippetInlineLink(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(e,r){return this.makeClickEvent(g.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logOpenSmartSnippetSuggestionInlineLink(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(g.recentQueryClick)}logRecentQueryClick(){return x(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(g.clearRecentQueries)}logClearRecentQueries(){return x(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(e,r){return this.makeCustomEvent(g.recentResultClick,{info:e,identifier:r})}logRecentResultClick(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(g.clearRecentResults)}logClearRecentResults(){return x(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(g.noResultsBack)}logNoResultsBack(){return x(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(e,r){return this.makeClickEvent(g.showMoreFoldedResults,e,r)}logShowMoreFoldedResults(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(g.showLessFoldedResults)}logShowLessFoldedResults(){return x(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(e,r){var a;return{actionCause:r,customData:(a=e.payload)===null||a===void 0?void 0:a.customData}}makeCustomEvent(e,r,a=Gl[e]){return x(this,void 0,void 0,function*(){this.coveoAnalyticsClient.getParameters;let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),o=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:a,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(o);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEvent(e,r,a=Gl[e]){return x(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(e,r,a)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(e,r,a){return x(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),a),o=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(o);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEventWithType(e,r,a){return x(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(e,r,a)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(e,r){return x(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(e,r){return x(this,void 0,void 0,function*(){let a=yield this.getBaseSearchEventRequest(e,r),n=yield this.coveoAnalyticsClient.makeSearchEvent(a);return{description:this.makeEventDescription(n,e),log:({searchUID:o})=>n.log({searchQueryUid:o})}})}makeClickEvent(e,r,a,n){return x(this,void 0,void 0,function*(){let o=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},a),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),i=yield this.coveoAnalyticsClient.makeClickEvent(o);return{description:this.makeEventDescription(i,e),log:({searchUID:s})=>i.log({searchQueryUid:s})}})}logClickEvent(e,r,a,n){return x(this,void 0,void 0,function*(){return(yield this.makeClickEvent(e,r,a,n)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,r){var a,n;return x(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(n=(a=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(a)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return x(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,r;return{originContext:(r=(e=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof je?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",r=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),r&&{splitTestRunVersion:r})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(g.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return x(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(g.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return x(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(g.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return x(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(g.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return x(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(g.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return x(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(g.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return x(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(g.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return x(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(g.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return x(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(g.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return x(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(g.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return x(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(g.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return x(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})})}},us=Object.assign({},oi),Sm=Object.keys(us).map(t=>us[t]),si=class extends em{constructor({client:e,uuidGenerator:r=ha}){super({client:e,uuidGenerator:r});this.ticket={}}getApi(e){let r=super.getApi(e);if(r!==null)return r;switch(e){case"setTicket":return this.setTicket;default:return null}}addHooks(){this.addHooksForEvent(),this.addHooksForPageView(),this.addHooksForSVCEvents()}setTicket(e){this.ticket=e}clearPluginData(){this.ticket={}}addHooksForSVCEvents(){this.client.registerBeforeSendEventHook((e,...[r])=>Sm.indexOf(e)!==-1?this.addSVCDataToPayload(e,r):r),this.client.registerAfterSendEventHook((e,...[r])=>(Sm.indexOf(e)!==-1&&this.updateLocationInformation(e,r),r))}addHooksForPageView(){this.client.addEventTypeMapping(us.pageview,{newEventType:ne.collect,variableLengthArgumentsNames:["page"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addHooksForEvent(){this.client.addEventTypeMapping(us.event,{newEventType:ne.collect,variableLengthArgumentsNames:["eventCategory","eventAction","eventLabel","eventValue"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addSVCDataToPayload(e,r){var a;let n=Object.assign(Object.assign(Object.assign(Object.assign({},this.getLocationInformation(e,r)),this.getDefaultContextInformation(e)),this.action?{svcAction:this.action}:{}),Object.keys((a=this.actionData)!==null&&a!==void 0?a:{}).length>0?{svcActionData:this.actionData}:{}),o=this.getTicketPayload();return this.clearData(),Object.assign(Object.assign(Object.assign({},o),n),r)}getTicketPayload(){return PF(this.ticket)}};si.Id="svc";var ls;(function(t){t.click="click",t.flowStart="flowStart"})(ls||(ls={}));var xt;(function(t){t.enterInterface="ticket_create_start",t.fieldUpdate="ticket_field_update",t.fieldSuggestionClick="ticket_classification_click",t.suggestionClick="suggestion_click",t.suggestionRate="suggestion_rate",t.nextCaseStep="ticket_next_stage",t.caseCancelled="ticket_cancel",t.caseSolved="ticket_cancel",t.caseCreated="ticket_create"})(xt||(xt={}));var ds;(function(t){t.quit="Quit",t.solved="Solved"})(ds||(ds={}));var Yl=class{constructor(e,r){var a;this.options=e,this.provider=r;let n=((a=e.enableAnalytics)!==null&&a!==void 0?a:!0)&&!ii();this.coveoAnalyticsClient=n?new je(e):new Sa,this.svc=new si({client:this.coveoAnalyticsClient})}disable(){this.coveoAnalyticsClient instanceof je&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Sa,this.svc=new si({client:this.coveoAnalyticsClient})}enable(){this.coveoAnalyticsClient=new je(this.options),this.svc=new si({client:this.coveoAnalyticsClient})}logEnterInterface(e){return this.svc.setAction(xt.enterInterface),this.svc.setTicket(e.ticket),this.sendFlowStartEvent()}logUpdateCaseField(e){return this.svc.setAction(xt.fieldUpdate,{fieldName:e.fieldName}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logSelectFieldSuggestion(e){return this.svc.setAction(xt.fieldSuggestionClick,e.suggestion),this.svc.setTicket(e.ticket),this.sendClickEvent()}logSelectDocumentSuggestion(e){return this.svc.setAction(xt.suggestionClick,e.suggestion),this.svc.setTicket(e.ticket),this.sendClickEvent()}logRateDocumentSuggestion(e){return this.svc.setAction(xt.suggestionRate,Object.assign({rate:e.rating},e.suggestion)),this.svc.setTicket(e.ticket),this.sendClickEvent()}logMoveToNextCaseStep(e){return this.svc.setAction(xt.nextCaseStep,{stage:e==null?void 0:e.stage}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseCancelled(e){return this.svc.setAction(xt.caseCancelled,{reason:ds.quit}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseSolved(e){return this.svc.setAction(xt.caseSolved,{reason:ds.solved}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseCreated(e){return this.svc.setAction(xt.caseCreated),this.svc.setTicket(e.ticket),this.sendClickEvent()}sendFlowStartEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",ls.flowStart,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}sendClickEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",ls.click,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}},vb=t=>{let e={};return t.caseContext&&Object.keys(t.caseContext).forEach(r=>{var a;let n=(a=t.caseContext)===null||a===void 0?void 0:a[r];if(n){let o=`context_${r}`;e[o]=n}}),e},U=(t,e=!0)=>{let{caseContext:r,caseId:a,caseNumber:n}=t,o=Ot(t,["caseContext","caseId","caseNumber"]),i=vb(t);return Object.assign(Object.assign(Object.assign({CaseId:a,CaseNumber:n},o),!!i.context_Case_Subject&&{CaseSubject:i.context_Case_Subject}),e&&i)},Kl=class{constructor(e,r){this.opts=e,this.provider=r;let a=e.enableAnalytics===!1||ii();this.coveoAnalyticsClient=a?new Sa:new je(e)}disable(){this.coveoAnalyticsClient instanceof je&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Sa}enable(){this.coveoAnalyticsClient=new je(this.opts)}logInterfaceLoad(e){if(e){let r=U(e);return this.logSearchEvent(g.interfaceLoad,r)}return this.logSearchEvent(g.interfaceLoad)}logInterfaceChange(e){let r=U(e);return this.logSearchEvent(g.interfaceChange,r)}logStaticFilterDeselect(e){let r=U(e);return this.logSearchEvent(g.staticFilterDeselect,r)}logFetchMoreResults(e){if(e){let r=U(e);return this.logCustomEvent(g.pagerScrolling,Object.assign(Object.assign({},r),{type:"getMoreResults"}))}return this.logCustomEvent(g.pagerScrolling,{type:"getMoreResults"})}logBreadcrumbFacet(e){let r=U(e);return this.logSearchEvent(g.breadcrumbFacet,r)}logBreadcrumbResetAll(e){if(e){let r=U(e);return this.logSearchEvent(g.breadcrumbResetAll,r)}return this.logSearchEvent(g.breadcrumbResetAll)}logFacetSelect(e){let r=U(e);return this.logSearchEvent(g.facetSelect,r)}logFacetExclude(e){let r=U(e);return this.logSearchEvent(g.facetExclude,r)}logFacetDeselect(e){let r=U(e);return this.logSearchEvent(g.facetDeselect,r)}logFacetUpdateSort(e){let r=U(e);return this.logSearchEvent(g.facetUpdateSort,r)}logFacetClearAll(e){let r=U(e);return this.logSearchEvent(g.facetClearAll,r)}logFacetShowMore(e){let r=U(e,!1);return this.logCustomEvent(g.facetShowMore,r)}logFacetShowLess(e){let r=U(e,!1);return this.logCustomEvent(g.facetShowLess,r)}logQueryError(e){let r=U(e,!1);return this.logCustomEvent(g.queryError,r)}logPagerNumber(e){let r=U(e,!1);return this.logCustomEvent(g.pagerNumber,r)}logPagerNext(e){let r=U(e,!1);return this.logCustomEvent(g.pagerNext,r)}logPagerPrevious(e){let r=U(e,!1);return this.logCustomEvent(g.pagerPrevious,r)}logDidYouMeanAutomatic(e){if(e){let r=U(e);return this.logSearchEvent(g.didyoumeanAutomatic,r)}return this.logSearchEvent(g.didyoumeanAutomatic)}logDidYouMeanClick(e){if(e){let r=U(e);return this.logSearchEvent(g.didyoumeanClick,r)}return this.logSearchEvent(g.didyoumeanClick)}logResultsSort(e){let r=U(e);return this.logSearchEvent(g.resultsSort,r)}logSearchboxSubmit(e){if(e){let r=U(e);return this.logSearchEvent(g.searchboxSubmit,r)}return this.logSearchEvent(g.searchboxSubmit)}logContextChanged(e){let r=U(e);return this.logSearchEvent(De.contextChanged,r)}logExpandToFullUI(e){let r=U(e);return this.logCustomEvent(De.expandToFullUI,r)}logOpenUserActions(e){let r=U(e,!1);return this.logCustomEvent(De.openUserActions,r)}logShowPrecedingSessions(e){let r=U(e,!1);return this.logCustomEvent(De.showPrecedingSessions,r)}logShowFollowingSessions(e){let r=U(e,!1);return this.logCustomEvent(De.showFollowingSessions,r)}logViewedDocumentClick(e,r){return this.logCustomEvent(De.clickViewedDocument,Object.assign(Object.assign({},U(r,!1)),{document:e}))}logPageViewClick(e,r){return this.logCustomEvent(De.clickPageView,Object.assign(Object.assign({},U(r,!1)),{pageView:e}))}logCreateArticle(e,r){return this.logCustomEvent(De.createArticle,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logDocumentOpen(e,r,a){return this.logClickEvent(g.documentOpen,e,r,a?U(a,!1):void 0)}logCopyToClipboard(e,r,a){return this.logClickEvent(g.copyToClipboard,e,r,a?U(a,!1):void 0)}logCaseSendEmail(e,r,a){return this.logClickEvent(g.caseSendEmail,e,r,a?U(a,!1):void 0)}logFeedItemTextPost(e,r,a){return this.logClickEvent(g.feedItemTextPost,e,r,a?U(a,!1):void 0)}logDocumentQuickview(e,r,a){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl};return this.logClickEvent(g.documentQuickview,e,r,a?Object.assign(Object.assign({},U(a,!1)),n):n)}logCaseAttach(e,r,a){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl,resultUriHash:e.documentUriHash};return this.logClickEvent(g.caseAttach,e,r,a?Object.assign(Object.assign({},U(a,!1)),n):n)}logCaseDetach(e,r){return this.logCustomEvent(g.caseDetach,r?Object.assign(Object.assign({},U(r,!1)),{resultUriHash:e}):{resultUriHash:e})}logLikeSmartSnippet(e){return this.logCustomEvent(g.likeSmartSnippet,e?U(e,!1):void 0)}logDislikeSmartSnippet(e){return this.logCustomEvent(g.dislikeSmartSnippet,e?U(e,!1):void 0)}logExpandSmartSnippet(e){return this.logCustomEvent(g.expandSmartSnippet,e?U(e,!1):void 0)}logCollapseSmartSnippet(e){return this.logCustomEvent(g.collapseSmartSnippet,e?U(e,!1):void 0)}logOpenSmartSnippetFeedbackModal(e){return this.logCustomEvent(g.openSmartSnippetFeedbackModal,e?U(e,!1):void 0)}logCloseSmartSnippetFeedbackModal(e){return this.logCustomEvent(g.closeSmartSnippetFeedbackModal,e?U(e,!1):void 0)}logSmartSnippetFeedbackReason(e,r,a){return this.logCustomEvent(g.sendSmartSnippetReason,a?Object.assign(Object.assign({},U(a,!1)),{reason:e,details:r}):{reason:e,details:r})}logExpandSmartSnippetSuggestion(e,r){let a="documentId"in e?e:{documentId:e};return this.logCustomEvent(g.expandSmartSnippetSuggestion,r?Object.assign(Object.assign({},U(r,!1)),a):a)}logCollapseSmartSnippetSuggestion(e,r){let a="documentId"in e?e:{documentId:e};return this.logCustomEvent(g.collapseSmartSnippetSuggestion,r?Object.assign(Object.assign({},U(r,!1)),a):a)}logOpenSmartSnippetSource(e,r,a){return this.logClickEvent(g.openSmartSnippetSource,e,r,a?U(a,!1):void 0)}logOpenSmartSnippetSuggestionSource(e,r,a){return this.logClickEvent(g.openSmartSnippetSuggestionSource,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},a?Object.assign(Object.assign({},U(a,!1)),r):r)}logOpenSmartSnippetInlineLink(e,r,a){return this.logClickEvent(g.openSmartSnippetInlineLink,e,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},a?Object.assign(Object.assign({},U(a,!1)),r):r)}logOpenSmartSnippetSuggestionInlineLink(e,r,a){return this.logClickEvent(g.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},a?Object.assign(Object.assign({},U(a,!1)),r):r)}logLikeGeneratedAnswer(e,r){return this.logCustomEvent(g.likeGeneratedAnswer,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logDislikeGeneratedAnswer(e,r){return this.logCustomEvent(g.dislikeGeneratedAnswer,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logOpenGeneratedAnswerSource(e,r){return this.logCustomEvent(g.openGeneratedAnswerSource,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logGeneratedAnswerSourceHover(e,r){return this.logCustomEvent(g.generatedAnswerSourceHover,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logGeneratedAnswerCopyToClipboard(e,r){return this.logCustomEvent(g.generatedAnswerCopyToClipboard,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logGeneratedAnswerHideAnswers(e,r){return this.logCustomEvent(g.generatedAnswerHideAnswers,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logGeneratedAnswerShowAnswers(e,r){return this.logCustomEvent(g.generatedAnswerShowAnswers,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logGeneratedAnswerFeedbackSubmit(e,r){return this.logCustomEvent(g.generatedAnswerFeedbackSubmit,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logRephraseGeneratedAnswer(e,r){return this.logSearchEvent(g.rephraseGeneratedAnswer,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logRetryGeneratedAnswer(e){return this.logSearchEvent(g.retryGeneratedAnswer,e?Object.assign({},U(e,!1)):{})}logGeneratedAnswerStreamEnd(e,r){return this.logCustomEvent(g.generatedAnswerStreamEnd,r?Object.assign(Object.assign({},U(r,!1)),e):e)}logCustomEvent(e,r){return x(this,void 0,void 0,function*(){let a=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),n=Object.assign(Object.assign({},yield this.getBaseCustomEventRequest(a)),{eventType:Gl[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)})}logSearchEvent(e,r){return x(this,void 0,void 0,function*(){return this.coveoAnalyticsClient.sendSearchEvent(yield this.getBaseSearchEventRequest(e,r))})}logClickEvent(e,r,a,n){return x(this,void 0,void 0,function*(){let o=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},a),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(o)})}logShowMoreFoldedResults(e,r,a){return x(this,void 0,void 0,function*(){return this.logClickEvent(g.showMoreFoldedResults,e,r,a?U(a,!1):void 0)})}logShowLessFoldedResults(e){return x(this,void 0,void 0,function*(){return this.logCustomEvent(g.showLessFoldedResults,e?U(e,!1):void 0)})}getBaseCustomEventRequest(e){return x(this,void 0,void 0,function*(){return Object.assign(Object.assign({},yield this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,r){var a,n;return x(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(n=(a=this.provider).getGeneratedAnswerMetadata)===null||n===void 0?void 0:n.call(a)))),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return x(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,r;return{originContext:(r=(e=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof je?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}};var ym=1,Cm=10,ps=5,xm=1,fs=8;function rn(){return{desiredCount:ps,numberOfValues:fs,set:{}}}var Tt=(t,e)=>{let r=a=>a.facetId===e;if("productListing"in t&&t.productListing&&"facets"in t.productListing&&"results"in t.productListing.facets)return t.productListing.facets.results.find(r);if("search"in t&&t.search)return t.search.response.facets.find(r)},Jl=(t,e)=>{var r;return(r=t.facetSet[e])==null?void 0:r.request};function Fb(t,e){return!!e&&e.facetId in t.facetSet}var ci=(t,e)=>{let r=Tt(t,e);if(Fb(t,r))return r},bb=(t,e)=>{let r=ci(t,e);return r?r.values.filter(a=>a.state==="selected"):[]},vm=(t,e)=>{let r=ci(t,e);return r?r.values.filter(a=>a.state!=="idle"):[]},Dt=t=>"productListing"in t?t.productListing.isLoading:t.search.isLoading;function Fm(t){if(!t)return{parents:[],values:[]};let e=[],r=t;for(;r.length&&r[0].children.length;)e=[...e,...r],r=r[0].children;let a=r.find(n=>n.state==="selected");return a&&(e=[...e,a],r=[]),{parents:e,values:r}}function Ke(t){let{activeValue:e,ancestryMap:r}=Rb(t);return e?Ab(e,r):[]}function Rb(t){let e=[...t],r=new Map;for(;e.length>0;){let a=e.shift();if(a.state==="selected")return{activeValue:a,ancestryMap:r};if(r)for(let n of a.children)r.set(n,a);e.unshift(...a.children)}return{}}function Ab(t,e){let r=[];if(!t)return[];let a=t;do r.unshift(a),a=e.get(a);while(a);return r}function Pb(t,e){return!!e&&e.facetId in t.categoryFacetSet}var Xl=(t,e)=>{let r=Tt(t,e);if(Pb(t,r))return r},Zl=(t,e)=>{var r;return(r=t.categoryFacetSet[e])==null?void 0:r.request},bm=(t,e)=>{var a;let r=Xl(t,e);return Ke((a=r==null?void 0:r.values)!=null?a:[])},ed=(t,e)=>{var a;let r=Zl(t,e);return Ke((a=r==null?void 0:r.currentValues)!=null?a:[])};function an(){return{}}function Rm(t){return{request:t}}function nn(){return{}}function Am(t){return{request:t}}function on(){return{}}function Pm(t){return{request:t,hasBreadcrumbs:!0}}function sn(){return{}}var cn=(t,e)=>{let r=km(e,t),a=r?r.field:"",n=td(a,t);return{facetId:t,facetField:a,facetTitle:n}};function ui(t,e){let{facetId:r,facetValue:a}=t,n=cn(r,e),o=Om(e,r);return{...n,facetValue:o==="hierarchical"?Im(e,r):a}}function Je(t){var e,r,a,n,o;return{facetSet:(e=t.facetSet)!=null?e:sn(),categoryFacetSet:(r=t.categoryFacetSet)!=null?r:an(),dateFacetSet:(a=t.dateFacetSet)!=null?a:nn(),numericFacetSet:(n=t.numericFacetSet)!=null?n:on(),automaticFacetSet:(o=t.automaticFacetSet)!=null?o:rn()}}var ms=t=>{let e=[];return Ib(t).forEach((r,a)=>{let n=Om(t,r.facetId),o=Db(r,a+1);if(Eb(r)){if(!!!ed(t,r.facetId).length)return;e.push({...o,...qb(t,r.facetId),facetType:n,state:"selected"});return}r.currentValues.forEach((i,s)=>{if(i.state==="idle")return;let c=wm(i,s+1,n),u=wb(r)?Em(i):Ob(i);e.push({...o,...c,...u})})}),kb(t).forEach((r,a)=>{let n=Tb(r,a+1);r.values.forEach((o,i)=>{if(o.state==="idle")return;let s=wm(o,i+1,"specific"),c=Em(o);e.push({...n,...s,...c})})}),e},wb=t=>t.type==="specific",Eb=t=>t.type==="hierarchical",Ib=t=>[...Object.values(t.facetSet),...Object.values(t.categoryFacetSet),...Object.values(t.dateFacetSet),...Object.values(t.numericFacetSet)].map(e=>e.request),kb=t=>[...Object.values(t.automaticFacetSet.set)].map(e=>e.response),wm=(t,e,r)=>({state:t.state,valuePosition:e,facetType:r}),Ob=t=>({displayValue:`${t.start}..${t.end}`,value:`${t.start}..${t.end}`,start:t.start,end:t.end,endInclusive:t.endInclusive}),Em=t=>({displayValue:t.value,value:t.value}),Im=(t,e)=>ed(t,e).map(a=>a.value).join(";"),qb=(t,e)=>{let r=1,a=Im(t,e);return{value:a,valuePosition:r,displayValue:a}},Tb=(t,e)=>({title:td(t.field,t.field),field:t.field,id:t.field,facetPosition:e}),Db=(t,e)=>({title:td(t.field,t.facetId),field:t.field,id:t.facetId,facetPosition:e}),td=(t,e)=>`${t}_${e}`,km=(t,e)=>{var r,a,n,o,i;return((r=t.facetSet[e])==null?void 0:r.request)||((a=t.categoryFacetSet[e])==null?void 0:a.request)||((n=t.dateFacetSet[e])==null?void 0:n.request)||((o=t.numericFacetSet[e])==null?void 0:o.request)||((i=t.automaticFacetSet.set[e])==null?void 0:i.response)},Om=(t,e)=>{let r=km(t,e);return r?r.type:"specific"};var Fe=()=>({q:"",enableQuerySyntax:!1});function un(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function Me(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:un(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:un(),extendedResults:{}}}function Vb(t,e){let r=`
  The following properties are invalid:

    ${t.join(`
	`)}
  
  ${e}
  `;return new li(r)}var li=class extends Error{constructor(t){super(t);this.name="SchemaValidationError"}},z=class{constructor(t){this.definition=t}validate(t={},e=""){let r={...this.default,...t},a=[];for(let n in this.definition){let o=this.definition[n].validate(r[n]);o&&a.push(`${n}: ${o}`)}if(a.length)throw Vb(a,e);return r}get default(){let t={};for(let e in this.definition){let r=this.definition[e].default;r!==void 0&&(t[e]=r)}return t}},ue=class{constructor(t={}){this.baseConfig=t}validate(t){return this.baseConfig.required&&ee(t)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function Ae(t){return t===void 0}function Nb(t){return t===null}function ee(t){return Ae(t)||Nb(t)}var I=class{constructor(t={}){this.config=t,this.value=new ue(t)}validate(t){let e=this.value.validate(t);return e||(Mb(t)?t<this.config.min?`minimum value of ${this.config.min} not respected.`:t>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function Mb(t){return Ae(t)||qm(t)}function qm(t){return typeof t=="number"&&!isNaN(t)}var $=class{constructor(t={}){this.value=new ue(t)}validate(t){let e=this.value.validate(t);return e||(Lb(t)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function Lb(t){return Ae(t)||Tm(t)}function Tm(t){return typeof t=="boolean"}var Qb=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,b=class{constructor(t={}){this.config={emptyAllowed:!0,url:!1,...t},this.value=new ue(this.config)}validate(t){let{emptyAllowed:e,url:r,regex:a,constrainTo:n}=this.config,o=this.value.validate(t);return o||(Ae(t)?null:ln(t)?!e&&!t.length?"value is an empty string.":r&&!Qb.test(t)?"value is not a valid URL.":a&&!a.test(t)?`value did not match provided regex ${a}`:n&&!n.includes(t)?`value should be one of: ${n.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function ln(t){return Object.prototype.toString.call(t)==="[object String]"}var E=class{constructor(t={}){this.config={options:{required:!1},values:{},...t}}validate(t){if(Ae(t))return this.config.options.required?"value is required and is currently undefined":null;if(!Dm(t))return"value is not an object";for(let[r,a]of Object.entries(this.config.values))if(a.required&&ee(t[r]))return`value does not contain ${r}`;let e="";for(let[r,a]of Object.entries(this.config.values)){let n=t[r],o=a.validate(n);o!==null&&(e+=" "+o)}return e===""?null:e}get default(){}get required(){return!!this.config.options.required}};function Dm(t){return t!==void 0&&typeof t=="object"}var H=class{constructor(t={}){this.config=t,this.value=new ue(this.config)}validate(t){if(!ee(t)&&!Array.isArray(t))return"value is not an array";let e=this.value.validate(t);if(e!==null)return e;if(ee(t))return null;if(this.config.max!==void 0&&t.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&t.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return t.forEach(a=>{this.config.each.required&&ee(a)&&(r=`value is null or undefined: ${t.join(",")}`);let n=this.validatePrimitiveValue(a,this.config.each);n!==null&&(r+=" "+n)}),r===""?null:r}return null}validatePrimitiveValue(t,e){return Tm(t)||ln(t)||qm(t)||Dm(t)?e.validate(t):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function dn(t){return Array.isArray(t)}var vt=class{constructor(t){this.config=t,this.value=new ue(t)}validate(t){let e=this.value.validate(t);return e!==null?e:Ae(t)||Object.values(this.config.enum).find(a=>a===t)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};var Vr=(r=>(r.Ascending="ascending",r.Descending="descending",r))(Vr||{}),Vt=(o=>(o.Relevancy="relevancy",o.QRE="qre",o.Date="date",o.Field="field",o.NoSort="nosort",o))(Vt||{}),fr=t=>{if(dn(t))return t.map(e=>fr(e)).join(",");switch(t.by){case"relevancy":case"qre":case"nosort":return t.by;case"date":return`date ${t.order}`;case"field":return`@${t.field} ${t.order}`;default:return""}},di=()=>({by:"relevancy"}),rd=t=>({by:"date",order:t}),ad=(t,e)=>({by:"field",order:e,field:t}),nd=()=>({by:"qre"}),od=()=>({by:"nosort"}),Vm=new E({values:{by:new vt({enum:Vt,required:!0}),order:new vt({enum:Vr}),field:new b}});function rt(){return fr(di())}var Nt=()=>"default";var pi="2.42.0";var Bb=t=>{let e=t.configuration.search.locale.split("-")[0];return!e||e.length!==2?"en":e},mr=class{constructor(e){this.getState=e;this.state=e()}getLanguage(){return Bb(this.state)}getBaseMetadata(){let{context:e}=this.state,r=(e==null?void 0:e.contextValues)||{},a={};for(let[n,o]of Object.entries(r)){let i=`context_${n}`;a[i]=o}return a.coveoHeadlessVersion=pi,a}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||Nt()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};var at=t=>new je(t).getCurrentVisitorId(),id=t=>{let e=new je(t);e.clear(),e.deleteHttpOnlyVisitorId()},Mt=new Gf.HistoryStore,Lt=(t,e)=>typeof e=="function"?(...r)=>{let a=Tr(r[0]);try{return e.apply(e,r)}catch(n){return t.error(n,"Error in analytics preprocessRequest. Returning original request."),a}}:void 0,Qt=(t,e)=>(...r)=>{let a=Tr(r[1]);try{return e.apply(e,r)}catch(n){return t.error(n,"Error in analytics hook. Returning original request."),a}};var gs=class extends mr{constructor(){super(...arguments);this.getFacetRequest=e=>{var r,a,n,o,i,s,c,u,l,d;return((a=(r=this.state.facetSet)==null?void 0:r[e])==null?void 0:a.request)||((o=(n=this.state.categoryFacetSet)==null?void 0:n[e])==null?void 0:o.request)||((s=(i=this.state.dateFacetSet)==null?void 0:i[e])==null?void 0:s.request)||((u=(c=this.state.numericFacetSet)==null?void 0:c[e])==null?void 0:u.request)||((d=(l=this.state.automaticFacetSet)==null?void 0:l.set[e])==null?void 0:d.response)}}getFacetState(){return ms(Je(this.getState()))}getPipeline(){var e;return this.state.pipeline||((e=this.state.search)==null?void 0:e.response.pipeline)||gs.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var r,a;let e=this.getState();return((r=e.search)==null?void 0:r.searchResponseId)||((a=e.search)==null?void 0:a.response.searchUid)||Me().response.searchUid}getSplitTestRunName(){var e;return(e=this.state.search)==null?void 0:e.response.splitTestRun}getSplitTestRunVersion(){var a;let e=!!this.getSplitTestRunName(),r=((a=this.state.search)==null?void 0:a.response.pipeline)||this.state.pipeline||gs.fallbackPipelineName;return e?r:void 0}getBaseMetadata(){var n,o,i;let e=this.getState(),r=super.getBaseMetadata(),a=(i=(o=(n=e.search)==null?void 0:n.response)==null?void 0:o.extendedResults)==null?void 0:i.generativeQuestionAnsweringId;return a&&(r.generativeQuestionAnsweringId=a),r}getFacetMetadata(e,r){var o;let a=this.getFacetRequest(e),n=(o=a==null?void 0:a.field)!=null?o:"";return{...this.getBaseMetadata(),facetId:e,facetField:n,facetValue:r,facetTitle:`${n}_${e}`}}getFacetClearAllMetadata(e){var n;let r=this.getFacetRequest(e),a=(n=r==null?void 0:r.field)!=null?n:"";return{...this.getBaseMetadata(),facetId:e,facetField:a,facetTitle:`${a}_${e}`}}getFacetSortMetadata(e,r){var o;let a=this.getFacetRequest(e),n=(o=a==null?void 0:a.field)!=null?o:"";return{...this.getBaseMetadata(),facetId:e,facetField:n,criteria:r,facetTitle:`${n}_${e}`}}getRangeFacetBreadcrumbMetadata(e,r){var o;let a=this.getFacetRequest(e),n=(o=a==null?void 0:a.field)!=null?o:"";return{...this.getBaseMetadata(),facetId:e,facetField:n,facetRangeEnd:r.end,facetRangeEndInclusive:r.endInclusive,facetRangeStart:r.start,facetTitle:`${n}_${e}`}}getResultSortMetadata(){var e;return{...this.getBaseMetadata(),resultsSortBy:(e=this.state.sortCriteria)!=null?e:rt()}}getStaticFilterToggleMetadata(e,r){return{...this.getBaseMetadata(),staticFilterId:e,staticFilterValue:r}}getStaticFilterClearAllMetadata(e){return{...this.getBaseMetadata(),staticFilterId:e}}getUndoTriggerQueryMetadata(e){return{...this.getBaseMetadata(),undoneQuery:e}}getCategoryFacetBreadcrumbMetadata(e,r){var o;let a=this.getFacetRequest(e),n=(o=a==null?void 0:a.field)!=null?o:"";return{...this.getBaseMetadata(),categoryFacetId:e,categoryFacetField:n,categoryFacetPath:r,categoryFacetTitle:`${n}_${e}`}}getOmniboxAnalyticsMetadata(e,r){let a=this.state.querySuggest&&this.state.querySuggest[e],n=a.completions.map(c=>c.expression),o=a.partialQueries.length-1,i=a.partialQueries[o]||"",s=a.responseId;return{...this.getBaseMetadata(),suggestionRanking:n.indexOf(r),partialQuery:i,partialQueries:a.partialQueries.length>0?a.partialQueries:"",suggestions:n.length>0?n:"",querySuggestResponseId:s}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(e){return{...this.getBaseMetadata(),...e}}getGeneratedAnswerMetadata(){var a;let e=this.getState(),r={};return((a=e.generatedAnswer)==null?void 0:a.isVisible)!==void 0&&(r.showGeneratedAnswer=e.generatedAnswer.isVisible),r}get resultURIs(){var e;return(e=this.results)==null?void 0:e.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){var e;return(e=this.state.search)==null?void 0:e.response.results}get queryText(){var e;return((e=this.state.query)==null?void 0:e.q)||Fe().q}get responseTime(){var e;return((e=this.state.search)==null?void 0:e.duration)||Me().duration}get numberOfResults(){var e;return((e=this.state.search)==null?void 0:e.response.totalCountFiltered)||Me().response.totalCountFiltered}},L=gs;L.fallbackPipelineName="default";var Nm=t=>{let e=t.configuration.accessToken,r=t.configuration.analytics.trackingId,{emit:a}=jf({url:t.configuration.analytics.nextApiBaseUrl,token:e,trackingId:r});return a},Mm=({logger:t,getState:e,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:a,provider:n=new L(e)})=>{let o=e(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new ya({token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Lt(t,a),beforeSendHooks:[Qt(t,r),(d,f)=>(t.info({...f,type:d,endpoint:s,token:i},"Analytics request"),f)]},n);return u||l.disable(),l},sd=()=>{let e=Mt.getHistory().reverse().find(r=>r.name==="PageView"&&r.value);return e?e.value:""};async function Lm(t,e){let r=t.getReader(),a;for(;!(a=await r.read()).done;)e(a.value)}function Qm(t){let e,r,a,n=!1;return function(i){e===void 0?(e=i,r=0,a=-1):e=jb(e,i);let s=e.length,c=0;for(;r<s;){n&&(e[r]===10&&(c=++r),n=!1);let u=-1;for(;r<s&&u===-1;++r)switch(e[r]){case 58:a===-1&&(a=r-c);break;case 13:n=!0;case 10:u=r;break}if(u===-1)break;t(e.subarray(c,u),a),c=r,a=-1}c===s?e=void 0:c!==0&&(e=e.subarray(c),r-=c)}}function Bm(t,e,r){let a=jm(),n=new TextDecoder;return function(i,s){if(i.length===0)r==null||r(a),a=jm();else if(s>0){let c=n.decode(i.subarray(0,s)),u=s+(i[s+1]===32?2:1),l=n.decode(i.subarray(u));switch(c){case"data":a.data=a.data?a.data+`
`+l:l;break;case"event":a.event=l;break;case"id":t(a.id=l);break;case"retry":let d=parseInt(l,10);isNaN(d)||e(a.retry=d);break}}}}function jb(t,e){let r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function jm(){return{data:"",event:"",id:"",retry:void 0}}var Ub=function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r},hs="text/event-stream",_b=1e3,Um="last-event-id";function cd(t,e){var{signal:r,headers:a,onopen:n,onmessage:o,onclose:i,onerror:s,openWhenHidden:c,fetch:u}=e,l=Ub(e,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((d,f)=>{let p=Object.assign({},a);p.accept||(p.accept=hs);let m;function S(){m?.abort(),document.hidden||te()}c||document.addEventListener("visibilitychange",S);let v=_b,C=0;function F(){document.removeEventListener("visibilitychange",S),window.clearTimeout(C),m?.abort()}r==null||r.addEventListener("abort",()=>{F(),d()});let D=u??window.fetch,Q=n??$b;async function te(){var ae;m=typeof AbortController=="undefined"?null:new AbortController;try{let oe=await D(t,Object.assign(Object.assign({},l),{headers:p,signal:m?.signal}));await Q(oe),await Lm(oe.body,Qm(Bm(X=>{X?p[Um]=X:delete p[Um]},X=>{v=X},o))),i==null||i(),F(),d()}catch(oe){if(!m?.signal.aborted)try{let X=(ae=s==null?void 0:s(oe))!==null&&ae!==void 0?ae:v;window.clearTimeout(C),C=window.setTimeout(te,X)}catch(X){F(),f(X)}}}te()})}function $b(t){let e=t.headers.get("content-type");if(!(e==null?void 0:e.startsWith(hs)))throw new Error(`Expected content-type to be ${hs}, Actual: ${e}`)}function Ss(){if(typeof window=="undefined"){let{AbortController:t}=$m();return new t}return typeof AbortController=="undefined"?null:new AbortController}var Ca=class{constructor(e){this._params={};this._basePath=e}addParam(e,r){this._params={...this.params,[e]:r}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([e,r])=>`${e}=${encodeURIComponent(r)}`).join("&")}`:this.basePath}},Wm=t=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(t),Hm=(t,e)=>{let r=ld(t);return r&&r.organizationId===e?r:null},ld=t=>{let e=t.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return(e==null?void 0:e.groups)?e.groups:null};var Wb=(t,e,r)=>new Ca(`${t}/rest/organizations/${e}/machinelearning/streaming/${r}`).href,zm=3,Hb=5e3,zb="text/event-stream",dd=1,Gm=class extends Error{},ys=class extends Error{constructor(e){super(e.message);this.payload=e}},pd=class{constructor(e){this.logger=e.logger}streamGeneratedAnswer(e,r){let{url:a,organizationId:n,streamId:o,accessToken:i}=e,{write:s,abort:c,close:u,resetAnswer:l}=r;if(!o){this.logger.error("No stream ID found");return}let d=0,f,p=()=>{S==null||S.abort(),l(),v()},m=()=>{f=Tf(p,f,Hb)},S=Ss(),v=()=>cd(Wb(a,n,o),{method:"GET",headers:{Authorization:`Bearer ${i}`,accept:"*/*"},signal:S==null?void 0:S.signal,async onopen(C){if(C.ok&&C.headers.get("content-type")===zb)return;throw C.status>=400&&C.status<500&&C.status!==429?new ys({message:"Error opening stream",code:C.status}):new Gm},onmessage:C=>{let F=JSON.parse(C.data);if(F.finishReason==="ERROR"){clearTimeout(f),S==null||S.abort(),c({message:F.errorMessage,code:F.statusCode});return}s(F),d=0,F.finishReason==="COMPLETED"?(clearTimeout(f),u()):m()},onerror:C=>{if(clearTimeout(f),C instanceof ys)throw S==null||S.abort(),c(C),C;if(++d>zm){this.logger.info("Maximum retry exceeded.");let F={message:"Failed to complete stream.",code:dd};throw S==null||S.abort(),c(F),new ys(F)}this.logger.info(`Retrying...(${d}/${zm})`),l()}});return v(),S}};var Cs=t=>t;function gr(t){let{url:e,accessToken:r,organizationId:a,authentication:n,...o}=t;return o}var hr=t=>{let{response:e}=t;return e.body?Gb(t):Yb(e)},Gb=t=>Jb(t)?Xb(t):Kb(t)?t.body:{message:"unknown",statusCode:0,type:"unknown"},Yb=t=>{let e=JSON.parse(JSON.stringify(t,Object.getOwnPropertyNames(t)));return{...e,message:`Client side error: ${e.message||""}`,statusCode:400,type:"ClientError"}};function Kb(t){return t.body.statusCode!==void 0}function Jb(t){return t.body.exception!==void 0}var Xb=t=>({message:t.body.exception.code,statusCode:t.response.status,type:t.body.exception.code});var sg=Ge(Km()),cg=Ge(ng());var A=new Error("Failed to load reducers."),gi=class extends Error{constructor(){super();this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},pn=class extends Error{constructor(e,r){super();this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=r!=null?r:0}};function og(t){let e=[];for(let r in t){let a=encodeURIComponent(r),n=encodeURIComponent(t[r]);e.push(`${a}=${n}`)}return e.join("&")}function ig(t){return typeof t!="object"||!t?!1:Object.values(t).every(RR)}function RR(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"}function ug(t){return t===429}var Xe=class{static async call(e){let r=AR(e),{logger:a}=e,n=await Xe.preprocessRequest(r,e);a.info(n,"Platform request");let{url:o,...i}=n,s=async()=>{let c=await(0,sg.default)(o,i);if(ug(c.status))throw c;return c};try{let c=await(0,cg.backOff)(s,{retry:u=>{let l=u&&ug(u.status);return l&&a.info("Platform retrying request"),l}});if(c.status===419)throw a.info("Platform renewing token"),new gi;if(c.status===404)throw new pn(o,c.status);return a.info({response:c,requestInfo:n},"Platform response"),c}catch(c){return c.message==="Failed to fetch"?new pn(o):c}}static async preprocessRequest(e,r){let{origin:a,preprocessRequest:n,logger:o,requestMetadata:i}=r,{signal:s,...c}=e,u=Tr(c);try{let l=await n(e,a,i);return{...e,...l}}catch(l){o.error(l,"Platform request preprocessing failed. Returning default request options.")}return u}};function lg(t,e){let r=!e||!e.environment||e.environment==="prod"?"":e.environment,a=!e||!e.region||e.region==="us"?"":`-${e.region}`;return`https://${t}${r}${a}.cloud.coveo.com`}function hi(t,e="prod"){let r=e==="prod"?"":e,a=`https://${t}.org${r}.coveo.com`,n=`https://${t}.analytics.org${r}.coveo.com`,o=`${a}/rest/search/v2`,i=`https://${t}.admin.org${r}.coveo.com`;return{platform:a,analytics:n,search:o,admin:i}}function vs(t){return(t==null?void 0:t.multiRegionSubDomain)?`https://${t.multiRegionSubDomain}.org.coveo.com`:lg("platform",t)}function vd(t){return lg("analytics",t)}function AR(t){let{url:e,method:r,requestParams:a,contentType:n,accessToken:o,signal:i}=t,s=t.method==="POST"||t.method==="PUT",c=PR(a,n);return{url:e,method:r,headers:{"Content-Type":n,Authorization:`Bearer ${o}`,...t.headers},...s&&{body:c},signal:i}}function PR(t,e){return e==="application/x-www-form-urlencoded"?ig(t)?og(t):"":JSON.stringify(t)}var va=class{constructor(){this.currentAbortController=null}async enqueue(e,r){var o;let a=this.currentAbortController,n=this.currentAbortController=Ss();a&&(r.warnOnAbort&&r.logger.warn("Cancelling current pending search query"),a.abort());try{return await e((o=n==null?void 0:n.signal)!=null?o:null)}finally{this.currentAbortController===n&&(this.currentAbortController=null)}}};function dg(t){return((t.headers.get("content-type")||"").split(";").find(a=>a.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var Bt=(t,e,r,a)=>{let n=new Ca(`${t.url}${a}`);return n.addParam("organizationId",t.organizationId),t.authentication&&n.addParam("authentication",t.authentication),{accessToken:t.accessToken,method:e,contentType:r,url:n.href,origin:"searchApiFetch"}};var pg=(t,e)=>{let r=new Ca(`${t.url}${e}`);return r.addParam("access_token",t.accessToken),r.addParam("organizationId",t.organizationId),r.addParam("uniqueId",t.uniqueId),t.q!==void 0&&r.addParam("q",t.q),t.enableNavigation!==void 0&&r.addParam("enableNavigation",`${t.enableNavigation}`),t.requestedOutputSize!==void 0&&r.addParam("requestedOutputSize",`${t.requestedOutputSize}`),t.visitorId!==void 0&&r.addParam("visitorId",`${t.visitorId}`),r.href},fg=async(t,e)=>{let r=await Xe.call({...Bt(t,"POST","application/x-www-form-urlencoded","/html"),requestParams:gr(t),requestMetadata:{method:"html"},...e});if(r instanceof Error)throw r;let a=dg(r),n=await r.arrayBuffer(),i=new TextDecoder(a).decode(n);return wR(i)?{success:i}:{error:hr({response:r,body:i})}};function wR(t){return typeof t=="string"}function ER(t){return{statusCode:t.statusCode,type:t.name,message:t.message}}function IR(t){return{statusCode:t.code,type:t.name,message:t.message,ignored:!0}}function Fs(t,e){if(e&&t.name==="AbortError")return{error:IR(t)};if(t instanceof pn)return{error:ER(t)};throw t}var Fd=class{constructor(e){this.options=e;this.apiCallsQueues={unknown:new va,mainSearch:new va,facetValues:new va,foldingCollection:new va,instantResults:new va}}async plan(e){let r=await Xe.call({...Bt(e,"POST","application/json","/plan"),requestParams:gr(e),requestMetadata:{method:"plan"},...this.options});if(r instanceof Error)return Fs(r);let a=await r.json();return qR(a)?{success:a}:{error:hr({response:r,body:a})}}async querySuggest(e){let r=await Xe.call({...Bt(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:gr(e),...this.options});if(r instanceof Error)return Fs(r);let a=await r.json(),n={response:r,body:a};return OR(a)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}:{error:hr(n)}}async search(e,r){var s;let a=(s=r==null?void 0:r.origin)!=null?s:"unknown",n=await this.apiCallsQueues[a].enqueue(c=>Xe.call({...Bt(e,"POST","application/json",""),requestParams:gr(e),requestMetadata:{method:"search",origin:r==null?void 0:r.origin},...this.options,signal:c!=null?c:void 0}),{logger:this.options.logger,warnOnAbort:!(r==null?void 0:r.disableAbortWarning)});if(n instanceof Error)return Fs(n,r==null?void 0:r.disableAbortWarning);let o=await n.json(),i={response:n,body:o};return bd(o)?(i.body=kR(o),{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}):{error:hr(i)}}async facetSearch(e){let r=await Xe.call({...Bt(e,"POST","application/json","/facet"),requestParams:gr(e),requestMetadata:{method:"facetSearch"},...this.options});if(r instanceof Error)throw r;let a=await r.json(),n={response:r,body:a};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){let r=await Xe.call({...Bt(e,"POST","application/json",""),requestParams:gr(e),requestMetadata:{method:"recommendations"},...this.options});if(r instanceof Error)throw r;let a=await r.json();return bd(a)?{success:a}:{error:hr({response:r,body:a})}}async html(e){return fg(e,{...this.options})}async productRecommendations(e){let r=await Xe.call({...Bt(e,"POST","application/json",""),requestParams:gr(e),requestMetadata:{method:"productRecommendations"},...this.options});if(r instanceof Error)throw r;let a=await r.json();return bd(a)?{success:a}:{error:hr({response:r,body:a})}}async fieldDescriptions(e){let r=await Xe.call({...Bt(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(r instanceof Error)throw r;let a=await r.json();return TR(a)?{success:a}:{error:hr({response:r,body:a})}}},bs=t=>t.success!==void 0,ye=t=>t.error!==void 0;function bd(t){return t.results!==void 0}function kR(t){let e=un();return ee(t.questionAnswer)?(t.questionAnswer=e,t):(t.questionAnswer={...e,...t.questionAnswer},t)}function OR(t){return t.completions!==void 0}function qR(t){return t.preprocessingOutput!==void 0}function TR(t){return t.fields!==void 0}var mg=t=>t,gg=t=>t,hg=t=>t;var P=new b({required:!0,emptyAllowed:!1}),pe=new b({required:!1,emptyAllowed:!1}),le=new b({required:!0,emptyAllowed:!0}),yr=({message:t,name:e,stack:r})=>({message:t,name:e,stack:r}),nt=(t,e)=>{if("required"in e)return{payload:new z({value:e}).validate({value:t}).value};let n=new E({options:{required:!0},values:e}).validate(t);if(n)throw new li(n);return{payload:t}},y=(t,e)=>{try{return nt(t,e)}catch(r){return{payload:t,error:yr(r)}}},Pe=(t,e,r,a)=>{let n=`Check the initialState of ${a}`;return Sg(t,e,r,n,"Controller initialization error")},de=(t,e,r,a)=>{let n=`Check the options of ${a}`;return Sg(t,e,r,n,"Controller initialization error")},Sg=(t,e,r,a,n)=>{try{return e.validate(r,a)}catch(o){throw t.logger.error(o,n),o}};var Rs=class{constructor(e){this.state=e()}getSearchUID(){return null}getOriginLevel1(){return this.state.searchHub||Nt()}},yg=({logger:t,getState:e,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:a,provider:n=new Rs(e)})=>{let o=e(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new Yl({enableAnalytics:u,token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Lt(t,a),beforeSendHooks:[Qt(t,r),(d,f)=>(t.info({...f,type:d,endpoint:s,token:i},"Analytics request"),f)]},n);return u||l.disable(),l};var As=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var fn=class extends mr{constructor(){super(...arguments);this.initialState=As()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var r;return((r=this.getState().productListing)==null?void 0:r.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},Cg=({logger:t,getState:e,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:a,provider:n=new fn(e)})=>{let o=e(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new ya({token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Lt(t,a),beforeSendHooks:[Qt(t,r),(d,f)=>(t.info({...f,type:d,endpoint:s,token:i},"Analytics request"),f)]},n);return u||l.disable(),l};var Ps=class extends mr{getSearchUID(){var r,a;let e=this.getState();return((r=e.search)==null?void 0:r.searchResponseId)||((a=e.search)==null?void 0:a.response.searchUid)||Me().response.searchUid}getPipeline(){var e;return this.state.pipeline||((e=this.state.search)==null?void 0:e.response.pipeline)||"default"}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getFacetState(){return ms(Je(this.state))}get queryText(){var e;return((e=this.state.query)==null?void 0:e.q)||Fe().q}get responseTime(){var e;return((e=this.state.search)==null?void 0:e.duration)||Me().duration}mapResultsToAnalyticsDocument(){var e;return(e=this.state.search)==null?void 0:e.response.results.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get numberOfResults(){var e;return((e=this.state.search)==null?void 0:e.response.results.length)||Me().response.results.length}},xg=({logger:t,getState:e,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:a,provider:n=new Ps(e)})=>{let o=e(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new Kl({enableAnalytics:u,token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Lt(t,a),beforeSendHooks:[Qt(t,r),(d,f)=>(t.info({...f,type:d,endpoint:s,token:i},"Analytics request"),f)]},n);return u||l.disable(),l};var mn=class extends mr{constructor(){super(...arguments);this.initialState=As()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var r;return((r=this.getState().productListing)==null?void 0:r.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},vg=({logger:t,getState:e,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:a,provider:n=new mn(e)})=>{let o=e(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new ya({token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:Lt(t,a),beforeSendHooks:[Qt(t,r),(d,f)=>(t.info({...f,type:d,endpoint:s,token:i},"Analytics request"),f)]},n);return u||l.disable(),l};function ws(t){let e=Fg(t),r=[t,...e].filter(n=>n.parentResult).map(n=>n.parentResult);return Of([t,...e,...r],n=>n.uniqueId)}function Fg(t){return t.childResults?t.childResults.flatMap(e=>[e,...Fg(e)]):[]}var Nr=()=>"";function gn(t,e){return{...new L(e).getBaseMetadata(),actionCause:t,type:t}}function DR(t){return Object.assign(t,{instantlyCallable:!0})}function VR(t,e){let r=o=>DR(J(t,o)),a=r(async(o,{getState:i,extra:s})=>{let{analyticsClientMiddleware:c,preprocessRequest:u,logger:l}=s;return await(await e({getState:i,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})).log({state:i(),extra:s})});return Object.assign(a,{prepare:async({getState:o,analyticsClientMiddleware:i,preprocessRequest:s,logger:c})=>{let{description:u,log:l}=await e({getState:o,analyticsClientMiddleware:i,preprocessRequest:s,logger:c});return{description:u,action:r(async(d,{getState:f,extra:p})=>await l({state:f(),extra:p}))}}}),a}var Si=(t,e,r)=>{function a(...n){let o=n.length===1?{...n[0],__legacy__getBuilder:e(n[0].__legacy__getBuilder),analyticsConfigurator:t,providerClass:r}:{prefix:n[0],__legacy__getBuilder:e(n[1]),__legacy__provider:n[2],analyticsConfigurator:t,providerClass:r};return LR(o)}return a},NR=t=>t.configuration.analytics.analyticsMode==="legacy",MR=t=>t.configuration.analytics.analyticsMode==="next",LR=({prefix:t,__legacy__getBuilder:e,__legacy__provider:r,analyticsPayloadBuilder:a,analyticsType:n,analyticsConfigurator:o,providerClass:i})=>(r!=null||(r=s=>new i(s)),VR(t,async({getState:s,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})=>{let d=[],f={log:async({state:C})=>{for(let F of d)await F(C)}},p=s(),m=o({getState:s,logger:l,analyticsClientMiddleware:c,preprocessRequest:u,provider:r(s)}),S=await e(m,s());f.description=S==null?void 0:S.description,d.push(async C=>{NR(C)&&await QR(S,r,C,l,m.coveoAnalyticsClient)});let v=Nm(p);return d.push(async C=>{if(MR(C)&&n&&a){let F=a(C);await HR(v,n,F)}}),f}));async function QR(t,e,r,a,n){e(()=>r);let o=await(t==null?void 0:t.log({searchUID:e(()=>r).getSearchUID()}));a.info({client:n,response:o},"Analytics response")}var bg=t=>(e,r)=>Promise.resolve({description:{actionCause:"caseAssist"},log:async a=>{t(e,r)}}),w=Si(Mm,t=>t,L),hV=Si(yg,bg,Rs),SV=Si(xg,bg,Ps),Rg=Si(Cg,t=>t,fn),Ag=Si(vg,t=>t,mn);var Le=(t,e)=>{var o;let r=i=>{var s,c;return i+((c=(s=e.pagination)==null?void 0:s.firstResult)!=null?c:0)},a=-1,n=(o=e.search)==null?void 0:o.results;return a=wg(t,n),a<0&&(a=WR(t,n)),a<0&&(a=0),BR(t,r(a),e)};function BR(t,e,r){let a=t.raw.collection;return{collectionName:typeof a=="string"?a:"default",documentAuthor:_R(t),documentPosition:e+1,documentTitle:t.title,documentUri:t.uri,documentUriHash:t.raw.urihash,documentUrl:t.clickUri,rankingModifier:t.rankingModifier||"",sourceName:$R(t),queryPipeline:r.pipeline||Nr()}}var _e=t=>(t.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",t),{contentIDKey:"permanentid",contentIDValue:t.raw.permanentid||""}),Pg={urihash:new b,sourcetype:new b,permanentid:new b},hn={uniqueId:P,raw:new E({values:Pg}),title:P,uri:P,clickUri:P,rankingModifier:new b({required:!1,emptyAllowed:!0})};function jR(t){return Object.assign({},...Object.keys(Pg).map(e=>({[e]:t[e]})))}function UR(t){return Object.assign({},...Object.keys(hn).map(e=>({[e]:t[e]})),{raw:jR(t.raw)})}function _R(t){let e=t.raw.author;return ee(e)?"unknown":Array.isArray(e)?e.join(";"):`${e}`}function $R(t){let e=t.raw.source;return ee(e)?"unknown":e}var ot=t=>new z(hn).validate(UR(t));function WR(t,e){for(let[r,a]of e.entries()){let n=ws(a);if(wg(t,n)!==-1)return r}return-1}function wg(t,e=[]){return e.findIndex(({uniqueId:r})=>r===t.uniqueId)}async function HR(t,e,r){await t(e,r)}var Rd=t=>y(t,{evt:P,type:pe}),Eg=t=>w("analytics/generic/search",e=>{Rd(t);let{evt:r,meta:a}=t;return e.makeSearchEvent(r,a)}),Ig=t=>w("analytics/generic/click",(e,r)=>(ot(t.result),Rd(t),e.makeClickEvent(t.evt,Le(t.result,r),_e(t.result),t.meta))),kg=t=>w("analytics/generic/custom",e=>(Rd(t),e.makeCustomEventWithType(t.evt,t.type,t.meta))),Es=()=>w("analytics/interface/load",t=>t.makeInterfaceLoad()),Mr=()=>w("analytics/interface/change",(t,e)=>t.makeInterfaceChange({interfaceChangeTo:e.configuration.analytics.originLevel2})),Is=()=>w("analytics/interface/searchFromLink",t=>t.makeSearchFromLink()),ks=t=>w("analytics/interface/omniboxFromLink",e=>e.makeOmniboxFromLink(t));var T=(k=>(k.interfaceLoad="interfaceLoad",k.interfaceChange="interfaceChange",k.didyoumeanAutomatic="didyoumeanAutomatic",k.didyoumeanClick="didyoumeanClick",k.resultsSort="resultsSort",k.searchboxSubmit="searchboxSubmit",k.searchboxClear="searchboxClear",k.searchboxAsYouType="searchboxAsYouType",k.breadcrumbFacet="breadcrumbFacet",k.breadcrumbResetAll="breadcrumbResetAll",k.documentQuickview="documentQuickview",k.documentOpen="documentOpen",k.omniboxAnalytics="omniboxAnalytics",k.omniboxFromLink="omniboxFromLink",k.searchFromLink="searchFromLink",k.triggerNotify="notify",k.triggerExecute="execute",k.triggerQuery="query",k.undoTriggerQuery="undoQuery",k.triggerRedirect="redirect",k.pagerResize="pagerResize",k.pagerNumber="pagerNumber",k.pagerNext="pagerNext",k.pagerPrevious="pagerPrevious",k.pagerScrolling="pagerScrolling",k.staticFilterClearAll="staticFilterClearAll",k.staticFilterSelect="staticFilterSelect",k.staticFilterDeselect="staticFilterDeselect",k.facetClearAll="facetClearAll",k.facetSearch="facetSearch",k.facetSelect="facetSelect",k.facetSelectAll="facetSelectAll",k.facetDeselect="facetDeselect",k.facetExclude="facetExclude",k.facetUnexclude="facetUnexclude",k.facetUpdateSort="facetUpdateSort",k.facetShowMore="showMoreFacetResults",k.facetShowLess="showLessFacetResults",k.queryError="query",k.queryErrorBack="errorBack",k.queryErrorClear="errorClearQuery",k.queryErrorRetry="errorRetry",k.recommendation="recommendation",k.recommendationInterfaceLoad="recommendationInterfaceLoad",k.recommendationOpen="recommendationOpen",k.likeSmartSnippet="likeSmartSnippet",k.dislikeSmartSnippet="dislikeSmartSnippet",k.expandSmartSnippet="expandSmartSnippet",k.collapseSmartSnippet="collapseSmartSnippet",k.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",k.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",k.sendSmartSnippetReason="sendSmartSnippetReason",k.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",k.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",k.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",k.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",k.openSmartSnippetSource="openSmartSnippetSource",k.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",k.openSmartSnippetInlineLink="openSmartSnippetInlineLink",k.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",k.recentQueryClick="recentQueriesClick",k.clearRecentQueries="clearRecentQueries",k.recentResultClick="recentResultClick",k.clearRecentResults="clearRecentResults",k.noResultsBack="noResultsBack",k.showMoreFoldedResults="showMoreFoldedResults",k.showLessFoldedResults="showLessFoldedResults",k.copyToClipboard="copyToClipboard",k.caseSendEmail="Case.SendEmail",k.feedItemTextPost="FeedItem.TextPost",k.caseAttach="caseAttach",k.caseDetach="caseDetach",k.retryGeneratedAnswer="retryGeneratedAnswer",k.likeGeneratedAnswer="likeGeneratedAnswer",k.dislikeGeneratedAnswer="dislikeGeneratedAnswer",k.openGeneratedAnswerSource="openGeneratedAnswerSource",k.generatedAnswerStreamEnd="generatedAnswerStreamEnd",k.historyForward="historyForward",k.historyBackward="historyBackward",k))(T||{});var Ad=()=>pe,Og=()=>P,jt=h("configuration/updateBasicConfiguration",t=>y(t,{accessToken:pe,organizationId:pe,platformUrl:pe})),it=h("configuration/updateSearchConfiguration",t=>y(t,{apiBaseUrl:pe,pipeline:new b({required:!1,emptyAllowed:!0}),searchHub:pe,timezone:pe,locale:pe,authenticationProviders:new H({required:!1,each:P})})),Lr=h("configuration/updateAnalyticsConfiguration",t=>(ns()&&(t.enabled=!1),y(t,{enabled:new $({default:!0}),originContext:Ad(),originLevel2:Ad(),originLevel3:Ad(),apiBaseUrl:pe,nextApiBaseUrl:pe,runtimeEnvironment:new ue,anonymous:new $({default:!1}),deviceId:pe,userDisplayName:pe,documentLocation:pe,trackingId:pe,analyticsMode:new b({constrainTo:["legacy","next"],required:!1,default:"legacy"})}))),Sn=h("configuration/analytics/disable"),yn=h("configuration/analytics/enable"),Os=h("configuration/analytics/originlevel2",t=>y(t,{originLevel2:Og()})),qs=h("configuration/analytics/originlevel3",t=>y(t,{originLevel3:Og()}));var Ts={q:new b,enableQuerySyntax:new $,aq:new b,cq:new b,firstResult:new I({min:0}),numberOfResults:new I({min:0}),sortCriteria:new b,f:new E,fExcluded:new E,cf:new E,nf:new E,df:new E,debug:new $,sf:new E,tab:new b,af:new E};var se=h("searchParameters/restore",t=>y(t,Ts));var Qr=h("debug/enable"),Cn=h("debug/disable");var Br=()=>!1;var jr=O(Br(),t=>{t.addCase(Qr,()=>!0).addCase(Cn,()=>!1).addCase(se,(e,r)=>{var a;return(a=r.payload.debug)!=null?a:e})});var Pd=h("history/undo"),wd=h("history/redo"),Ft=h("history/snapshot"),yi=J("history/back",async(t,{dispatch:e})=>{e(Pd()),await e(ie())}),Ds=J("history/forward",async(t,{dispatch:e})=>{e(wd()),await e(ie())}),ie=J("history/change",async(t,{getState:e})=>e().history.present);var xn=h("pipeline/set",t=>y(t,new b({required:!0,emptyAllowed:!0})));var vn=O(Nr(),t=>{t.addCase(xn,(e,r)=>r.payload).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.pipeline)!=null?n:e}).addCase(it,(e,r)=>r.payload.pipeline||e)});var Fn=h("searchHub/set",t=>y(t,new b({required:!0,emptyAllowed:!0})));var bn=O(Nt(),t=>{t.addCase(Fn,(e,r)=>r.payload).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.searchHub)!=null?n:e}).addCase(it,(e,r)=>r.payload.searchHub||e)});var Ce=h("breadcrumb/deselectAll"),Ur=h("breadcrumb/deselectAllNonBreadcrumbs");var st=h("facet/updateFacetAutoSelection",t=>y(t,{allow:new $({required:!0})}));var Ed={id:P},zR={...Ed,q:le},Rn=h("instantResults/register",t=>y(t,Ed)),Ut=h("instantResults/updateQuery",t=>y(t,zR)),An=h("instantResults/clearExpired",t=>y(t,Ed));var Vs=new I({required:!0,min:0}),Pn=h("pagination/registerNumberOfResults",t=>y(t,Vs)),wn=h("pagination/updateNumberOfResults",t=>y(t,Vs)),En=h("pagination/registerPage",t=>y(t,Vs)),ct=h("pagination/updatePage",t=>y(t,Vs)),In=h("pagination/nextPage"),kn=h("pagination/previousPage");var Qe=h("query/updateQuery",t=>y(t,{q:new b,enableQuerySyntax:new $}));var On=async(t,e)=>({analytics:{clientId:await at(t),clientTimestamp:new Date().toISOString(),documentReferrer:t.originLevel3,originContext:t.originContext,...e&&{actionCause:e.actionCause,customData:e.customData},...t.userDisplayName&&{userDisplayName:t.userDisplayName},...t.documentLocation&&{documentLocation:t.documentLocation},...t.deviceId&&{deviceId:t.deviceId},...sd()&&{pageId:sd()},...t.analyticsMode&&t.trackingId&&{trackingId:t.trackingId},capture:t.analyticsMode==="next"}});var _r=async(t,e)=>{var r,a,n,o;return{accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,locale:t.configuration.search.locale,debug:t.debug,tab:t.configuration.analytics.originLevel2,referrer:t.configuration.analytics.originLevel3,timezone:t.configuration.search.timezone,...t.configuration.analytics.enabled&&{visitorId:await at(t.configuration.analytics),actionsHistory:Mt.getHistory()},...((r=t.advancedSearchQueries)==null?void 0:r.aq)&&{aq:t.advancedSearchQueries.aq},...((a=t.advancedSearchQueries)==null?void 0:a.cq)&&{cq:t.advancedSearchQueries.cq},...((n=t.advancedSearchQueries)==null?void 0:n.lq)&&{lq:t.advancedSearchQueries.lq},...((o=t.advancedSearchQueries)==null?void 0:o.dq)&&{dq:t.advancedSearchQueries.dq},...t.context&&{context:t.context.contextValues},...t.fields&&!t.fields.fetchAllFields&&{fieldsToInclude:t.fields.fieldsToInclude},...t.dictionaryFieldContext&&{dictionaryFieldContext:t.dictionaryFieldContext.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.query&&{q:t.query.q,enableQuerySyntax:t.query.enableQuerySyntax},...t.searchHub&&{searchHub:t.searchHub},...t.sortCriteria&&{sortCriteria:t.sortCriteria},...t.configuration.analytics.enabled&&await On(t.configuration.analytics,e),...t.excerptLength&&!ee(t.excerptLength.length)&&{excerptLength:t.excerptLength.length},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}}};var Id=class extends L{constructor(e){super(e);this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let r in e)for(let a in e[r].cache)if(e[r].cache[a].isActive)return e[r].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let r in e)for(let a in e[r].cache)if(e[r].cache[a].isActive)return e[r].cache[a];return null}get results(){var e;return(e=this.activeInstantResultCache)==null?void 0:e.results}get queryText(){var e;return(e=this.activeInstantResultQuery)!=null?e:Fe().q}get responseTime(){var e,r;return(r=(e=this.activeInstantResultCache)==null?void 0:e.duration)!=null?r:Me().duration}get numberOfResults(){var e,r;return(r=(e=this.activeInstantResultCache)==null?void 0:e.totalCountFiltered)!=null?r:Me().response.totalCountFiltered}getSearchUID(){var r;return((r=this.activeInstantResultCache)==null?void 0:r.searchUid)||super.getSearchUID()}};var qg=()=>w("analytics/instantResult/searchboxAsYouType",t=>t.makeSearchboxAsYouType(),t=>new Id(t));var bt=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});var kd=()=>w("search/logFetchMoreResults",t=>t.makeFetchMoreResults()),ut=t=>w("search/queryError",(e,r)=>{var a,n,o,i;return e.makeQueryError({query:((a=r.query)==null?void 0:a.q)||Fe().q,aq:((n=r.advancedSearchQueries)==null?void 0:n.aq)||bt().aq,cq:((o=r.advancedSearchQueries)==null?void 0:o.cq)||bt().cq,dq:((i=r.advancedSearchQueries)==null?void 0:i.dq)||bt().dq,errorType:t.type,errorMessage:t.message})});var vi=Ge(Ns()),Mg=Ge(Tg());var Ms=Ge(Ns()),Vg=Ge(Dg());Ms.default.extend(Vg.default);var Ci="YYYY/MM/DD@HH:mm:ss",GR="1401-01-01";function Fa(t,e){let r=(0,Ms.default)(t,e);return!r.isValid()&&!e?(0,Ms.default)(t,Ci):r}function xi(t){return t.format(Ci)}function Ng(t){return xi(Fa(t))===t}function Ls(t,e){let r=Fa(t,e);if(!r.isValid()){let a=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",n=` with the format "${e}""`;throw new Error(`Could not parse the provided date "${t}"${e?n:a}`)}Md(r)}function Md(t){if(t.isBefore(GR))throw new Error(`Date is before year 1401, which is unsupported by the API: ${t}`)}vi.default.extend(Mg.default);var Lg=["past","now","next"],Qg=["minute","hour","day","week","month","quarter","year"],YR=t=>{let e=t==="now";return{amount:new I({required:!e,min:1}),unit:new b({required:!e,constrainTo:Qg}),period:new b({required:!0,constrainTo:Lg})}};function ba(t){if(typeof t=="string"&&!_t(t))throw new Error(`The value "${t}" is not respecting the relative date format "period-amount-unit"`);let e=typeof t=="string"?Ld(t):t;new z(YR(e.period)).validate(e);let r=jg(e),a=JSON.stringify(e);if(!r.isValid())throw new Error(`Date is invalid: ${a}`);Md(r)}function Bg(t){let{period:e,amount:r,unit:a}=t;switch(e){case"past":case"next":return`${e}-${r}-${a}`;case"now":return e}}function jg(t){let{period:e,amount:r,unit:a}=t;switch(e){case"past":return(0,vi.default)().subtract(r,a);case"next":return(0,vi.default)().add(r,a);case"now":return(0,vi.default)()}}function Fi(t){return xi(jg(Ld(t)))}function Ug(t){return t.toLocaleLowerCase().split("-")}function _t(t){let[e,r,a]=Ug(t);if(e==="now")return!0;if(!Lg.includes(e)||!Qg.includes(a))return!1;let n=parseInt(r);return!(isNaN(n)||n<=0)}function _g(t){return!!t&&typeof t=="object"&&"period"in t}function Ld(t){let[e,r,a]=Ug(t);return e==="now"?{period:"now"}:{period:e,amount:r?parseInt(r):void 0,unit:a||void 0}}function KR(t){return ba(t),Ld(t)}function $g(t){return t.type==="dateRange"}function Wg(t){return`start${t}`}function Hg(t){return`end${t}`}var JR=()=>({dateFacetValueMap:{}});function XR(t,e,r){let a=t.start,n=t.end;return _t(a)&&(a=Fi(a),r.dateFacetValueMap[e][Wg(a)]=t.start),_t(n)&&(n=Fi(n),r.dateFacetValueMap[e][Hg(n)]=t.end),{...t,start:a,end:n}}function ZR(t,e){if($g(t)){let{facetId:r,currentValues:a}=t;return e.dateFacetValueMap[r]={},{...t,currentValues:a.map(n=>XR(n,r,e))}}return t}function qn(t){var a;let e=JR();return{request:{...t,facets:(a=t.facets)==null?void 0:a.map(n=>ZR(n,e))},mappings:e}}function eA(t,e,r){return{...t,start:r.dateFacetValueMap[e][Wg(t.start)]||t.start,end:r.dateFacetValueMap[e][Hg(t.end)]||t.end}}function tA(t,e){return t.facetId in e.dateFacetValueMap}function rA(t,e){return tA(t,e)?{...t,values:t.values.map(r=>eA(r,t.facetId,e))}:t}function Qs(t,e){var r;return"success"in t?{success:{...t.success,facets:(r=t.success.facets)==null?void 0:r.map(n=>rA(n,e))}}:t}function Tn(t,e){let r={};t.forEach(o=>r[o.facetId]=o);let a=[];e.forEach(o=>{o in r&&(a.push(r[o]),delete r[o])});let n=Object.values(r);return[...a,...n]}function Cr(t){return Object.values(t).map(e=>e.request)}var Ra=1,bi=5e3;var we=async(t,e)=>{var s,c;let r=uA(t),a=aA(t),n=nA(t),o=await _r(t,e),i=()=>t.pagination?t.pagination.firstResult+t.pagination.numberOfResults>bi?bi-t.pagination.firstResult:t.pagination.numberOfResults:void 0;return qn({...o,...t.didYouMean&&{enableDidYouMean:t.didYouMean.enableDidYouMean},...r&&{cq:r},...a.length&&{facets:a},...t.pagination&&{numberOfResults:i(),firstResult:t.pagination.firstResult},...t.facetOptions&&{facetOptions:{freezeFacetOrder:t.facetOptions.freezeFacetOrder}},...((s=t.folding)==null?void 0:s.enabled)&&{filterField:t.folding.fields.collection,childField:t.folding.fields.parent,parentField:t.folding.fields.child,filterFieldRange:t.folding.filterFieldRange},...t.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:t.automaticFacetSet.desiredCount,numberOfValues:t.automaticFacetSet.numberOfValues,currentFacets:n}},...((c=t.generatedAnswer)==null?void 0:c.responseFormat)&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:t.generatedAnswer.responseFormat}}}})};function aA(t){var e;return Tn(iA(t),(e=t.facetOrder)!=null?e:[])}function nA(t){var r;let e=(r=t.automaticFacetSet)==null?void 0:r.set;return e?Object.values(e).map(a=>a.response).map(oA).filter(a=>a.currentValues.length>0):void 0}function oA(t){let{field:e,label:r,values:a}=t,n=a.filter(o=>o.state==="selected");return{field:e,label:r,currentValues:n}}function iA(t){return sA(t).filter(({facetId:e})=>{var r,a,n;return(n=(a=(r=t.facetOptions)==null?void 0:r.facets[e])==null?void 0:a.enabled)!=null?n:!0})}function sA(t){var e,r,a,n;return[...cA((e=t.facetSet)!=null?e:{}),...zg((r=t.numericFacetSet)!=null?r:{}),...zg((a=t.dateFacetSet)!=null?a:{}),...Cr((n=t.categoryFacetSet)!=null?n:{})]}function cA(t){return Cr(t).map(e=>e.sortCriteria==="alphanumericDescending"?{...e,sortCriteria:{type:"alphanumeric",order:"descending"}}:e)}function zg(t){return Cr(t).map(e=>{let a=e.currentValues.some(({state:n})=>n!=="idle");return e.generateAutomaticRanges&&!a?{...e,currentValues:[]}:e})}function uA(t){var o;let e=((o=t.advancedSearchQueries)==null?void 0:o.cq.trim())||"",r=Object.values(t.tabSet||{}).find(i=>i.isActive),a=(r==null?void 0:r.expression.trim())||"",n=lA(t);return[e,a,...n].filter(i=>!!i).join(" AND ")}function lA(t){return Object.values(t.staticFilterSet||{}).map(r=>{let a=r.values.filter(o=>o.state==="selected"&&!!o.expression.trim()),n=a.map(o=>o.expression).join(" OR ");return a.length>1?`(${n})`:n})}var Dn=h("didYouMean/enable"),Bs=h("didYouMean/disable"),Vn=h("didYouMean/automaticCorrections/disable"),js=h("didYouMean/automaticCorrections/enable"),lt=h("didYouMean/correction",t=>y(t,P));var Us=()=>w("analytics/didyoumean/click",t=>t.makeDidYouMeanClick()),Gg=()=>w("analytics/didyoumean/automatic",t=>t.makeDidYouMeanAutomatic());function _s(){return{contextValues:{}}}function $s(){return{contextValues:{}}}function Nn(){return{enabled:!0}}function Ws(){return{freezeFacetOrder:!1,facets:{}}}function Hs(){return[]}function zs(){return{}}function Gs(t){return t?t.expiresAt&&Date.now()>=t.expiresAt:!1}function dt(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function Ys(){return{}}function Ks(){return{}}function Js(){return{}}function Yg(){return xr({})}function xr(t){var e,r,a;return{context:t.context||_s(),dictionaryFieldContext:t.dictionaryFieldContext||$s(),facetSet:t.facetSet||sn(),numericFacetSet:t.numericFacetSet||on(),dateFacetSet:t.dateFacetSet||nn(),categoryFacetSet:t.categoryFacetSet||an(),automaticFacetSet:(e=t.automaticFacetSet)!=null?e:rn(),pagination:t.pagination||dt(),query:t.query||Fe(),tabSet:t.tabSet||Js(),advancedSearchQueries:t.advancedSearchQueries||bt(),staticFilterSet:t.staticFilterSet||Ks(),querySet:t.querySet||Ys(),instantResults:t.instantResults||zs(),sortCriteria:t.sortCriteria||rt(),pipeline:t.pipeline||Nr(),searchHub:t.searchHub||Nt(),facetOptions:t.facetOptions||Ws(),facetOrder:(r=t.facetOrder)!=null?r:Hs(),debug:(a=t.debug)!=null?a:Br()}}var dA=new E({values:{undoneQuery:le},options:{required:!0}}),Xs=()=>w("analytics/trigger/query",(t,e)=>{var r;return((r=e.triggers)==null?void 0:r.queryModification.newQuery)?t.makeTriggerQuery():null}),Zs=t=>w("analytics/trigger/query/undo",e=>(y(t,dA),e.makeUndoTriggerQuery(t))),ec=()=>w("analytics/trigger/notify",(t,e)=>{var r;return((r=e.triggers)==null?void 0:r.notifications.length)?t.makeTriggerNotify({notifications:e.triggers.notifications}):null}),tc=()=>w("analytics/trigger/redirect",(t,e)=>{var r;return((r=e.triggers)==null?void 0:r.redirectTo)?t.makeTriggerRedirect({redirectedTo:e.triggers.redirectTo}):null}),rc=()=>w("analytics/trigger/execute",(t,e)=>{var r;return((r=e.triggers)==null?void 0:r.executions.length)?t.makeTriggerExecute({executions:e.triggers.executions}):null});var $r=h("trigger/query/ignore",t=>y(t,new b({emptyAllowed:!0,required:!0}))),Mn=h("trigger/query/modification",t=>y(t,new E({values:{originalQuery:pe,modification:pe}})));var Aa=class{constructor(e,r=a=>{this.dispatch(Qe({q:a}))}){this.config=e;this.onUpdateQueryForCorrection=r}async fetchFromAPI({mappings:e,request:r},a){var c;let n=new Date().getTime(),o=Qs(await this.extra.apiClient.search(r,a),e),i=new Date().getTime()-n,s=((c=this.getState().query)==null?void 0:c.q)||"";return{response:o,duration:i,queryExecuted:s,requestExecuted:r}}async process(e){var r,a,n;return(n=(a=(r=this.processQueryErrorOrContinue(e))!=null?r:await this.processQueryCorrectionsOrContinue(e))!=null?a:await this.processQueryTriggersOrContinue(e))!=null?n:this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return ye(e.response)?(this.dispatch(ut(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let r=this.getState(),a=this.getSuccessResponse(e);if(!a||!r.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:o}=r.didYouMean,{results:i,queryCorrections:s}=a;if(!(i.length===0&&s.length!==0&&n&&o))return null;let u=this.getCurrentQuery(),{correctedQuery:l}=a.queryCorrections[0],d=await this.automaticallyRetryQueryWithCorrection(l);return ye(d.response)?(this.dispatch(ut(d.response.error)),this.rejectWithValue(d.response.error)):(this.analyticsAction&&this.analyticsAction()(this.dispatch,()=>this.getStateAfterResponse(e.queryExecuted,e.duration,r,a),this.extra),this.dispatch(Ft(xr(this.getState()))),{...d,response:{...d.response.success,queryCorrections:a.queryCorrections},automaticallyCorrected:!0,originalQuery:u,analyticsAction:Gg()})}async processQueryTriggersOrContinue(e){var s,c;let r=this.getSuccessResponse(e);if(!r)return null;let a=((s=r.triggers.find(u=>u.type==="query"))==null?void 0:s.content)||"";if(!a)return null;if(((c=this.getState().triggers)==null?void 0:c.queryModification.queryToIgnore)===a)return this.dispatch($r("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let o=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(a);return ye(i.response)?(this.dispatch(ut(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Ft(xr(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:o,analyticsAction:Xs()})}processSuccessResponse(e){return this.dispatch(Ft(xr(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return bs(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let r=await this.fetchFromAPI(await we(this.getState()),{origin:"mainSearch"});return this.dispatch(lt(e)),r}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Mn({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await we(this.getState()),{origin:"mainSearch"})}getStateAfterResponse(e,r,a,n){var o,i;return{...a,query:{q:e,enableQuerySyntax:(i=(o=a.query)==null?void 0:o.enableQuerySyntax)!=null?i:Fe().enableQuerySyntax},search:{...Me(),duration:r,response:n,results:n.results}}}getCurrentQuery(){var r;let e=this.getState();return((r=e.query)==null?void 0:r.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};var KM=J("search/prepareForSearchWithQuery",(t,e)=>{let{dispatch:r}=e;y(t,{q:new b,enableQuerySyntax:new $,clearFilters:new $}),t.clearFilters&&(r(Ce()),r(Ur())),r(st({allow:!0})),r(Qe({q:t.q,enableQuerySyntax:t.enableQuerySyntax})),r(ct(1))}),Ln=J("search/executeSearch",async(t,e)=>{let r=e.getState();return await nc(r,e,t)}),Qn=J("search/fetchPage",async(t,e)=>{let r=e.getState();return await Bd(r,e,t)}),Bn=J("search/fetchMoreResults",async(t,e)=>{let r=e.getState();return await jd(e,r)}),ac=J("search/fetchFacetValues",async(t,e)=>{let r=e.getState();return await gA(e,t,r)}),Kg=J("search/fetchInstantResults",async(t,e)=>Qd(t,e)),pA=async(t,e)=>{var a,n,o,i;let r=await we(t,e);return r.request={...r.request,firstResult:((n=(a=t.pagination)==null?void 0:a.firstResult)!=null?n:0)+((i=(o=t.search)==null?void 0:o.results.length)!=null?i:0)},r},fA=async(t,e,r)=>{let a=await _r(t);return qn({...a,...t.didYouMean&&{enableDidYouMean:t.didYouMean.enableDidYouMean},numberOfResults:r,q:e})},mA=async(t,e)=>{let r=await we(t,e);return r.request.numberOfResults=0,r},Jg=t=>{var e;t.configuration.analytics.enabled&&Mt.addElement({name:"Query",...((e=t.query)==null?void 0:e.q)&&{value:t.query.q},time:JSON.stringify(new Date)})};async function Qd(t,e){y(t,{id:P,q:P,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I});let{q:r,maxResultsPerQuery:a}=t,n=e.getState(),o=new Aa({...e,analyticsAction:qg()},u=>{e.dispatch(Ut({q:u,id:t.id}))}),i=await fA(n,r,a),s=await o.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),c=await o.process(s);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,analyticsAction:c.analyticsAction,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}async function Bd(t,e,r){Jg(t);let{analyticsClientMiddleware:a,preprocessRequest:n,logger:o}=e.extra,{description:i}=await r.prepare({getState:()=>e.getState(),analyticsClientMiddleware:a,preprocessRequest:n,logger:o}),s=new Aa({...e,analyticsAction:r}),c=await we(t,i),u=await s.fetchFromAPI(c,{origin:"mainSearch"});return await s.process(u)}async function jd(t,e){let{analyticsClientMiddleware:r,preprocessRequest:a,logger:n}=t.extra,{description:o}=await kd().prepare({getState:()=>t.getState(),analyticsClientMiddleware:r,preprocessRequest:a,logger:n}),i=new Aa({...t,analyticsAction:kd()}),s=await pA(e,o),c=await i.fetchFromAPI(s,{origin:"mainSearch"});return await i.process(c)}async function gA(t,e,r){let{analyticsClientMiddleware:a,preprocessRequest:n,logger:o}=t.extra,{description:i}=await e.prepare({getState:()=>t.getState(),analyticsClientMiddleware:a,preprocessRequest:n,logger:o}),s=new Aa({...t,analyticsAction:e}),c=await mA(r,i),u=await s.fetchFromAPI(c,{origin:"facetValues"});return await s.process(u)}async function nc(t,e,r){Jg(t);let{analyticsClientMiddleware:a,preprocessRequest:n,logger:o}=e.extra,{description:i}=await r.prepare({getState:()=>e.getState(),analyticsClientMiddleware:a,preprocessRequest:n,logger:o}),s=await we(t,i),c=new Aa({...e,analyticsAction:r}),u=await c.fetchFromAPI(s,{origin:"mainSearch"});return await c.process(u)}var Pa=class{constructor(e,r=a=>{this.dispatch(Qe({q:a}))}){this.config=e;this.onUpdateQueryForCorrection=r}async fetchFromAPI({mappings:e,request:r},a){var c;let n=new Date().getTime(),o=Qs(await this.extra.apiClient.search(r,a),e),i=new Date().getTime()-n,s=((c=this.getState().query)==null?void 0:c.q)||"";return{response:o,duration:i,queryExecuted:s,requestExecuted:r}}async process(e){var r,a,n;return(n=(a=(r=this.processQueryErrorOrContinue(e))!=null?r:await this.processQueryCorrectionsOrContinue(e))!=null?a:await this.processQueryTriggersOrContinue(e))!=null?n:this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return ye(e.response)?(this.dispatch(ut(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let r=this.getState(),a=this.getSuccessResponse(e);if(!a||!r.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:o}=r.didYouMean,{results:i,queryCorrections:s}=a;if(!(i.length===0&&s.length!==0&&n&&o))return null;let u=this.getCurrentQuery(),{correctedQuery:l}=a.queryCorrections[0],d=await this.automaticallyRetryQueryWithCorrection(l);return ye(d.response)?(this.dispatch(ut(d.response.error)),this.rejectWithValue(d.response.error)):(this.dispatch(Ft(xr(this.getState()))),{...d,response:{...d.response.success,queryCorrections:a.queryCorrections},automaticallyCorrected:!0,originalQuery:u,analyticsAction:gn(T.didyoumeanAutomatic,this.getState)})}async processQueryTriggersOrContinue(e){var s,c;let r=this.getSuccessResponse(e);if(!r)return null;let a=((s=r.triggers.find(u=>u.type==="query"))==null?void 0:s.content)||"";if(!a)return null;if(((c=this.getState().triggers)==null?void 0:c.queryModification.queryToIgnore)===a)return this.dispatch($r("")),null;let o=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(a);return ye(i.response)?(this.dispatch(ut(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(Ft(xr(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:o,analyticsAction:gn(T.triggerQuery,this.getState)})}processSuccessResponse(e){return this.dispatch(Ft(xr(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return bs(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let r=await this.fetchFromAPI(await we(this.getState()),{origin:"mainSearch"});return this.dispatch(lt(e)),r}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Mn({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await we(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){var r;let e=this.getState();return((r=e.query)==null?void 0:r.q)!==void 0?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};var oc=J("search/prepareForSearchWithQuery",(t,e)=>{let{dispatch:r}=e;y(t,{q:new b,enableQuerySyntax:new $,clearFilters:new $}),t.clearFilters&&(r(Ce()),r(Ur())),r(st({allow:!0})),r(Qe({q:t.q,enableQuerySyntax:t.enableQuerySyntax})),r(ct(1))}),R=J("search/executeSearch",async(t,e)=>{let r=e.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!t.next)return nc(r,e,t.legacy);Xg(r);let a=Zg(t.next,r),n=await we(r,a),o=new Pa({...e,analyticsAction:a}),i=await o.fetchFromAPI(n,{origin:"mainSearch"});return await o.process(i)}),$t=J("search/fetchPage",async(t,e)=>{let r=e.getState();if(Xg(r),r.configuration.analytics.analyticsMode==="legacy"||!t.next)return Bd(r,e,t.legacy);let a=new Pa({...e,analyticsAction:t.next}),n=await we(r,t.next),o=await a.fetchFromAPI(n,{origin:"mainSearch"});return await a.process(o)}),Wr=J("search/fetchMoreResults",async(t,e)=>{let r=e.getState();if(r.configuration.analytics.analyticsMode==="legacy")return jd(e,r);let a=gn(T.pagerScrolling,e.getState),n=new Pa({...e,analyticsAction:a}),o=await hA(r,a),i=await n.fetchFromAPI(o,{origin:"mainSearch"});return await n.process(i)}),Wt=J("search/fetchFacetValues",async(t,e)=>{let r=e.getState();if(r.configuration.analytics.analyticsMode==="legacy"||!t.next)return nc(r,e,t.legacy);let a=Zg(t.next,r),n=new Pa({...e,analyticsAction:a}),o=await yA(r,a),i=await n.fetchFromAPI(o,{origin:"facetValues"});return await n.process(i)}),jn=J("search/fetchInstantResults",async(t,e)=>{let r=e.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Qd(t,e);y(t,{id:P,q:P,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I});let{q:a,maxResultsPerQuery:n}=t,o=gn(T.searchboxAsYouType,e.getState),i=new Pa({...e,analyticsAction:o},l=>{e.dispatch(Ut({q:l,id:t.id}))}),s=await SA(r,a,n),c=await i.fetchFromAPI(s,{origin:"instantResults",disableAbortWarning:!0}),u=await i.process(c);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}),hA=async(t,e)=>{var a,n,o,i;let r=await we(t,e);return r.request={...r.request,firstResult:((n=(a=t.pagination)==null?void 0:a.firstResult)!=null?n:0)+((i=(o=t.search)==null?void 0:o.results.length)!=null?i:0)},r},SA=async(t,e,r)=>{let a=await _r(t);return qn({...a,...t.didYouMean&&{enableDidYouMean:t.didYouMean.enableDidYouMean},numberOfResults:r,q:e})},yA=async(t,e)=>{let r=await we(t,e);return r.request.numberOfResults=0,r},Xg=t=>{var e;t.configuration.analytics.enabled&&Mt.addElement({name:"Query",...((e=t.query)==null?void 0:e.q)&&{value:t.query.q},time:JSON.stringify(new Date)})},Zg=(t,e)=>({customData:t.getEventExtraPayload(e),actionCause:t.actionCause,type:t.actionCause});var vr=(t,e)=>{let r=t;return ee(r[e])?ee(t.raw[e])?null:t.raw[e]:r[e]},eh=t=>e=>t.every(r=>!ee(vr(e,r))),th=t=>e=>t.every(r=>ee(vr(e,r))),rh=(t,e)=>r=>{let a=nh(t,r);return e.some(n=>a.some(o=>`${o}`.toLowerCase()===n.toLowerCase()))},ah=(t,e)=>r=>{let a=nh(t,r);return e.every(n=>a.every(o=>`${o}`.toLowerCase()!==n.toLowerCase()))},nh=(t,e)=>{let r=vr(e,t);return ts(r)?r:[r]};function Ri(t){return t.search.response.searchUid!==""}function oh(t,e,r){return t.search.results.find(a=>vr(a,e)===r)}function Ud(t,e){var a;let r=(a=e.payload)!=null?a:null;r&&(t.response=Me().response,t.results=[],t.questionAnswer=un()),t.error=r,t.isLoading=!1}function _d(t,e){t.error=null,t.response=e.payload.response,t.queryExecuted=e.payload.queryExecuted,t.duration=e.payload.duration,t.isLoading=!1}function CA(t,e){_d(t,e),t.results=e.payload.response.results,t.searchResponseId=e.payload.response.searchUid,t.questionAnswer=e.payload.response.questionAnswer,t.extendedResults=e.payload.response.extendedResults}function $d(t,e){t.isLoading=!0,t.requestId=e.meta.requestId}var W=O(Me(),t=>{t.addCase(Ln.rejected,(e,r)=>Ud(e,r)),t.addCase(Bn.rejected,(e,r)=>Ud(e,r)),t.addCase(Qn.rejected,(e,r)=>Ud(e,r)),t.addCase(Ln.fulfilled,(e,r)=>{CA(e,r)}),t.addCase(Bn.fulfilled,(e,r)=>{_d(e,r),e.results=[...e.results,...r.payload.response.results]}),t.addCase(Qn.fulfilled,(e,r)=>{_d(e,r),e.results=r.payload.response.results}),t.addCase(ac.fulfilled,(e,r)=>{e.response.facets=r.payload.response.facets,e.response.searchUid=r.payload.response.searchUid}),t.addCase(Ln.pending,$d),t.addCase(Bn.pending,$d),t.addCase(Qn.pending,$d)});var ih=O(pi,t=>t);var sh=t=>e=>r=>{var o,i;let a=(o=r.payload)==null?void 0:o.analyticsAction;a!==void 0&&((i=r.payload)==null||delete i.analyticsAction);let n=e(r);return r.type==="search/executeSearch/fullfilled"&&a===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&a===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&a===void 0&&console.error("No analytics action associated with product recommendation:",r),a!==void 0&&t.dispatch(a),n};var mh=Ge(uh());var Un=h("tab/register",t=>{let e=new E({values:{id:P,expression:le}});return y(t,e)}),Rt=h("tab/updateActiveTab",t=>y(t,P));var ic=Ge(Ns()),ph=Ge(lh()),fh=Ge(dh());ic.default.extend(fh.default);ic.default.extend(ph.default);var Yd="/rest/search/v2",Kd="/rest/ua",_n=()=>({organizationId:"",accessToken:"",platformUrl:vs(),search:{apiBaseUrl:`${vs()}${Yd}`,locale:"en-US",timezone:ic.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${vd()}${Kd}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy"}});function vA(t,e){if(Wm(t))return t.replace(/^(https:\/\/)platform/,"$1analytics")+Kd;let a=Hm(t,e);return a?hi(e,a.environment).analytics:t}var $n=O(_n(),t=>t.addCase(jt,(e,r)=>{r.payload.accessToken&&(e.accessToken=r.payload.accessToken),r.payload.organizationId&&(e.organizationId=r.payload.organizationId),r.payload.platformUrl&&(e.platformUrl=r.payload.platformUrl,e.search.apiBaseUrl=`${r.payload.platformUrl}${Yd}`,e.analytics.apiBaseUrl=vA(r.payload.platformUrl,e.organizationId))}).addCase(it,(e,r)=>{r.payload.apiBaseUrl&&(e.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(e.search.locale=r.payload.locale),r.payload.timezone&&(e.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(e.search.authenticationProviders=r.payload.authenticationProviders)}).addCase(Lr,(e,r)=>{ee(r.payload.enabled)||(!r.payload.enabled&&e.analytics.enabled&&id(e.analytics),e.analytics.enabled=r.payload.enabled),ee(r.payload.originContext)||(e.analytics.originContext=r.payload.originContext),ee(r.payload.originLevel2)||(e.analytics.originLevel2=r.payload.originLevel2),ee(r.payload.originLevel3)||(e.analytics.originLevel3=r.payload.originLevel3),ee(r.payload.apiBaseUrl)||(e.analytics.apiBaseUrl=r.payload.apiBaseUrl),ee(r.payload.nextApiBaseUrl)||(e.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),ee(r.payload.trackingId)||(e.analytics.trackingId=r.payload.trackingId),ee(r.payload.analyticsMode)||(e.analytics.analyticsMode=r.payload.analyticsMode);let a=(0,mh.default)();a&&(e.analytics.analyticsMode="next",e.analytics.trackingId=a),ee(r.payload.runtimeEnvironment)||(e.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),ee(r.payload.anonymous)||(e.analytics.anonymous=r.payload.anonymous),ee(r.payload.deviceId)||(e.analytics.deviceId=r.payload.deviceId),ee(r.payload.userDisplayName)||(e.analytics.userDisplayName=r.payload.userDisplayName),ee(r.payload.documentLocation)||(e.analytics.documentLocation=r.payload.documentLocation)}).addCase(Sn,e=>{e.analytics.enabled=!1,id(e.analytics)}).addCase(yn,e=>{e.analytics.enabled=!0}).addCase(Os,(e,r)=>{e.analytics.originLevel2=r.payload.originLevel2}).addCase(qs,(e,r)=>{e.analytics.originLevel3=r.payload.originLevel3}).addCase(Rt,(e,r)=>{e.analytics.originLevel2=r.payload}).addCase(se,(e,r)=>{e.analytics.originLevel2=r.payload.tab||e.analytics.originLevel2}));var j=$n;function FA(t){return t.instantlyCallable}var gh=()=>t=>e=>t(FA(e)?e():e);var hh=t=>()=>e=>r=>{var n;if(!r.error)return e(r);let a=r.error;if(((n=r.payload)==null?void 0:n.ignored)||t.error(a.stack||a.message||a.name||"Error",`Action dispatch error ${r.type}`,r),r.error.name!=="SchemaValidationError")return e(r)},Sh=t=>e=>r=>a=>(t.debug({action:a,nextState:e.getState()},`Action dispatched: ${a.type}`),r(a));function yh(t,e){let r={...t},a,n=o=>(i,s)=>{let c=o(i,s);return a?a(c,s):c};return{get combinedReducer(){let o=qf(Object.entries(e).filter(([i])=>!(i in r)).map(([i,s])=>[i,()=>s]));return n(es({...o,...r}))},containsAll(o){return Object.keys(o).every(s=>s in r)},add(o){Object.keys(o).filter(i=>!(i in r)).forEach(i=>r[i]=o[i])},addCrossReducer(o){a=o}}}function sc(t,e,r){var a,n,o;e===void 0&&(e=50),r===void 0&&(r={});var i=(a=r.isImmediate)!=null&&a,s=(n=r.callback)!=null&&n,c=r.maxWait,u=Date.now(),l=[];function d(){if(c!==void 0){var p=Date.now()-u;if(p+e>=c)return c-p}return e}var f=function(){var p=[].slice.call(arguments),m=this;return new Promise(function(S,v){var C=i&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,u=Date.now(),!i){var D=t.apply(m,p);s&&s(D),l.forEach(function(Q){return(0,Q.resolve)(D)}),l=[]}},d()),C){var F=t.apply(m,p);return s&&s(F),S(F)}l.push({resolve:S,reject:v})})};return f.cancel=function(p){o!==void 0&&clearTimeout(o),l.forEach(function(m){return(0,m.reject)(p)}),l=[]},f}function Ch(t,e){let r=0,a=sc(()=>r=0,500);return n=>o=>async i=>{if(!(typeof i=="function"))return o(i);let c=await o(i);if(!bA(c))return c;if(typeof e!="function")return t.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),c;if(r>=5)return t.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),c;r++,a();let u=await RA(e);n.dispatch(jt({accessToken:u})),n.dispatch(i)}}function bA(t){var e;return((e=t==null?void 0:t.error)==null?void 0:e.name)===new gi().name}async function RA(t){try{return await t()}catch(e){return""}}function xh({reducer:t,preloadedState:e,middlewares:r=[],thunkExtraArguments:a,name:n}){return xf({reducer:t,preloadedState:e,devTools:{stateSanitizer:o=>o.history?{...o,history:"<<OMIT>>"}:o,name:n,shouldHotReload:!1},middleware:o=>[...r,...o({thunk:{extraArgument:a}}),Sh(a.logger)]})}var AA={configuration:j,version:ih};function PA(t,e){var i,s;let r=((i=t.configuration.organizationEndpoints)==null?void 0:i.analytics)||void 0,{analyticsClientMiddleware:a,...n}=(s=t.configuration.analytics)!=null?s:{},o={...n,nextApiBaseUrl:`${r}/rest/organizations/${t.configuration.organizationId}/events/v1`,apiBaseUrl:r};return ns()?(e.info("Analytics disabled since doNotTrack is active."),{...o,enabled:!1}):o}function vh(t,e){var c;let r=wA(t,e),{accessToken:a,organizationId:n}=t.configuration,{organizationEndpoints:o}=t.configuration,i=(o==null?void 0:o.platform)||t.configuration.platformUrl;OA(t)&&r.logger.warn(`The \`platformUrl\` (${t.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),kA(t)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):qA(t)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${t.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${(c=t.configuration.organizationEndpoints)==null?void 0:c.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(jt({accessToken:a,organizationId:n,platformUrl:i}));let s=PA(t,r.logger);return s&&r.dispatch(Lr(s)),r}function wA(t,e){var i;let{reducers:r}=t,a=yh({...AA,...r},(i=t.preloadedState)!=null?i:{});t.crossReducer&&a.addCrossReducer(t.crossReducer);let n=e.logger,o=EA(t,e,a);return{addReducers(s){a.containsAll(s)||(a.add(s),o.replaceReducer(a.combinedReducer))},dispatch:o.dispatch,subscribe:o.subscribe,enableAnalytics(){o.dispatch(yn())},disableAnalytics(){o.dispatch(Sn())},get state(){return o.getState()},logger:n,store:o}}function EA(t,e,r){let{preloadedState:a,configuration:n}=t,o=n.name||"coveo-headless",i=IA(t,e.logger);return xh({preloadedState:a,reducer:r.combinedReducer,middlewares:i,thunkExtraArguments:e,name:o})}function IA(t,e){let{renewAccessToken:r}=t.configuration,a=Ch(e,r);return[gh,a,hh(e),sh].concat(t.middlewares||[])}function kA(t){return Ae(t.configuration.organizationEndpoints)}function OA(t){var e;return!ee(t.configuration.platformUrl)||ee((e=t.configuration.organizationEndpoints)==null?void 0:e.platform)}function qA(t){let{platform:e}=t.configuration.organizationEndpoints;if(Ae(e))return!1;let r=ld(e);return r&&r.organizationId!==t.configuration.organizationId}var kh=Ge(Ih());function Oh(t){return(0,kh.default)({name:"@coveo/headless",level:(t==null?void 0:t.level)||"warn",formatters:{log:t==null?void 0:t.logFormatter}})}function qh(t,e){let r=KA(t),a=nt,n=JA(t);return{analyticsClientMiddleware:r,validatePayload:a,preprocessRequest:n,logger:e}}function KA(t){let{analytics:e}=t,r=(a,n)=>n;return(e==null?void 0:e.analyticsClientMiddleware)||r}function JA(t){return t.preprocessRequest||Cs}var Th=Ge(Dl());var tp=(t,e,r,a,n,o)=>{let i=t[e];ee(i)||ee(n)||n!==i&&n!==a&&(o.warn(`Mismatch on access token (JWT Token) ${e} and engine configuration.`),o.warn(`To remove this warning, make sure that access token value [${i}] matches engine configuration value [${r}]`))},rp=(t,e)=>!(ee(t)||e===t),wi=t=>{try{let e=typeof atob!="undefined"?atob:Th.atob,a=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=e(a);if(!n)return!1;let o=decodeURIComponent(n.split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(o)}catch(e){return!1}},Dh=(t,e)=>(rp(t.searchHub,e.searchHub)&&(e.searchHub=t.searchHub),e),Vh=(t,e,r,a)=>(tp(t,"searchHub",e.searchHub,Nt(),r,a),Dh(t,e)),Nh=(t,e)=>(rp(t.pipeline,e.pipeline)&&(e.pipeline=t.pipeline),e),Mh=(t,e,r,a)=>(tp(t,"pipeline",e.pipeline,Nr(),r,a),Nh(t,e)),Lh=(t,e)=>(rp(t.userDisplayName,e.configuration.analytics.userDisplayName)&&(e.configuration.analytics.userDisplayName=t.userDisplayName),e),XA=(t,e,r,a)=>(tp(t,"userDisplayName",e.configuration.analytics.userDisplayName,_n().analytics.userDisplayName,r,a),Lh(t,e)),Qh=t=>O({},e=>{e.addCase(Fn,(r,a)=>{let n=wi(r.configuration.accessToken);return n?Vh(n,r,a.payload,t):r}).addCase(xn,(r,a)=>{let n=wi(r.configuration.accessToken);return n?Mh(n,r,a.payload,t):r}).addCase(jt,(r,a)=>{if(r.configuration.accessToken!==a.payload.accessToken)return r;let{accessToken:n}=a.payload;if(!n)return r;let o=wi(n);return o?[Nh,Dh,Lh].reduce((i,s)=>s(o,i),r):r}).addCase(it,(r,a)=>{var s;let n=wi(r.configuration.accessToken);if(!n)return r;let o=Vh(n,r,a.payload.searchHub,t);return Mh(n,o,(s=a.payload)==null?void 0:s.pipeline,t)}).addCase(Lr,(r,a)=>{let n=wi(r.configuration.accessToken);return n?XA(n,r,a.payload.userDisplayName,t):r})});var Bh={organizationId:P,accessToken:P,platformUrl:new b({required:!1,emptyAllowed:!1}),name:new b({required:!1,emptyAllowed:!1}),analytics:new E({options:{required:!1},values:{enabled:new $({required:!1}),originContext:new b({required:!1}),originLevel2:new b({required:!1}),originLevel3:new b({required:!1}),analyticsMode:new b({constrainTo:["legacy","next"],required:!1})}})};function jh(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",organizationEndpoints:hi("searchuisamples")}}var Uh=new z({...Bh,search:new E({options:{required:!1},values:{pipeline:new b({required:!1,emptyAllowed:!0}),searchHub:pe,locale:pe,timezone:pe,authenticationProviders:new H({required:!1,each:P})}})});function _h(){return{...jh(),search:{searchHub:"default"}}}var ZA={debug:jr,pipeline:vn,searchHub:bn,search:W};function eP(t){var n;let e=t.configuration.search,r=((n=t.configuration.organizationEndpoints)==null?void 0:n.search)||void 0;return{...e,apiBaseUrl:r}}function $h(t){let e=Oh(t.loggerOptions);tP(t.configuration,e);let r=rP(t.configuration,e),a=aP(e),n={...qh(t.configuration,e),apiClient:r,streamingClient:a},o={...t,reducers:ZA,crossReducer:Qh(e)},i=vh(o,n),s=eP(t);return s&&i.dispatch(it(s)),{...i,get state(){return i.state},executeFirstSearch(c=Es()){if(Ri(i.state))return;let u=R({legacy:c,next:{actionCause:T.interfaceLoad,getEventExtraPayload:l=>new L(()=>l).getBaseMetadata()}});i.dispatch(u)},executeFirstSearchAfterStandaloneSearchBoxRedirect(c){let{cause:u,metadata:l}=c;if(Ri(i.state))return;let d=l&&u==="omniboxFromLink",f=R({legacy:d?ks(l):Is(),next:{actionCause:d?T.omniboxFromLink:T.searchFromLink,getEventExtraPayload:d?p=>new L(()=>p).getOmniboxFromLinkMetadata(l):p=>new L(()=>p).getBaseMetadata()}});i.dispatch(f)}}}function tP(t,e){try{Uh.validate(t)}catch(r){throw e.error(r,"Search engine configuration error"),r}}function rP(t,e){let{search:r}=t;return new Fd({logger:e,preprocessRequest:t.preprocessRequest||Cs,postprocessSearchResponseMiddleware:(r==null?void 0:r.preprocessSearchResponseMiddleware)||mg,postprocessFacetSearchResponseMiddleware:(r==null?void 0:r.preprocessFacetSearchResponseMiddleware)||gg,postprocessQuerySuggestResponseMiddleware:(r==null?void 0:r.preprocessQuerySuggestResponseMiddleware)||hg})}function aP(t){return new pd({logger:t})}function nP(t){return/^search\/executeSearch\/(fulfilled|rejected)$/.test(t.type)}function oP(t){var n;let{middleware:e,promise:r}=Df(nP),a=$h({...t,middlewares:[...(n=t.middlewares)!=null?n:[],e]});return{...a,get state(){return a.state},waitForSearchCompletedAction(){return r}}}function iP({controllers:t,...e}){let r=async(...[o])=>{let i=oP((o==null?void 0:o.extend)?await o.extend(e):e),s=Vf({definitionsMap:t!=null?t:{},engine:i,propsMap:o&&"controllers"in o?o.controllers:{}});return{engine:i,controllers:s}},a=Nl(async(...o)=>{let i=await r(...o);return await a.fromBuildResult({buildResult:i})},{fromBuildResult:async(...o)=>{let[{buildResult:{engine:i,controllers:s}}]=o;return i.executeFirstSearch(),Nf({searchAction:await i.waitForSearchCompletedAction(),controllers:s})}}),n=Nl(async(...o)=>{let i=await r(...o);return await n.fromBuildResult({buildResult:i,searchAction:o[0].searchAction})},{fromBuildResult:async(...o)=>{let[{buildResult:{engine:i,controllers:s},searchAction:c}]=o;return i.dispatch(c),await i.waitForSearchCompletedAction(),{engine:i,controllers:s}}});return{build:r,fetchStaticState:a,hydrateStaticState:n}}var Wh=t=>{let e=/Document weights:\n((?:.)*?)\n+/g,r=/Terms weights:\n((?:.|\n)*)\n+/g,a=/Total weight: ([0-9]+)/g;if(!t)return null;let n=e.exec(t),o=r.exec(t),i=a.exec(t),s=cP(t),c=Hh(n?n[1]:null),u=sP(o),l=i?Number(i[1]):null;return{documentWeights:c,termsWeight:u,totalWeight:l,qreWeights:s}},Hh=t=>{let e=/(\w+(?:\s\w+)*): ([-0-9]+)/g,r=/^(\w+(?:\s\w+)*): ([-0-9]+)$/;if(!t)return null;let a=t.match(e);if(!a)return null;let n={};for(let o of a){let i=o.match(r);if(i){let s=i[1],c=i[2];n[s]=Number(c)}}return n},zh=(t,e)=>{let r=[],a;for(;(a=e.exec(t))!==null;)r.push(a);return r},sP=t=>{let e=/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g,r=/([^:]+): ([0-9]+), ([0-9]+); /g;if(!t||!t[1])return null;let a=zh(t[1],e);if(!a)return null;let n={};for(let o of a){let i=zh(o[1],r),s={};for(let u of i)s[u[1]]={Correlation:Number(u[2]),"TF-IDF":Number(u[3])};let c=Hh(o[2]);n[Object.keys(s).join(", ")]={terms:s,Weights:c}}return n},cP=t=>{let e=/(Expression:\s".*")\sScore:\s(?!0)([-0-9]+)\n+/g,r=e.exec(t),a=[];for(;r;)a.push({expression:r[1],score:parseInt(r[2],10)}),r=e.exec(t);return a};function Gh(t){return t.search.response.results.map(r=>{let a=Wh(r.rankingInfo);return{result:r,ranking:a}})}var uP=new H({each:P,required:!0}),Hr=h("fields/registerFieldsToInclude",t=>y(t,uP)),Wn=h("fields/fetchall/enable"),Ea=h("fields/fetchall/disable"),Hn=J("fields/fetchDescription",async(t,{extra:e,getState:r,rejectWithValue:a})=>{let n=r(),{accessToken:o,organizationId:i}=n.configuration,{apiBaseUrl:s}=n.configuration.search,c=await e.apiClient.fieldDescriptions({accessToken:o,organizationId:i,url:s});return ye(c)?a(c.error):c.success.fields});var ap={collectionField:new b({emptyAllowed:!1,required:!1}),parentField:new b({emptyAllowed:!1,required:!1}),childField:new b({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new I({min:0,required:!1})},zr=h("folding/register",t=>y(t,ap)),Gr=J("folding/loadCollection",async(t,{getState:e,rejectWithValue:r,extra:{apiClient:a}})=>{let n=e(),o=await _r(n),i=await a.search({...o,q:lP(n),enableQuerySyntax:!0,cq:`@${n.folding.fields.collection}="${t}"`,filterField:n.folding.fields.collection,childField:n.folding.fields.parent,parentField:n.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return ye(i)?r(i.error):{collectionId:t,results:i.success.results,rootResult:n.folding.collections[t].result}});function lP(t){return t.query.q===""?"":t.query.enableQuerySyntax?`${t.query.q} OR @uri`:`( <@- ${t.query.q} -@> ) OR @uri`}var pc=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});var np=["author","language","urihash","objecttype","collection","source","permanentid"],Yh=[...np,"date","filetype","parents"],dP=[...Yh,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],Kh=()=>({fieldsToInclude:np,fetchAllFields:!1,fieldsDescription:[]});var Yr=O(Kh(),t=>t.addCase(Hr,(e,r)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(r.payload))]}).addCase(Wn,e=>{e.fetchAllFields=!0}).addCase(Ea,e=>{e.fetchAllFields=!1}).addCase(Hn.fulfilled,(e,{payload:r})=>{e.fieldsDescription=r}).addCase(zr,(e,{payload:r})=>{var n,o,i;let a=pc().fields;e.fieldsToInclude.push((n=r.collectionField)!=null?n:a.collection,(o=r.parentField)!=null?o:a.parent,(i=r.childField)!=null?i:a.child)}));function N(t){let e,r=new Map,a=()=>r.size===0,n=o=>{try{let i=JSON.stringify(o),s=e!==i;return e=i,s}catch(i){return console.warn('Could not detect if state has changed, check the controller "get state method"',i),!0}};return{subscribe(o){o();let i=Symbol(),s;return a()&&(e=JSON.stringify(this.state),s=t.subscribe(()=>{n(this.state)&&r.forEach(c=>c())})),r.set(i,o),()=>{r.delete(i),a()&&s&&s()}},get state(){return{}}}}var pP=new z({enabled:new $({default:!1})});function Jh(t,e={}){if(!fP(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state;Pe(t,pP,e.initialState,"buildRelevanceInspector").enabled&&a(Qr());let i=s=>{t.logger.warn(`Flag [ ${s} ] is now activated. This should *not* be used in any production environment as it negatively impact performance.`)};return{...r,get state(){let s=n(),c=s.debug;if(!s.debug)return{isEnabled:c};let{executionReport:u,basicExpression:l,advancedExpression:d,constantExpression:f,userIdentities:p,rankingExpressions:m}=s.search.response,{fieldsDescription:S,fetchAllFields:v}=s.fields;return{isEnabled:c,rankingInformation:Gh(s),executionReport:u,expressions:{basicExpression:l,advancedExpression:d,constantExpression:f},userIdentities:p,rankingExpressions:m,fieldsDescription:S,fetchAllFields:v}},enable(){a(Qr()),i("debug")},disable(){a(Cn()),a(Ea())},enableFetchAllFields(){a(Wn()),i("fetchAllFields")},disableFetchAllFields(){a(Ea())},fetchFieldsDescription(){!this.state.isEnabled&&a(Qr()),a(Hn()),i("fieldsDescription"),t.logger.warn(`For production environment, please specify the necessary fields either when instantiating a ResultList controller, or by dispatching a registerFieldsToInclude action.
        
        https://docs.coveo.com/en/headless/latest/reference/search/controllers/result-list/#resultlistoptions
        https://docs.coveo.com/en/headless/latest/reference/search/actions/field/#registerfieldstoinclude`)}}}function fP(t){return t.addReducers({debug:jr,search:W,configuration:j,fields:Yr}),!0}var mP=t=>({build:e=>Jh(e,t)});var gP=new H({each:P,required:!0}),Xh=(t,e)=>(y(t,P),ln(e)?y(e,P):y(e,gP),{payload:{contextKey:t,contextValue:e}}),Ia=h("context/set",t=>{for(let[e,r]of Object.entries(t))Xh(e,r);return{payload:t}}),ka=h("context/add",t=>Xh(t.contextKey,t.contextValue)),Oa=h("context/remove",t=>y(t,P));var fc=O(_s(),t=>{t.addCase(Ia,(e,r)=>{e.contextValues=r.payload}).addCase(ka,(e,r)=>{e.contextValues[r.payload.contextKey]=r.payload.contextValue}).addCase(Oa,(e,r)=>{delete e.contextValues[r.payload]}).addCase(ie.fulfilled,(e,r)=>{!r.payload||(e.contextValues=r.payload.context.contextValues)})});var hP=["caseId","caseNumber"],SP={caseId:"caseContext",caseNumber:"caseContext"},mc=class extends Error{constructor(e){super(`The key "${e}" is reserved for internal use. Use ${SP[e]} to set this value.}`)}};function op(t){return hP.includes(t)}var yP=new z({values:new E({options:{required:!1}})});function Zh(t,e={}){if(!vP(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o=Pe(t,yP,e.initialState,"buildContext");return o.values&&a(Ia(o.values)),{...r,get state(){return{values:n().context.contextValues}},set(i){a(Ia(i))},...n().configuration.analytics.analyticsMode==="legacy"?CP(a):xP(a)}}var CP=t=>({add(e,r){t(ka({contextKey:e,contextValue:r}))},remove(e){t(Oa(e))}}),xP=t=>({add(e,r){if(op(e))throw new mc(e);t(ka({contextKey:e,contextValue:r}))},remove(e){if(op(e))throw new mc(e);t(Oa(e))}});function vP(t){return t.addReducers({context:fc}),!0}function eS(t,e){return Zh(t,e)}var FP=()=>({buildWithProps:(t,e)=>eS(t,{initialState:e.initialState})});var zn=h("dictionaryFieldContext/set",t=>{let e=new E({options:{required:!0}}),r=y(t,e).error;if(r)return{payload:t,error:r};let a=Object.values(t),n=new H({each:le}),o=y(a,n).error;return o?{payload:t,error:o}:{payload:t}}),Gn=h("dictionaryFieldContext/add",t=>{let e=new E({options:{required:!0},values:{field:le,key:le}});return y(t,e)}),Yn=h("dictionaryFieldContext/remove",t=>y(t,le));var gc=O($s(),t=>{t.addCase(zn,(e,r)=>{e.contextValues=r.payload}).addCase(Gn,(e,r)=>{let{field:a,key:n}=r.payload;e.contextValues[a]=n}).addCase(Yn,(e,r)=>{delete e.contextValues[r.payload]}).addCase(ie.fulfilled,(e,r)=>{!r.payload||(e.contextValues=r.payload.dictionaryFieldContext.contextValues)})});function tS(t){if(!bP(t))throw A;let e=N(t),{dispatch:r}=t,a=()=>t.state;return{...e,get state(){return{values:a().dictionaryFieldContext.contextValues}},set(n){r(zn(n))},add(n,o){r(Gn({field:n,key:o}))},remove(n){r(Yn(n))}}}function bP(t){return t.addReducers({dictionaryFieldContext:gc}),!0}var RP=()=>({build:t=>tS(t)});var hc=()=>({correctedQuery:"",wordCorrections:[],originalQuery:""});function rS(){return{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:hc(),originalQuery:"",automaticallyCorrectQuery:!0}}var Sc=O(rS(),t=>{t.addCase(Dn,e=>{e.enableDidYouMean=!0}).addCase(Bs,e=>{e.enableDidYouMean=!1}).addCase(js,e=>{e.automaticallyCorrectQuery=!0}).addCase(Vn,e=>{e.automaticallyCorrectQuery=!1}).addCase(R.pending,e=>{e.queryCorrection=hc(),e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""}).addCase(R.fulfilled,(e,r)=>{e.queryCorrection=r.payload.response.queryCorrections[0]||hc(),e.originalQuery=r.payload.originalQuery,e.wasAutomaticallyCorrected=r.payload.automaticallyCorrected}).addCase(lt,(e,r)=>{e.wasCorrectedTo=r.payload})});function aS(t,e={}){if(!AP(t))throw A;let r=N(t),{dispatch:a}=t;a(Dn()),e.automaticallyCorrectQuery===!1&&a(Vn());let n=()=>t.state;return{...r,get state(){let o=n();return{originalQuery:o.didYouMean.originalQuery,wasCorrectedTo:o.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:o.didYouMean.wasAutomaticallyCorrected,queryCorrection:o.didYouMean.queryCorrection,hasQueryCorrection:o.didYouMean.queryCorrection.correctedQuery!==""||o.didYouMean.wasCorrectedTo!==""}},applyCorrection(){a(lt(this.state.queryCorrection.correctedQuery))}}}function AP(t){return t.addReducers({configuration:j,didYouMean:Sc}),!0}function nS(t){let e=aS(t),{dispatch:r}=t;return{...e,get state(){return e.state},applyCorrection(){e.applyCorrection(),r(R({legacy:Us(),next:{actionCause:T.didyoumeanClick,getEventExtraPayload:a=>new L(()=>a).getBaseMetadata()}}))}}}var PP=()=>({build:t=>nS(t)});var G=P;var re=h("facetOptions/update",(t={freezeFacetOrder:!0})=>y(t,{freezeFacetOrder:new $({required:!1})})),$e=h("facetOptions/facet/enable",t=>y(t,G)),xe=h("facetOptions/facet/disable",t=>y(t,G));var Ei={facetId:G,captions:new E({options:{required:!1}}),numberOfValues:new I({required:!1,min:1}),query:new b({required:!1,emptyAllowed:!0})};var wP={path:new H({required:!0,each:P}),displayValue:le,rawValue:le,count:new I({required:!0,min:0})},Kn=h("categoryFacet/selectSearchResult",t=>y(t,{facetId:G,value:new E({values:wP})})),Jn=h("categoryFacetSearch/register",t=>y(t,Ei));function Xn(t,e){var o;let{facetId:r,criterion:a}=e,n=(o=t[r])==null?void 0:o.request;!n||(n.sortCriteria=a)}function Ii(t){!t||(t.currentValues=t.currentValues.map(e=>({...e,state:"idle"})),t.preventAutoSelect=!0)}function yc(t,e){!t||(t.numberOfValues=e)}function Cc(t,e){let r=t[e];!r||(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function ip(t,e,r){t.currentValues=EP(e,r),t.numberOfValues=e.length?1:r,t.preventAutoSelect=!0}function EP(t,e){if(!t.length)return[];let r=oS(t[0],e),a=r;for(let n of t.splice(1)){let o=oS(n,e);a.children.push(o),a=o}return a.state="selected",a.retrieveChildren=!0,[r]}function oS(t,e){return{value:t,retrieveCount:e,children:[],state:"idle",retrieveChildren:!1}}var IP={state:new ue({required:!0}),numberOfResults:new I({required:!0,min:0}),value:new b({required:!0,emptyAllowed:!0}),path:new H({required:!0,each:P}),moreValuesAvailable:new $({required:!1})};function sp(t){t.children.forEach(e=>{sp(e)}),nt({state:t.state,numberOfResults:t.numberOfResults,value:t.value,path:t.path,moreValuesAvailable:t.moreValuesAvailable},IP)}var Zn={facetId:G,field:P,delimitingCharacter:new b({required:!1,emptyAllowed:!0}),filterFacetCount:new $({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new ue({required:!1}),basePath:new H({required:!1,each:P}),filterByBasePath:new $({required:!1})},Ht=h("categoryFacet/register",t=>y(t,Zn)),Kr=h("categoryFacet/toggleSelectValue",t=>{try{return nt(t.facetId,P),sp(t.selection),{payload:t,error:null}}catch(e){return{payload:t,error:yr(e)}}}),zt=h("categoryFacet/deselectAll",t=>y(t,Zn.facetId)),qa=h("categoryFacet/updateNumberOfValues",t=>y(t,{facetId:Zn.facetId,numberOfValues:Zn.numberOfValues})),eo=h("categoryFacet/updateSortCriterion",t=>y(t,{facetId:Zn.facetId,criterion:new ue})),xc=h("categoryFacet/updateBasePath",t=>y(t,{facetId:Zn.facetId,basePath:new H({each:P})}));var pt=O(an(),t=>{t.addCase(Ht,(e,r)=>{let a=r.payload,{facetId:n}=a;if(n in e)return;let o=OP(a),i=o.numberOfValues;e[n]={request:o,initialNumberOfValues:i}}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.categoryFacetSet)!=null?n:e}).addCase(se,(e,r)=>{let a=r.payload.cf||{};Object.keys(e).forEach(n=>{let o=e[n].request,i=a[n]||[];(i.length||o.currentValues.length)&&ip(o,i,e[n].initialNumberOfValues)})}).addCase(eo,(e,r)=>{var i;let{facetId:a,criterion:n}=r.payload,o=(i=e[a])==null?void 0:i.request;!o||(o.sortCriteria=n)}).addCase(xc,(e,r)=>{var i;let{facetId:a,basePath:n}=r.payload,o=(i=e[a])==null?void 0:i.request;!o||(o.basePath=[...n])}).addCase(Kr,(e,r)=>{var d;let{facetId:a,selection:n,retrieveCount:o}=r.payload,i=(d=e[a])==null?void 0:d.request;if(!i)return;let{path:s}=n,c=s.slice(0,s.length-1),u=kP(i,c,o);if(u.length){let f=u[0];f.retrieveChildren=!0,f.state="selected",f.children=[];return}let l=iS(n.value,o);l.state="selected",u.push(l),i.numberOfValues=1}).addCase(zt,(e,r)=>{let a=r.payload;Cc(e,a)}).addCase(Ce,e=>{Object.keys(e).forEach(r=>Cc(e,r))}).addCase(st,(e,r)=>Object.keys(e).forEach(a=>{e[a].request.preventAutoSelect=!r.payload.allow})).addCase(qa,(e,r)=>{var i;let{facetId:a,numberOfValues:n}=r.payload,o=(i=e[a])==null?void 0:i.request;if(!!o){if(!o.currentValues.length)return yc(o,n);qP(e,r.payload)}}).addCase(Kn,(e,r)=>{let{facetId:a,value:n}=r.payload,o=e[a];if(!o)return;let i=[...n.path,n.rawValue];ip(o.request,i,o.initialNumberOfValues)}).addCase(Wt.fulfilled,(e,r)=>{sS(e,r.payload.response.facets)}).addCase(R.fulfilled,(e,r)=>{sS(e,r.payload.response.facets)}).addCase(xe,(e,r)=>{Cc(e,r.payload)})}),ki={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function kP(t,e,r){let a=t.currentValues;for(let n of e){let o=a[0];(!o||n!==o.value)&&(o=iS(n,r),a.length=0,a.push(o)),o.retrieveChildren=!1,o.state="idle",a=o.children}return a}function OP(t){return{...ki,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...t}}function iS(t,e){return{value:t,state:"idle",children:[],retrieveChildren:!0,retrieveCount:e}}function sS(t,e){e.forEach(r=>{var i;if(!TP(t,r))return;let a=r.facetId,n=(i=t[a])==null?void 0:i.request;if(!n)return;let o=DP(n,r);n.currentValues=o?[]:n.currentValues,n.preventAutoSelect=!1})}function qP(t,e){var o;let{facetId:r,numberOfValues:a}=e,n=(o=t[r])==null?void 0:o.request.currentValues[0];if(!!n){for(;n.children.length&&(n==null?void 0:n.state)!=="selected";)n=n.children[0];n.retrieveCount=a}}function TP(t,e){return e.facetId in t}function DP(t,e){let r=Ke(t.currentValues),a=Ke(e.values);return r.length!==a.length}function vc(t,e,r){let{facetId:a}=e;if(t[a])return;let n=!1,o={...Gt,...e},i=r();t[a]={options:o,isLoading:n,response:i,initialNumberOfValues:o.numberOfValues,requestId:""}}function Fc(t,e){let{facetId:r,...a}=e,n=t[r];!n||(n.options={...n.options,...a})}function bc(t,e,r){let a=t[e];!a||(a.requestId=r,a.isLoading=!0)}function Rc(t,e){let r=t[e];!r||(r.isLoading=!1)}function Ac(t,e,r){let{facetId:a,response:n}=e,o=t[a];!o||o.requestId===r&&(o.isLoading=!1,o.response=n)}function Oi(t,e,r){let{facetId:a}=e,n=t[a];!n||(n.requestId="",n.isLoading=!1,n.response=r(),n.options.numberOfValues=n.initialNumberOfValues,n.options.query=Gt.query)}function Pc(t,e){Object.keys(t).forEach(r=>Oi(t,{facetId:r},e))}var Gt={captions:{},numberOfValues:10,query:""};var cS=async(t,e,r)=>{let a=e.categoryFacetSearchSet[t].options,n=e.categoryFacetSet[t].request,{captions:o,query:i,numberOfValues:s}=a,{field:c,delimitingCharacter:u,basePath:l,filterFacetCount:d}=n,f=VP(n),p=f.length?[f]:[],m=`*${i}*`;return{url:e.configuration.search.apiBaseUrl,accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")},basePath:l,captions:o,numberOfValues:s,query:m,field:c,delimitingCharacter:u,ignorePaths:p,filterFacetCount:d,type:"hierarchical",...r?{}:{searchContext:(await we(e)).request}}},VP=t=>{let e=[],r=t.currentValues[0];for(;r;)e.push(r.value),r=r.children[0];return e};var uS=async(t,e,r)=>{let{captions:a,query:n,numberOfValues:o}=e.facetSearchSet[t].options,{field:i,currentValues:s,filterFacetCount:c}=e.facetSet[t].request,u=s.filter(d=>d.state!=="idle").map(d=>d.value),l=`*${n}*`;return{url:e.configuration.search.apiBaseUrl,accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,...e.configuration.search.authenticationProviders&&{authentication:e.configuration.search.authenticationProviders.join(",")},captions:a,numberOfValues:o,query:l,field:i,ignoreValues:u,filterFacetCount:c,type:"specific",...r?{}:{searchContext:(await we(e)).request}}};var lS=t=>async(e,{getState:r,extra:{apiClient:a,validatePayload:n}})=>{let o=r(),i;n(e,P),NP(o,e)?i=await uS(e,o,t):i=await cS(e,o,t);let s=await a.facetSearch(i);return{facetId:e,response:s}},At=J("facetSearch/executeSearch",lS(!1)),cp=J("facetSearch/executeSearch",lS(!0)),to=h("facetSearch/clearResults",t=>y(t,{facetId:G})),NP=(t,e)=>t.facetSearchSet!==void 0&&t.facetSet!==void 0&&t.facetSet[e]!==void 0;var dS={facetId:G,value:new E({values:{displayValue:le,rawValue:le,count:new I({required:!0,min:0})}})},wc=h("facetSearch/register",t=>y(t,Ei)),Jr=h("facetSearch/update",t=>y(t,Ei)),Ta=h("facetSearch/toggleSelectValue",t=>y(t,dS)),qi=h("facetSearch/toggleExcludeValue",t=>y(t,dS));function pS(){return{}}var ro=O(pS(),t=>{t.addCase(Jn,(e,r)=>{let a=r.payload;vc(e,a,up)}).addCase(Jr,(e,r)=>{Fc(e,r.payload)}).addCase(At.pending,(e,r)=>{let a=r.meta.arg;bc(e,a,r.meta.requestId)}).addCase(At.rejected,(e,r)=>{let a=r.meta.arg;Rc(e,a)}).addCase(At.fulfilled,(e,r)=>{Ac(e,r.payload,r.meta.requestId)}).addCase(to,(e,{payload:{facetId:r}})=>{Oi(e,{facetId:r},up)}).addCase(R.fulfilled,e=>{Pc(e,up)})});function up(){return{moreValuesAvailable:!1,values:[]}}var ao=t=>w("analytics/facet/showMore",(e,r)=>{y(t,G);let a=cn(t,Je(r));return e.makeFacetShowMore(a)}),no=t=>w("analytics/facet/showLess",(e,r)=>{y(t,G);let a=cn(t,Je(r));return e.makeFacetShowLess(a)}),Yt=t=>w("analytics/facet/sortChange",(e,r)=>{y(t,{facetId:G,criterion:new ue({required:!0})});let{facetId:a,criterion:n}=t,o=Je(r),s={...cn(a,o),criteria:n};return e.makeFacetUpdateSort(s)}),ke=t=>w("analytics/facet/reset",(e,r)=>{y(t,G);let a=Je(r),n=cn(t,a);return e.makeFacetClearAll(n)}),be=t=>w("analytics/facet/select",(e,r)=>{y(t,{facetId:G,facetValue:P});let a=Je(r),n=ui(t,a);return e.makeFacetSelect(n)}),Pt=t=>w("analytics/facet/exclude",(e,r)=>{y(t,{facetId:G,facetValue:P});let a=Je(r),n=ui(t,a);return e.makeFacetExclude(n)}),Ze=t=>w("analytics/facet/deselect",(e,r)=>{y(t,{facetId:G,facetValue:P});let a=Je(r),n=ui(t,a);return e.makeFacetDeselect(n)}),oo=t=>w("analytics/facet/breadcrumb",(e,r)=>{y(t,{facetId:G,facetValue:P});let a=ui(t,Je(r));return e.makeBreadcrumbFacet(a)});var Kt=(t,e)=>{var r,a;return(a=(r=t.facetOptions.facets[e])==null?void 0:r.enabled)!=null?a:!0};var Jt=new b({regex:/^[a-zA-Z0-9-_]+$/}),Xt=new b({required:!0}),fS=new H({each:new b}),mS=new b,gS=new $,Zt=new $,er=new I({min:0}),wt=new I({min:1}),Ec=new $({required:!0}),MP=new E,LP=new b,QP={captions:MP,numberOfValues:wt,query:LP},io=new E({values:QP}),Ic=new E({options:{required:!1},values:{type:new b({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new H({required:!0,max:25,each:new b({emptyAllowed:!1,required:!0})})}}),hS=new $,kc=new H({min:1,max:25,required:!1,each:new b({emptyAllowed:!1,required:!0})});var Da={value:P,numberOfResults:new I({min:0}),state:P};var BP={facetId:G,field:new b({required:!0,emptyAllowed:!0}),filterFacetCount:new $({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new ue({required:!1}),resultsMustMatch:new ue({required:!1}),allowedValues:Ic,customSort:kc},tr=h("facet/register",t=>y(t,BP)),rr=h("facet/toggleSelectValue",t=>y(t,{facetId:G,selection:new E({values:Da})})),Xr=h("facet/toggleExcludeValue",t=>y(t,{facetId:G,selection:new E({values:Da})})),me=h("facet/deselectAll",t=>y(t,G)),so=h("facet/updateSortCriterion",t=>y(t,{facetId:G,criterion:new ue({required:!0})})),Va=h("facet/updateNumberOfValues",t=>y(t,{facetId:G,numberOfValues:new I({required:!0,min:1})})),Na=h("facet/updateIsFieldExpanded",t=>y(t,{facetId:G,isFieldExpanded:new $({required:!0})})),Ma=h("facet/updateFreezeCurrentValues",t=>y(t,{facetId:G,freezeCurrentValues:new $({required:!0})}));function Zr(t){var o,i;let e=SS(t.start,t),r=SS(t.end,t),a=(o=t.endInclusive)!=null?o:!1,n=(i=t.state)!=null?i:"idle";return{start:e,end:r,endInclusive:a,state:n}}function SS(t,e){let{dateFormat:r}=e;return _g(t)?(ba(t),Bg(t)):typeof t=="string"&&_t(t)?(ba(t),t):(Ls(t,r),xi(Fa(t,r)))}var co=h("rangeFacet/updateSortCriterion",t=>y(t,{facetId:G,criterion:new ue({required:!0})}));var La={state:P,start:new I({required:!0}),end:new I({required:!0}),endInclusive:new $({required:!0}),numberOfResults:new I({required:!0,min:0})},Qa={start:P,end:P,endInclusive:new $({required:!0}),state:P,numberOfResults:new I({required:!0,min:0})},Ba=t=>({facetId:G,selection:typeof t.start=="string"?new E({values:Qa}):new E({values:La})});var jP={start:P,end:P,endInclusive:new $({required:!0}),state:P},UP={facetId:G,field:P,currentValues:new H({required:!1,each:new E({values:jP})}),generateAutomaticRanges:new $({required:!0}),filterFacetCount:new $({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new ue({required:!1}),rangeAlgorithm:new ue({required:!1})};function yS(t){return _t(t)?Fi(t):t}function Oc(t){!t.currentValues||t.currentValues.forEach(e=>{let{start:r,end:a}=Zr(e);if(Fa(yS(r)).isAfter(Fa(yS(a))))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)})}var ar=h("dateFacet/register",t=>{try{return nt(t,UP),Oc(t),{payload:t,error:null}}catch(e){return{payload:t,error:yr(e)}}}),nr=h("dateFacet/toggleSelectValue",t=>y(t,{facetId:G,selection:new E({values:Qa})})),ea=h("dateFacet/toggleExcludeValue",t=>y(t,{facetId:G,selection:new E({values:Qa})})),br=h("dateFacet/updateFacetValues",t=>{try{return nt(t,{facetId:G,values:new H({each:new E({values:Qa})})}),Oc({currentValues:t.values}),{payload:t,error:null}}catch(e){return{payload:t,error:yr(e)}}}),qc=co,Tc=me;var _P={state:P,start:new I({required:!0}),end:new I({required:!0}),endInclusive:new $({required:!0})},$P={facetId:G,field:P,currentValues:new H({required:!1,each:new E({values:_P})}),generateAutomaticRanges:new $({required:!0}),filterFacetCount:new $({required:!1}),injectionDepth:new I({required:!1,min:0}),numberOfValues:new I({required:!1,min:1}),sortCriteria:new ue({required:!1}),rangeAlgorithm:new ue({required:!1})};function Dc(t){!t.currentValues||t.currentValues.forEach(({start:e,end:r})=>{if(e>r)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${r}`)})}var or=h("numericFacet/register",t=>{try{return y(t,$P),Dc(t),{payload:t,error:null}}catch(e){return{payload:t,error:yr(e)}}}),ir=h("numericFacet/toggleSelectValue",t=>y(t,{facetId:G,selection:new E({values:La})})),ta=h("numericFacet/toggleExcludeValue",t=>y(t,{facetId:G,selection:new E({values:La})})),Rr=h("numericFacet/updateFacetValues",t=>{try{return nt(t,{facetId:G,values:new H({each:new E({values:La})})}),Dc({currentValues:t.values}),{payload:t,error:null}}catch(e){return{payload:t,error:yr(e)}}}),Vc=co,Nc=me;var Oe=O(Ws(),t=>{t.addCase(re,(e,r)=>({...e,...r.payload})).addCase(R.fulfilled,e=>{e.freezeFacetOrder=!1}).addCase(R.rejected,e=>{e.freezeFacetOrder=!1}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.facetOptions)!=null?n:e}).addCase(Ht,(e,r)=>{e.facets[r.payload.facetId]=Nn()}).addCase(tr,(e,r)=>{e.facets[r.payload.facetId]=Nn()}).addCase(ar,(e,r)=>{e.facets[r.payload.facetId]=Nn()}).addCase(or,(e,r)=>{e.facets[r.payload.facetId]=Nn()}).addCase($e,(e,r)=>{e.facets[r.payload].enabled=!0}).addCase(xe,(e,r)=>{e.facets[r.payload].enabled=!1}).addCase(se,(e,r)=>{var a,n,o,i,s;[...Object.keys((a=r.payload.f)!=null?a:{}),...Object.keys((n=r.payload.fExcluded)!=null?n:{}),...Object.keys((o=r.payload.cf)!=null?o:{}),...Object.keys((i=r.payload.nf)!=null?i:{}),...Object.keys((s=r.payload.df)!=null?s:{})].forEach(c=>{c in e||(e.facets[c]=Nn()),e.facets[c].enabled=!0})})});function CS(t,e){let{field:r,state:a}=t;if(!WP(t))return r;let n=`${r}_`,o=HP(n,a);return GP(r,e),`${n}${o}`}function WP(t){let{field:e,state:r}=t;return xS(r).some(n=>n&&e in n)}function HP(t,e){let a=xS(e).map(n=>Object.keys(n||{})).reduce((n,o)=>n.concat(o),[]);return zP(a,t)+1}function xS(t){let{facetSet:e,numericFacetSet:r,dateFacetSet:a,categoryFacetSet:n}=t;return[e,r,a,n]}function zP(t,e){let r=0,n=t.map(o=>{let i=o.split(e)[1],s=parseInt(i,10);return Number.isNaN(s)?r:s}).sort().pop();return n!=null?n:r}function GP(t,e){let r=`A facet with field "${t}" already exists.
  To avoid unexpected behaviour, configure the #id option on the facet controller.`;e.warn(r)}function Be(t,e){let{state:r,logger:a}=t,{field:n,facetId:o}=e;return o||CS({field:n,state:r},a)}var vS=["alphanumeric","occurrences"];var FS=new z({field:Xt,basePath:fS,delimitingCharacter:mS,facetId:Jt,facetSearch:io,filterByBasePath:gS,filterFacetCount:Zt,injectionDepth:er,numberOfValues:wt,sortCriteria:new b({constrainTo:vS})});function bS(t,e){if(!YP(t))throw A;let r=N(t),{dispatch:a}=t,n=Be(t,e.options),o={...ki,...rs("facetSearch",e.options),field:e.options.field,facetId:n},i={facetSearch:{...Gt,...e.options.facetSearch},...o};de(t,FS,i,"buildCategoryFacet");let s=()=>Zl(t.state,n),c=()=>Xl(t.state,n),u=()=>Dt(t.state),l=()=>Kt(t.state,n);return a(Ht(o)),{...r,toggleSelect(d){let f=i.numberOfValues;a(Kr({facetId:n,selection:d,retrieveCount:f})),a(re())},deselectAll(){a(zt(n)),a(re())},sortBy(d){a(eo({facetId:n,criterion:d})),a(re())},isSortedBy(d){return s().sortCriteria===d},showMoreValues(){var S;let{numberOfValues:d}=i,{activeValue:f,valuesAsTrees:p}=this.state,m=((S=f==null?void 0:f.children.length)!=null?S:p.length)+d;a(qa({facetId:n,numberOfValues:m})),a(re())},showLessValues(){let{numberOfValues:d}=i;a(qa({facetId:n,numberOfValues:d})),a(re())},enable(){a($e(n))},disable(){a(xe(n))},get state(){var X,K,he,ve;let d=s(),f=c(),p=u(),m=l(),S=(X=f==null?void 0:f.values)!=null?X:[],v=(K=S.some(B=>B.children.length>0))!=null?K:!1,{parents:C,values:F}=Fm(f==null?void 0:f.values),D=Ke(S),Q=D.length?D[D.length-1]:void 0,te=!!Q,ae=(ve=(he=Q==null?void 0:Q.moreValuesAvailable)!=null?he:f==null?void 0:f.moreValuesAvailable)!=null?ve:!1,oe=Q?Q.children.length>i.numberOfValues:S.length>i.numberOfValues;return{facetId:n,parents:C,selectedValueAncestry:D,values:F,isHierarchical:v,valuesAsTrees:S,activeValue:Q,isLoading:p,hasActiveValues:te,canShowMoreValues:ae,canShowLessValues:oe,sortCriteria:d.sortCriteria,enabled:m}}}}function YP(t){return t.addReducers({categoryFacetSet:pt,categoryFacetSearchSet:ro,facetOptions:Oe,configuration:j,search:W}),!0}function uo(t,e){let r=t.dispatch,{options:a,getFacetSearch:n}=e,{facetId:o}=a;return{updateText(i){r(Jr({facetId:o,query:i,numberOfValues:n().initialNumberOfValues}))},showMoreResults(){let{initialNumberOfValues:i,options:s}=n();r(Jr({facetId:o,numberOfValues:s.numberOfValues+i})),r(e.isForFieldSuggestions?cp(o):At(o))},search(){r(e.isForFieldSuggestions?cp(o):At(o))},clear(){r(to({facetId:o}))},updateCaptions(i){r(Jr({facetId:o,captions:i}))},get state(){let{response:i,isLoading:s,options:c}=n(),{query:u}=c,l=i.values;return{...i,values:l,isLoading:s,query:u}}}}function RS(t,e){let{dispatch:r}=t,a={...Gt,...e.options},{facetId:n}=a,o=()=>t.state.categoryFacetSearchSet[n];r(Jn(a));let i=uo(t,{options:a,getFacetSearch:o,isForFieldSuggestions:e.isForFieldSuggestions});return{...i,select(s){r(Kn({facetId:n,value:s}))},get state(){return i.state}}}function Mc(t,e){let{dispatch:r}=t,a={...Gt,...e.options},{facetId:n}=a,o=()=>t.state.categoryFacetSearchSet[n],i=RS(t,{options:{...a},isForFieldSuggestions:e.isForFieldSuggestions});r(Jn(a));let s=uo(t,{options:a,getFacetSearch:o,isForFieldSuggestions:e.isForFieldSuggestions});return{...s,...i,select:c=>{i.select(c),r(re()),r(R({legacy:be({facetId:n,facetValue:c.rawValue}),next:{actionCause:T.facetSelect,getEventExtraPayload:u=>new L(()=>u).getFacetMetadata(n,c.rawValue)}}))},get state(){return{...s.state,...i.state}}}}function AS(t,e){if(!KP(t))throw A;let r=bS(t,e),{dispatch:a}=t,n=()=>r.state.facetId,o=Mc(t,{options:{facetId:n(),...e.options.facetSearch},isForFieldSuggestions:!1}),{state:i,...s}=o;return{...r,facetSearch:s,toggleSelect(c){r.toggleSelect(c),a(R({legacy:JP(n(),c),next:XP(n(),c)}))},deselectAll(){r.deselectAll(),a(R({legacy:ke(n()),next:{actionCause:T.facetClearAll,getEventExtraPayload:c=>new L(()=>c).getFacetClearAllMetadata(n())}}))},sortBy(c){r.sortBy(c),a(R({legacy:Yt({facetId:n(),criterion:c}),next:{actionCause:T.facetUpdateSort,getEventExtraPayload:u=>new L(()=>u).getFacetSortMetadata(n(),c)}}))},showMoreValues(){r.showMoreValues(),a(Wt({legacy:ao(n())}))},showLessValues(){r.showLessValues(),a(Wt({legacy:no(n())}))},get state(){return{...r.state,facetSearch:o.state}}}}function KP(t){return t.addReducers({categoryFacetSet:pt,categoryFacetSearchSet:ro,configuration:j,search:W}),!0}function JP(t,e){let r={facetId:t,facetValue:e.value};return e.state==="selected"?Ze(r):be(r)}function XP(t,e){return{actionCause:e.state==="selected"?T.facetDeselect:T.facetSelect,getEventExtraPayload:a=>new L(()=>a).getFacetMetadata(t,e.value)}}var ZP=t=>({build:e=>AS(e,t)});function PS(){return{}}var lo=O(PS(),t=>{t.addCase(wc,(e,r)=>{let a=r.payload;vc(e,a,lp)}).addCase(Jr,(e,r)=>{Fc(e,r.payload)}).addCase(At.pending,(e,r)=>{let a=r.meta.arg;bc(e,a,r.meta.requestId)}).addCase(At.rejected,(e,r)=>{let a=r.meta.arg;Rc(e,a)}).addCase(At.fulfilled,(e,r)=>{Ac(e,r.payload,r.meta.requestId)}).addCase(to,(e,{payload:r})=>{Oi(e,r,lp)}).addCase(R.fulfilled,e=>{Pc(e,lp)})});function lp(){return{moreValuesAvailable:!1,values:[]}}var Et=(r=>(r.Relevance="relevance",r.Fields="fields",r))(Et||{}),Lc=(r=>(r.Ascending="asc",r.Descending="desc",r))(Lc||{});var FH=new E({options:{required:!1},values:{by:new vt({enum:Et,required:!0}),fields:new H({each:new E({values:{name:new b,direction:new vt({enum:Lc})}})})}});var wS=()=>Ag("analytics/productListing/load",t=>t.makeInterfaceLoad(),t=>new mn(t));var QH=h("productlisting/setUrl",t=>y(t,{url:new b({required:!0,url:!0})})),BH=h("productlisting/setAdditionalFields",t=>y(t,{additionalFields:new H({required:!0,each:new b({required:!0,emptyAllowed:!1})})})),ra=J("productlisting/fetch",async(t,{getState:e,dispatch:r,rejectWithValue:a,extra:n})=>{let o=e(),{apiClient:i}=n,s=await i.getProducts(await ew(o));return ye(s)?(r(ut(s.error)),a(s.error)):{response:s.success,analyticsAction:wS()}}),ew=async t=>{var a,n,o;let e=rw(t),r=await at(t.configuration.analytics);return{accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,platformUrl:t.configuration.platformUrl,url:(a=t.productListing)==null?void 0:a.url,...t.configuration.analytics.enabled&&r?{clientId:r}:{},...((n=t.productListing.additionalFields)==null?void 0:n.length)?{additionalFields:t.productListing.additionalFields}:{},...t.productListing.advancedParameters&&tw(t.productListing.advancedParameters)?{advancedParameters:t.productListing.advancedParameters||{}}:{},...e.length&&{facets:{requests:e}},...t.pagination&&{pagination:{numberOfValues:t.pagination.numberOfResults,page:Math.ceil(t.pagination.firstResult/(t.pagination.numberOfResults||1))+1}},...(((o=t.sort)==null?void 0:o.by)||Et.Relevance)!==Et.Relevance&&{sort:t.sort},...t.context&&{userContext:t.context.contextValues}}};function tw(t){return t.debug}function rw(t){var e;return Tn(aw(t),(e=t.facetOrder)!=null?e:[])}function aw(t){var e,r,a,n;return[...Cr((e=t.facetSet)!=null?e:{}),...Cr((r=t.numericFacetSet)!=null?r:{}),...Cr((a=t.dateFacetSet)!=null?a:{}),...Cr((n=t.categoryFacetSet)!=null?n:{})]}var ft=O(sn(),t=>{t.addCase(tr,(e,r)=>{let{facetId:a}=r.payload;a in e||(e[a]=Pm(nw(r.payload)))}).addCase(ie.fulfilled,(e,r)=>{if(!!r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(se,(e,r)=>{let a=r.payload.f||{},n=r.payload.fExcluded||{};Object.keys(e).forEach(i=>{let{request:s}=e[i],c=a[i]||[],u=n[i]||[],l=s.currentValues.filter(d=>!c.includes(d.value)&&!u.includes(d.value));s.currentValues=[...c.map(ES),...u.map(IS),...l.map(iw)],s.preventAutoSelect=c.length>0,s.numberOfValues=Math.max(c.length+u.length,s.numberOfValues)})}).addCase(rr,(e,r)=>{var c;let{facetId:a,selection:n}=r.payload,o=(c=e[a])==null?void 0:c.request;if(!o)return;o.preventAutoSelect=!0;let i=o.currentValues.find(u=>u.value===n.value);if(!i){Qc(o,n);return}let s=i.state==="selected";i.state=s?"idle":"selected",o.freezeCurrentValues=!0}).addCase(Xr,(e,r)=>{var c;let{facetId:a,selection:n}=r.payload,o=(c=e[a])==null?void 0:c.request;if(!o)return;o.preventAutoSelect=!0;let i=o.currentValues.find(u=>u.value===n.value);if(!i){Qc(o,n);return}let s=i.state==="excluded";i.state=s?"idle":"excluded",o.freezeCurrentValues=!0}).addCase(Ma,(e,r)=>{var i;let{facetId:a,freezeCurrentValues:n}=r.payload,o=(i=e[a])==null?void 0:i.request;!o||(o.freezeCurrentValues=n)}).addCase(me,(e,r)=>{var a;Ii((a=e[r.payload])==null?void 0:a.request)}).addCase(Ce,e=>{Object.values(e).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>Ii(r))}).addCase(Ur,e=>{Object.values(e).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>Ii(r))}).addCase(st,(e,r)=>Object.values(e).forEach(a=>{a.request.preventAutoSelect=!r.payload.allow})).addCase(so,(e,r)=>{Xn(e,r.payload)}).addCase(Va,(e,r)=>{var o;let{facetId:a,numberOfValues:n}=r.payload;yc((o=e[a])==null?void 0:o.request,n)}).addCase(Na,(e,r)=>{var i;let{facetId:a,isFieldExpanded:n}=r.payload,o=(i=e[a])==null?void 0:i.request;!o||(o.isFieldExpanded=n)}).addCase(R.fulfilled,(e,r)=>{r.payload.response.facets.forEach(n=>{var o;return dp((o=e[n.facetId])==null?void 0:o.request,n)})}).addCase(ra.fulfilled,(e,r)=>{var n,o;(((o=(n=r.payload.response)==null?void 0:n.facets)==null?void 0:o.results)||[]).forEach(i=>{var s;return dp((s=e[i.facetId])==null?void 0:s.request,i)})}).addCase(Wt.fulfilled,(e,r)=>{r.payload.response.facets.forEach(n=>{var o;return dp((o=e[n.facetId])==null?void 0:o.request,n)})}).addCase(Ta,(e,r)=>{var l;let{facetId:a,value:n}=r.payload,o=(l=e[a])==null?void 0:l.request;if(!o)return;let{rawValue:i}=n,{currentValues:s}=o,c=s.find(d=>d.value===i);if(c){c.state="selected";return}let u=ES(i);Qc(o,u),o.freezeCurrentValues=!0,o.preventAutoSelect=!0}).addCase(qi,(e,r)=>{var l;let{facetId:a,value:n}=r.payload,o=(l=e[a])==null?void 0:l.request;if(!o)return;let{rawValue:i}=n,{currentValues:s}=o,c=s.find(d=>d.value===i);if(c){c.state="excluded";return}let u=IS(i);Qc(o,u),o.freezeCurrentValues=!0,o.preventAutoSelect=!0}).addCase(xe,(e,r)=>{if(!(r.payload in e))return;let{request:a}=e[r.payload];Ii(a)})});function Qc(t,e){let{currentValues:r}=t,a=r.findIndex(s=>s.state==="idle"),n=a===-1?r.length:a,o=r.slice(0,n),i=r.slice(n+1);t.currentValues=[...o,e,...i],t.numberOfValues=t.currentValues.length}function dp(t,e){!t||(t.currentValues=e.values.map(ow),t.freezeCurrentValues=!1,t.preventAutoSelect=!1)}var Ti={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function nw(t){return{...Ti,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...t}}function ow(t){let{value:e,state:r}=t;return{value:e,state:r}}function ES(t){return{value:t,state:"selected"}}function IS(t){return{value:t,state:"excluded"}}function iw(t){return{...t,state:"idle"}}var Bc=t=>t.state==="selected",jc=t=>t.state==="excluded",Uc=(t,e)=>{let r={facetId:t,facetValue:e.value};return Bc(e)?Ze(r):be(r)},_c=(t,e)=>({actionCause:Bc(e)?T.facetDeselect:T.facetSelect,getEventExtraPayload:r=>new L(()=>r).getFacetMetadata(t,e.value)}),kS=(t,e)=>{let r={facetId:t,facetValue:e.value};return jc(e)?Ze(r):Pt(r)},OS=(t,e)=>({actionCause:jc(e)?T.facetUnexclude:T.facetExclude,getEventExtraPayload:r=>new L(()=>r).getFacetMetadata(t,e.value)});function $c(t,e){let{dispatch:r}=t,{options:a,select:n,exclude:o,isForFieldSuggestions:i}=e,{facetId:s}=a,c=()=>t.state.facetSearchSet[s];r(wc(a));let u=uo(t,{options:a,getFacetSearch:c,isForFieldSuggestions:i});return{...u,select(l){r(Ta({facetId:s,value:l})),n(l)},exclude(l){r(qi({facetId:s,value:l})),o(l)},singleSelect(l){r(me(s)),r(Ta({facetId:s,value:l})),n(l)},singleExclude(l){r(me(s)),r(qi({facetId:s,value:l})),o(l)},get state(){let{values:l}=u.state;return{...u.state,values:l.map(({count:d,displayValue:f,rawValue:p})=>({count:d,displayValue:f,rawValue:p}))}}}}var qS={facetId:G,selection:new E({values:Da})},TS=J("facet/executeToggleSelect",({facetId:t,selection:e},r)=>{let{dispatch:a,extra:{validatePayload:n}}=r;n({facetId:t,selection:e},qS),a(rr({facetId:t,selection:e})),a(re())}),DS=J("facet/executeToggleExclude",({facetId:t,selection:e},r)=>{let{dispatch:a,extra:{validatePayload:n}}=r;n({facetId:t,selection:e},qS),a(Xr({facetId:t,selection:e})),a(re())});var po=["allValues","atLeastOneValue"];var Wc=["score","alphanumeric","alphanumericDescending","occurrences","automatic"];var VS=new z({facetId:Jt,field:Xt,filterFacetCount:Zt,injectionDepth:er,numberOfValues:wt,sortCriteria:new b({constrainTo:Wc}),resultsMustMatch:new b({constrainTo:po}),facetSearch:io});function NS(t,e,r=VS){if(!sw(t))throw A;let{dispatch:a}=t,n=N(t),o=Be(t,e.options),i={...Ti,...rs("facetSearch",e.options),field:e.options.field,facetId:o},s={facetSearch:{...Gt,...e.options.facetSearch},...i};de(t,r,s,"buildFacet");let c=()=>Jl(t.state,o),u=()=>ci(t.state,o),l=()=>Dt(t.state),d=()=>Kt(t.state,o),f=()=>{let{currentValues:m}=c();return m.filter(S=>S.state!=="idle").length},p=()=>{let{currentValues:m}=c(),S=s.numberOfValues,v=!!m.find(C=>C.state==="idle");return S<m.length&&v};return a(tr(i)),{...n,toggleSelect:m=>a(TS({facetId:s.facetId,selection:m})),toggleExclude:m=>a(DS({facetId:s.facetId,selection:m})),toggleSingleSelect:function(m){m.state==="idle"&&a(me(o)),this.toggleSelect(m)},toggleSingleExclude:function(m){m.state==="idle"&&a(me(o)),this.toggleExclude(m)},isValueSelected:Bc,isValueExcluded:jc,deselectAll(){a(me(o)),a(re())},sortBy(m){a(so({facetId:o,criterion:m})),a(re())},isSortedBy(m){return this.state.sortCriterion===m},showMoreValues(){let m=c().numberOfValues,S=s.numberOfValues,v=S-m%S,C=m+v;a(Va({facetId:o,numberOfValues:C})),a(Na({facetId:o,isFieldExpanded:!0})),a(re())},showLessValues(){let m=s.numberOfValues,S=Math.max(m,f());a(Va({facetId:o,numberOfValues:S})),a(Na({facetId:o,isFieldExpanded:!1})),a(re())},enable(){a($e(o))},disable(){a(xe(o))},get state(){let m=c(),S=u(),v=l(),C=d(),F;typeof m.sortCriteria=="object"?F=m.sortCriteria.order==="descending"?"alphanumericDescending":"alphanumeric":F=m.sortCriteria;let D=S?S.values:[],Q=D.some(oe=>oe.state!=="idle"),te=S?S.moreValuesAvailable:!1,ae=m.resultsMustMatch;return{facetId:o,values:D,sortCriterion:F,resultsMustMatch:ae,isLoading:v,hasActiveValues:Q,canShowMoreValues:te,canShowLessValues:p(),enabled:C}}}}function sw(t){return t.addReducers({facetSet:ft,facetOptions:Oe,configuration:j,facetSearchSet:lo}),!0}var MS=new z({facetId:Jt,field:Xt,filterFacetCount:Zt,injectionDepth:er,numberOfValues:wt,sortCriteria:new b({constrainTo:Wc}),resultsMustMatch:new b({constrainTo:po}),facetSearch:io,allowedValues:Ic,hasBreadcrumbs:hS,customSort:kc});function LS(t,e){if(!cw(t))throw A;let{dispatch:r}=t,a=NS(t,{...e,options:{...e.options,...e.options.allowedValues&&{allowedValues:{type:"simple",values:e.options.allowedValues}}}},MS),n=()=>a.state.facetId,i=(()=>{let{facetSearch:u}=e.options;return $c(t,{options:{facetId:n(),...u},select:l=>{r(re()),r(R({legacy:be({facetId:n(),facetValue:l.rawValue}),next:{actionCause:T.facetSelect,getEventExtraPayload:d=>new L(()=>d).getFacetMetadata(n(),l.rawValue)}}))},exclude:l=>{r(re()),r(R({legacy:Pt({facetId:n(),facetValue:l.rawValue}),next:{actionCause:T.facetExclude,getEventExtraPayload:d=>new L(()=>d).getFacetMetadata(n(),l.rawValue)}}))},isForFieldSuggestions:!1})})(),{state:s,...c}=i;return{...a,facetSearch:c,toggleSelect(u){a.toggleSelect(u),r(R({legacy:Uc(n(),u),next:_c(n(),u)}))},toggleExclude(u){a.toggleExclude(u),r(R({legacy:kS(n(),u),next:OS(n(),u)}))},deselectAll(){a.deselectAll(),r(R({legacy:ke(n()),next:{actionCause:T.facetClearAll,getEventExtraPayload:u=>new L(()=>u).getFacetClearAllMetadata(n())}}))},sortBy(u){a.sortBy(u),r(R({legacy:Yt({facetId:n(),criterion:u}),next:{actionCause:T.facetUpdateSort,getEventExtraPayload:l=>new L(()=>l).getFacetSortMetadata(n(),u)}}))},isSortedBy(u){return this.state.sortCriterion===u},showMoreValues(){a.showMoreValues(),r(Wt({legacy:ao(n())}))},showLessValues(){a.showLessValues(),r(Wt({legacy:no(n())}))},get state(){return{...a.state,facetSearch:i.state}}}}function cw(t){return t.addReducers({facetSet:ft,configuration:j,facetSearchSet:lo,search:W}),!0}var uw=t=>({build:e=>LS(e,t)});var Hc=t=>t.state==="selected",pp=t=>t.state==="excluded",zc=(t,e)=>{let r=`${e.start}..${e.end}`,a={facetId:t,facetValue:r};return Hc(e)?Ze(a):be(a)},Gc=(t,e)=>({actionCause:Hc(e)?T.facetSelect:T.facetDeselect,getEventExtraPayload:r=>new L(()=>r).getFacetMetadata(t,`${e.start}..${e.end}`)}),QS=(t,e)=>{let r=`${e.start}..${e.end}`,a={facetId:t,facetValue:r};return pp(e)?Ze(a):Pt(a)};var Yc=h("rangeFacet/executeToggleSelect",t=>y(t,Ba(t.selection))),Kc=h("rangeFacet/executeToggleExclude",t=>y(t,Ba(t.selection)));var BS={facetId:G,selection:new E({values:Qa})},jS=J("dateFacet/executeToggleSelect",(t,{dispatch:e,extra:{validatePayload:r}})=>{r(t,BS),e(nr(t)),e(Yc(t)),e(re())}),US=J("dateFacet/executeToggleExclude",(t,{dispatch:e,extra:{validatePayload:r}})=>{r(t,BS),e(ea(t)),e(Kc(t)),e(re())});var Jc={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function Xc(t,e){let{request:r}=e,{facetId:a}=r;if(a in t)return;let n=_S(r);r.numberOfValues=n,t[a]=e}function Zc(t,e,r){var n;let a=(n=t[e])==null?void 0:n.request;!a||(a.currentValues=r,a.numberOfValues=_S(a))}function eu(t,e,r){var i;let a=(i=t[e])==null?void 0:i.request;if(!a)return;let n=au(a.currentValues,r);if(!n)return;let o=n.state==="selected";n.state=o?"idle":"selected",a.preventAutoSelect=!0}function tu(t,e,r){var i;let a=(i=t[e])==null?void 0:i.request;if(!a)return;let n=au(a.currentValues,r);if(!n)return;let o=n.state==="excluded";n.state=o?"idle":"excluded",a.preventAutoSelect=!0}function aa(t,e){var a;let r=(a=t[e])==null?void 0:a.request;!r||r.currentValues.forEach(n=>n.state="idle")}function ru(t,e){Object.entries(t).forEach(([r,{request:a}])=>{let n=e[r]||[];a.currentValues.forEach(s=>{let c=!!au(n,s);return s.state=c?"selected":"idle",s});let o=n.filter(s=>!au(a.currentValues,s)),i=a.currentValues;i.push(...o),a.numberOfValues=Math.max(a.numberOfValues,i.length)})}function fo(t,e,r){e.forEach(a=>{var s;let n=a.facetId,o=(s=t[n])==null?void 0:s.request;if(!o)return;let i=r(a.values);o.currentValues=i,o.preventAutoSelect=!1})}function au(t,e){let{start:r,end:a}=e;return t.find(n=>n.start===r&&n.end===a)}function _S(t){let{generateAutomaticRanges:e,currentValues:r,numberOfValues:a}=t;return e?Math.max(a,r.length):r.length}var mt=O(nn(),t=>{t.addCase(ar,(e,r)=>{let{payload:a}=r,n=lw(a);Xc(e,Rm(n))}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.dateFacetSet)!=null?n:e}).addCase(se,(e,r)=>{let a=r.payload.df||{};ru(e,a)}).addCase(nr,(e,r)=>{let{facetId:a,selection:n}=r.payload;eu(e,a,n)}).addCase(ea,(e,r)=>{let{facetId:a,selection:n}=r.payload;tu(e,a,n)}).addCase(br,(e,r)=>{let{facetId:a,values:n}=r.payload;Zc(e,a,n)}).addCase(Tc,(e,r)=>{aa(e,r.payload)}).addCase(Ce,e=>{Object.keys(e).forEach(r=>{aa(e,r)})}).addCase(qc,(e,r)=>{Xn(e,r.payload)}).addCase(R.fulfilled,(e,r)=>{let a=r.payload.response.facets;fo(e,a,$S)}).addCase(ra.fulfilled,(e,r)=>{var n,o;let a=((o=(n=r.payload.response)==null?void 0:n.facets)==null?void 0:o.results)||[];fo(e,a,$S)}).addCase(xe,(e,r)=>{aa(e,r.payload)})});function lw(t){return{...Jc,currentValues:[],preventAutoSelect:!1,type:"dateRange",...t}}function $S(t){return t.map(e=>{let{numberOfResults:r,...a}=e;return a})}function nu(t,e){let{facetId:r,getRequest:a}=e,n=N(t),o=t.dispatch,i=()=>Kt(t.state,r);return{...n,isValueSelected:Hc,isValueExcluded:pp,deselectAll(){o(me(r)),o(re())},sortBy(s){o(co({facetId:r,criterion:s})),o(re())},isSortedBy(s){return this.state.sortCriterion===s},enable(){o($e(r))},disable(){o(xe(r))},get state(){let s=a(),c=Tt(t.state,r),u=s.sortCriteria,l=s.resultsMustMatch,d=c?c.values:[],f=Dt(t.state),p=i(),m=d.some(S=>S.state!=="idle");return{facetId:r,values:d,sortCriterion:u,resultsMustMatch:l,hasActiveValues:m,isLoading:f,enabled:p}}}}function ou(t,e){if(!t.generateAutomaticRanges&&t.currentValues===void 0){let r=`currentValues should be specified for ${e} when generateAutomaticRanges is false.`;throw new Error(r)}}var iu=["idle","selected","excluded"];var su=["ascending","descending"],cu=["even","equiprobable"];var dw={start:new b,end:new b,endInclusive:new $,state:new b({constrainTo:iu})},pw=new z({facetId:Jt,field:Xt,generateAutomaticRanges:Ec,filterFacetCount:Zt,injectionDepth:er,numberOfValues:wt,currentValues:new H({each:new E({values:dw})}),sortCriteria:new b({constrainTo:su}),rangeAlgorithm:new b({constrainTo:cu})});function uu(t,e){de(t,pw,e,"buildDateFacet"),Oc(e)}function WS(t,e){if(!fw(t))throw A;ou(e.options,"buildDateFacet");let r=t.dispatch,a=Be(t,e.options),n={currentValues:[],...e.options,facetId:a};uu(t,n),r(ar(n));let o=nu(t,{facetId:a,getRequest:()=>t.state.dateFacetSet[a].request});return{...o,toggleSelect:i=>r(jS({facetId:a,selection:i})),toggleSingleSelect:function(i){i.state==="idle"&&r(me(a)),this.toggleSelect(i)},toggleExclude:i=>r(US({facetId:a,selection:i})),toggleSingleExclude:function(i){i.state==="idle"&&r(me(a)),this.toggleExclude(i)},get state(){return o.state}}}function fw(t){return t.addReducers({configuration:j,search:W,dateFacetSet:mt,facetOptions:Oe}),!0}function HS(t,e){let r=WS(t,e),a=t.dispatch,n=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),a(R({legacy:ke(n()),next:{actionCause:T.facetClearAll,getEventExtraPayload:o=>new L(()=>o).getFacetClearAllMetadata(n())}}))},sortBy(o){r.sortBy(o),a(R({legacy:Yt({facetId:n(),criterion:o}),next:{actionCause:T.facetUpdateSort,getEventExtraPayload:i=>new L(()=>i).getFacetSortMetadata(n(),o)}}))},toggleSelect:o=>{r.toggleSelect(o),a(R({legacy:zc(n(),o),next:Gc(n(),o)}))},toggleExclude:o=>{r.toggleExclude(o),a(R({legacy:QS(n(),o)}))},get state(){return r.state}}}var mw=t=>({build:e=>HS(e,t)});var We=O(on(),t=>{t.addCase(or,(e,r)=>{let{payload:a}=r,n=gw(a);Xc(e,Am(n))}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.numericFacetSet)!=null?n:e}).addCase(se,(e,r)=>{let a=r.payload.nf||{};ru(e,a)}).addCase(ir,(e,r)=>{let{facetId:a,selection:n}=r.payload;eu(e,a,n)}).addCase(ta,(e,r)=>{let{facetId:a,selection:n}=r.payload;tu(e,a,n)}).addCase(Rr,(e,r)=>{let{facetId:a,values:n}=r.payload;Zc(e,a,n)}).addCase(Nc,(e,r)=>{aa(e,r.payload)}).addCase(Ce,e=>{Object.keys(e).forEach(r=>{aa(e,r)})}).addCase(Vc,(e,r)=>{Xn(e,r.payload)}).addCase(R.fulfilled,(e,r)=>{let a=r.payload.response.facets;fo(e,a,zS)}).addCase(ra.fulfilled,(e,r)=>{var n,o;let a=((o=(n=r.payload.response)==null?void 0:n.facets)==null?void 0:o.results)||[];fo(e,a,zS)}).addCase(xe,(e,r)=>{aa(e,r.payload)})});function gw(t){return{...Jc,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...t}}function zS(t){return t.map(e=>{let{numberOfResults:r,...a}=e;return a})}var GS={facetId:G,selection:new E({values:La})},YS=J("numericFacet/executeToggleSelect",(t,{dispatch:e,extra:{validatePayload:r}})=>{r(t,GS),e(ir(t)),e(Yc(t)),e(re())}),IY=J("numericFacet/executeToggleExclude",(t,{dispatch:e,extra:{validatePayload:r}})=>{r(t,GS),e(ta(t)),e(Kc(t)),e(re())});var hw={start:new I,end:new I,endInclusive:new $,state:new b({constrainTo:iu})},Sw=new z({facetId:Jt,field:Xt,generateAutomaticRanges:Ec,filterFacetCount:Zt,injectionDepth:er,numberOfValues:wt,currentValues:new H({each:new E({values:hw})}),sortCriteria:new b({constrainTo:su}),resultsMustMatch:new b({constrainTo:po}),rangeAlgorithm:new b({constrainTo:cu})});function lu(t,e){de(t,Sw,e,"buildNumericFacet"),Dc(e)}function mo(t){return{endInclusive:!1,state:"idle",...t}}function KS(t,e){if(!yw(t))throw A;ou(e.options,"buildNumericFacet");let r=t.dispatch,a=Be(t,e.options),n={currentValues:[],...e.options,facetId:a};lu(t,n),r(or(n));let o=nu(t,{facetId:a,getRequest:()=>t.state.numericFacetSet[a].request});return{...o,toggleSelect:i=>r(YS({facetId:a,selection:i})),toggleSingleSelect(i){i.state==="idle"&&r(me(a)),this.toggleSelect(i)},get state(){return o.state}}}function yw(t){return t.addReducers({numericFacetSet:We,facetOptions:Oe,configuration:j,search:W}),!0}function JS(t,e){if(!Cw(t))throw A;let r=KS(t,e),a=t.dispatch,n=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),a(R({legacy:ke(n()),next:{actionCause:T.facetClearAll,getEventExtraPayload:o=>new L(()=>o).getFacetClearAllMetadata(n())}}))},sortBy(o){r.sortBy(o),a(R({legacy:Yt({facetId:n(),criterion:o}),next:{actionCause:T.facetUpdateSort,getEventExtraPayload:i=>new L(()=>i).getFacetSortMetadata(n(),o)}}))},toggleSelect:o=>{r.toggleSelect(o),a(R({legacy:zc(n(),o),next:Gc(n(),o)}))},get state(){return{...r.state}}}}function Cw(t){return t.addReducers({numericFacetSet:We,configuration:j,search:W}),!0}var xw=t=>({build:e=>JS(e,t)});function vw(t,e){return!!e&&e.facetId in t.numericFacetSet}var XS=(t,e)=>{let r=Tt(t,e);if(vw(t,r))return r},ZS=(t,e)=>(XS(t,e)||{values:[]}).values.filter(a=>a.state!=="idle"),ey=(t,e)=>(XS(t,e)||{values:[]}).values.filter(a=>a.state==="selected");function ty(t,e){var c;if(!Fw(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o=Be(t,e.options),i={...e.options,currentValues:((c=e.initialState)==null?void 0:c.range)?[{...e.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:o};lu(t,i),a(or(i));let s=()=>Kt(t.state,o);return{...r,clear:()=>{a(Rr({facetId:o,values:[]})),a(re())},setRange:u=>{let l={...u,state:"selected",numberOfResults:0,endInclusive:!0},d=Rr({facetId:o,values:[l]});return d.error?!1:(a(d),a(re()),!0)},enable(){a($e(o))},disable(){a(xe(o))},get state(){let u=Dt(n()),l=s(),d=ey(n(),o),f=d.length?d[0]:void 0;return{facetId:o,isLoading:u,range:f,enabled:l}}}}function Fw(t){return t.addReducers({numericFacetSet:We,facetOptions:Oe,configuration:j,search:W}),!0}function ry(t,e){if(!bw(t))throw A;let r=ty(t,e),{dispatch:a}=t,n=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),a(R({legacy:ke(n()),next:{actionCause:T.facetClearAll,getEventExtraPayload:o=>new L(()=>o).getFacetClearAllMetadata(n())}}))},setRange:o=>{let i=r.setRange(o);return i&&a(R({legacy:be({facetId:n(),facetValue:`${o.start}..${o.end}`}),next:{actionCause:T.facetSelect,getEventExtraPayload:s=>new L(()=>s).getFacetMetadata(n(),`${o.start}..${o.end}`)}})),i},get state(){return{...r.state}}}}function bw(t){return t.addReducers({numericFacetSet:We,configuration:j,search:W}),!0}var Rw=t=>({build:e=>ry(e,t)});function Aw(t,e){return!!e&&e.facetId in t.dateFacetSet}var ay=(t,e)=>{let r=Tt(t,e);if(Aw(t,r))return r},ny=(t,e)=>(ay(t,e)||{values:[]}).values.filter(a=>a.state==="selected"),oy=(t,e)=>(ay(t,e)||{values:[]}).values.filter(a=>a.state!=="idle");function iy(t,e){var c;if(!Pw(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o=Be(t,e.options),i={...e.options,currentValues:((c=e.initialState)==null?void 0:c.range)?[{...e.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:o};uu(t,i),a(ar(i));let s=()=>Kt(t.state,o);return{...r,clear:()=>{a(br({facetId:o,values:[]})),a(re())},setRange:u=>{let l={...u,state:"selected",numberOfResults:0,endInclusive:!0},d=br({facetId:o,values:[l]});return d.error?!1:(a(d),a(re()),!0)},enable(){a($e(o))},disable(){a(xe(o))},get state(){let u=Dt(n()),l=s(),d=ny(n(),o),f=d.length?d[0]:void 0;return{facetId:o,isLoading:u,range:f,enabled:l}}}}function Pw(t){return t.addReducers({dateFacetSet:mt,facetOptions:Oe,configuration:j,search:W}),!0}function sy(t,e){if(!ww(t))throw A;let r=iy(t,e),{dispatch:a}=t,n=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),a(R({legacy:ke(n()),next:{actionCause:T.facetClearAll,getEventExtraPayload:o=>new L(()=>o).getFacetClearAllMetadata(n())}}))},setRange:o=>{let i=r.setRange(o);return i&&a(R({legacy:be({facetId:n(),facetValue:`${o.start}..${o.end}`}),next:{actionCause:T.facetSelect,getEventExtraPayload:s=>new L(()=>s).getFacetMetadata(n(),`${o.start}..${o.end}`)}})),i},get state(){return{...r.state}}}}function ww(t){return t.addReducers({dateFacetSet:mt,configuration:j,search:W}),!0}var Ew=t=>({build:e=>sy(e,t)});var n4=new E({options:{required:!1},values:{by:new vt({enum:Et,required:!0}),fields:new H({each:new E({values:{field:new b({required:!0}),direction:new vt({enum:Lc}),displayName:new b}})})}});var cy=t=>{let e=Iw(t),{view:r,user:a,...n}=t.commerceContext;return{accessToken:t.configuration.accessToken,url:t.configuration.platformUrl,organizationId:t.configuration.organizationId,...n,context:{user:a,view:r,cart:t.cart.cartItems.map(o=>t.cart.cart[o])},facets:e,...t.commercePagination&&{page:t.commercePagination.page},...t.commerceSort&&{sort:kw(t.commerceSort.appliedSort)}}};function Iw(t){return!t.facetOrder||!t.commerceFacetSet?[]:t.facetOrder.map(e=>t.commerceFacetSet[e].request).filter(e=>e.values.length>0)}function kw(t){if(!!t)return t.by===Et.Relevance?{sortCriteria:Et.Relevance}:{sortCriteria:Et.Fields,fields:t.fields.map(({name:e,direction:r})=>({field:e,direction:r}))}}var uy=()=>Rg("analytics/commerce/productListing/load",t=>t.makeInterfaceLoad(),t=>new fn(t));var ly=J("commerce/productListing/fetch",async(t,{getState:e,dispatch:r,rejectWithValue:a,extra:n})=>{let o=e(),{apiClient:i}=n,s=await i.getProductListing(cy(o));return ye(s)?(r(ut(s.error)),a(s.error)):{response:s.success,analyticsAction:uy()}});var du=O(Hs(),t=>{t.addCase(R.fulfilled,(e,r)=>r.payload.response.facets.map(a=>a.facetId)).addCase(ly.fulfilled,(e,r)=>{let a=n=>{var o;return(o=n.facetId)!=null?o:n.field};return r.payload.response.facets.map(a)}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.facetOrder)!=null?n:e})});var pu=()=>w("history/analytics/forward",t=>t.makeSearchEvent("historyForward")),fu=()=>w("history/analytics/backward",t=>t.makeSearchEvent("historyBackward")),mu=()=>w("history/analytics/noresultsback",t=>t.makeNoResultsBack());var dy=t=>({past:[],present:t,future:[]}),Ow=t=>{let{past:e,present:r,future:a}=t;if(!r||e.length===0)return t;let n=e[e.length-1];return{past:e.slice(0,e.length-1),present:n,future:[r,...a]}},qw=t=>{let{past:e,present:r,future:a}=t;if(!r||a.length===0)return t;let n=a[0],o=a.slice(1);return{past:[...e,r],present:n,future:o}},Tw=t=>{let{action:e,state:r,reducer:a}=t,{past:n,present:o}=r,i=a(o,e);return o?o===i?r:{past:[...n,o],present:i,future:[]}:dy(i)},py=t=>{let{actionTypes:e,reducer:r}=t,a=dy();return(n=a,o)=>{switch(o.type){case e.undo:return Ow(n);case e.redo:return qw(n);case e.snapshot:return Tw({state:n,reducer:r,action:o});default:return n}}};var Dw=Object.getOwnPropertyNames,Vw=Object.getOwnPropertySymbols,Nw=Object.prototype.hasOwnProperty;function fy(t,e){return function(a,n,o){return t(a,n,o)&&e(a,n,o)}}function gu(t){return function(r,a,n){if(!r||!a||typeof r!="object"||typeof a!="object")return t(r,a,n);var o=n.cache,i=o.get(r),s=o.get(a);if(i&&s)return i===a&&s===r;o.set(r,a),o.set(a,r);var c=t(r,a,n);return o.delete(r),o.delete(a),c}}function my(t){return Dw(t).concat(Vw(t))}var gy=Object.hasOwn||function(t,e){return Nw.call(t,e)};function go(t,e){return t||e?t===e:t===e||t!==t&&e!==e}var hy="_owner",Sy=Object.getOwnPropertyDescriptor,yy=Object.keys;function Mw(t,e,r){var a=t.length;if(e.length!==a)return!1;for(;a-- >0;)if(!r.equals(t[a],e[a],a,a,t,e,r))return!1;return!0}function Lw(t,e){return go(t.getTime(),e.getTime())}function Cy(t,e,r){if(t.size!==e.size)return!1;for(var a={},n=t.entries(),o=0,i,s;(i=n.next())&&!i.done;){for(var c=e.entries(),u=!1,l=0;(s=c.next())&&!s.done;){var d=i.value,f=d[0],p=d[1],m=s.value,S=m[0],v=m[1];!u&&!a[l]&&(u=r.equals(f,S,o,l,t,e,r)&&r.equals(p,v,f,S,t,e,r))&&(a[l]=!0),l++}if(!u)return!1;o++}return!0}function Qw(t,e,r){var a=yy(t),n=a.length;if(yy(e).length!==n)return!1;for(var o;n-- >0;)if(o=a[n],o===hy&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof||!gy(e,o)||!r.equals(t[o],e[o],o,o,t,e,r))return!1;return!0}function Di(t,e,r){var a=my(t),n=a.length;if(my(e).length!==n)return!1;for(var o,i,s;n-- >0;)if(o=a[n],o===hy&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof||!gy(e,o)||!r.equals(t[o],e[o],o,o,t,e,r)||(i=Sy(t,o),s=Sy(e,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function Bw(t,e){return go(t.valueOf(),e.valueOf())}function jw(t,e){return t.source===e.source&&t.flags===e.flags}function xy(t,e,r){if(t.size!==e.size)return!1;for(var a={},n=t.values(),o,i;(o=n.next())&&!o.done;){for(var s=e.values(),c=!1,u=0;(i=s.next())&&!i.done;)!c&&!a[u]&&(c=r.equals(o.value,i.value,o.value,i.value,t,e,r))&&(a[u]=!0),u++;if(!c)return!1}return!0}function Uw(t,e){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}var _w="[object Arguments]",$w="[object Boolean]",Ww="[object Date]",Hw="[object Map]",zw="[object Number]",Gw="[object Object]",Yw="[object RegExp]",Kw="[object Set]",Jw="[object String]",Xw=Array.isArray,vy=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Fy=Object.assign,Zw=Object.prototype.toString.call.bind(Object.prototype.toString);function eE(t){var e=t.areArraysEqual,r=t.areDatesEqual,a=t.areMapsEqual,n=t.areObjectsEqual,o=t.arePrimitiveWrappersEqual,i=t.areRegExpsEqual,s=t.areSetsEqual,c=t.areTypedArraysEqual;return function(l,d,f){if(l===d)return!0;if(l==null||d==null||typeof l!="object"||typeof d!="object")return l!==l&&d!==d;var p=l.constructor;if(p!==d.constructor)return!1;if(p===Object)return n(l,d,f);if(Xw(l))return e(l,d,f);if(vy!=null&&vy(l))return c(l,d,f);if(p===Date)return r(l,d,f);if(p===RegExp)return i(l,d,f);if(p===Map)return a(l,d,f);if(p===Set)return s(l,d,f);var m=Zw(l);return m===Ww?r(l,d,f):m===Yw?i(l,d,f):m===Hw?a(l,d,f):m===Kw?s(l,d,f):m===Gw?typeof l.then!="function"&&typeof d.then!="function"&&n(l,d,f):m===_w?n(l,d,f):m===$w||m===zw||m===Jw?o(l,d,f):!1}}function tE(t){var e=t.circular,r=t.createCustomConfig,a=t.strict,n={areArraysEqual:a?Di:Mw,areDatesEqual:Lw,areMapsEqual:a?fy(Cy,Di):Cy,areObjectsEqual:a?Di:Qw,arePrimitiveWrappersEqual:Bw,areRegExpsEqual:jw,areSetsEqual:a?fy(xy,Di):xy,areTypedArraysEqual:a?Di:Uw};if(r&&(n=Fy({},n,r(n))),e){var o=gu(n.areArraysEqual),i=gu(n.areMapsEqual),s=gu(n.areObjectsEqual),c=gu(n.areSetsEqual);n=Fy({},n,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return n}function rE(t){return function(e,r,a,n,o,i,s){return t(e,r,s)}}function aE(t){var e=t.circular,r=t.comparator,a=t.createState,n=t.equals,o=t.strict;if(a)return function(c,u){var l=a(),d=l.cache,f=d===void 0?e?new WeakMap:void 0:d,p=l.meta;return r(c,u,{cache:f,equals:n,meta:p,strict:o})};if(e)return function(c,u){return r(c,u,{cache:new WeakMap,equals:n,meta:void 0,strict:o})};var i={cache:void 0,equals:n,meta:void 0,strict:o};return function(c,u){return r(c,u,i)}}var q4=sr(),T4=sr({strict:!0}),D4=sr({circular:!0}),V4=sr({circular:!0,strict:!0}),N4=sr({createInternalComparator:function(){return go}}),M4=sr({strict:!0,createInternalComparator:function(){return go}}),L4=sr({circular:!0,createInternalComparator:function(){return go}}),Q4=sr({circular:!0,createInternalComparator:function(){return go},strict:!0});function sr(t){t===void 0&&(t={});var e=t.circular,r=e===void 0?!1:e,a=t.createInternalComparator,n=t.createState,o=t.strict,i=o===void 0?!1:o,s=tE(t),c=eE(s),u=a?a(c):rE(c);return aE({circular:r,comparator:c,createState:n,equals:u,strict:i})}function ja(t,e,r=(a,n)=>a===n){return t.length===e.length&&t.findIndex((a,n)=>!r(e[n],a))===-1}function nE(t,e){return t.length!==e.length?!1:t.every(r=>e.findIndex(a=>Vi(r,a))!==-1)}var Vi=sr({createCustomConfig:t=>({...t,areArraysEqual:nE})});var oE=O(Yg(),t=>{t.addCase(Ft,(e,r)=>iE(e,r.payload)?void 0:r.payload)}),iE=(t,e)=>sE(t.context,e.context)&&cE(t.dictionaryFieldContext,e.dictionaryFieldContext)&&gE(t.advancedSearchQueries,e.advancedSearchQueries)&&uE(t.tabSet,e.tabSet)&&lE(t.staticFilterSet,e.staticFilterSet)&&fp(t.facetSet,e.facetSet)&&fp(t.dateFacetSet,e.dateFacetSet)&&fp(t.numericFacetSet,e.numericFacetSet)&&pE(t.automaticFacetSet,e.automaticFacetSet)&&dE(t.categoryFacetSet,e.categoryFacetSet)&&fE(t.pagination,e.pagination)&&mE(t.query,e.query)&&hE(t,e)&&SE(t.pipeline,e.pipeline)&&yE(t.searchHub,e.searchHub)&&CE(t.facetOrder,e.facetOrder)&&xE(t.debug,e.debug),sE=(t,e)=>JSON.stringify(t.contextValues)===JSON.stringify(e.contextValues),cE=(t,e)=>JSON.stringify(t.contextValues)===JSON.stringify(e.contextValues),uE=(t,e)=>{let r=by(t),a=by(e);return(r==null?void 0:r.id)===(a==null?void 0:a.id)},by=t=>Object.values(t).find(e=>e.isActive),lE=(t,e)=>{for(let[r,a]of Object.entries(e)){if(!t[r])return!1;let n=Ry(t[r]),o=Ry(a);if(JSON.stringify(n)!==JSON.stringify(o))return!1}return!0},Ry=t=>t.values.filter(e=>e.state!=="idle"),fp=(t,e)=>{for(let[r,a]of Object.entries(e)){if(!t[r])return!1;let n=t[r].request.currentValues.filter(i=>i.state!=="idle"),o=a.request.currentValues.filter(i=>i.state!=="idle");if(JSON.stringify(n)!==JSON.stringify(o))return!1}return!0},dE=(t,e)=>{var r;for(let[a,n]of Object.entries(e)){if(!t[a])return!1;let o=Ke((r=t[a])==null?void 0:r.request.currentValues).map(({value:s})=>s),i=Ke(n==null?void 0:n.request.currentValues).map(({value:s})=>s);if(JSON.stringify(o)!==JSON.stringify(i))return!1}return!0},pE=(t,e)=>{for(let[r,a]of Object.entries(e.set)){if(!t.set[r])return!1;let n=t.set[r].response.values.filter(i=>i.state!=="idle"),o=a.response.values.filter(i=>i.state!=="idle");if(JSON.stringify(n)!==JSON.stringify(o))return!1}return!0},fE=(t,e)=>t.firstResult===e.firstResult&&t.numberOfResults===e.numberOfResults,mE=(t,e)=>JSON.stringify(t)===JSON.stringify(e),gE=(t,e)=>JSON.stringify(t)===JSON.stringify(e),hE=(t,e)=>t.sortCriteria===e.sortCriteria,SE=(t,e)=>t===e,yE=(t,e)=>t===e,CE=(t,e)=>ja(t,e),xE=(t,e)=>t===e,hu=py({actionTypes:{redo:wd.type,undo:Pd.type,snapshot:Ft.type},reducer:oE});function Ay(t){if(!vE(t))throw A;let e=N(t),{dispatch:r}=t,a=()=>t.state,n=o=>o.past.length>0&&!ee(o.present);return{...e,get state(){return a().history},async back(){!n(this.state)||(await r(yi()),r(R({legacy:fu(),next:{actionCause:T.historyBackward,getEventExtraPayload:o=>new L(()=>o).getBaseMetadata()}})))},async forward(){!this.state.future.length||!this.state.present||(await r(Ds()),r(R({legacy:pu(),next:{actionCause:T.historyForward,getEventExtraPayload:o=>new L(()=>o).getBaseMetadata()}})))},async backOnNoResults(){!n(this.state)||(await r(yi()),r(R({legacy:mu(),next:{actionCause:T.noResultsBack,getEventExtraPayload:o=>new L(()=>o).getBaseMetadata()}})))}}}function vE(t){return t.addReducers({history:hu,configuration:j,facetOrder:du}),!0}var FE=()=>({build:t=>Ay(t)});var bE=new I({min:xm,default:fs,required:!1}),RE=new I({min:ym,max:Cm,default:ps,required:!1}),AE={desiredCount:RE,numberOfValues:bE},Su=h("automaticFacet/setOptions",t=>y(t,AE)),yu=h("automaticFacet/deselectAll",t=>y(t,G)),PE=P,na=h("automaticFacet/toggleSelectValue",t=>y(t,{field:PE,selection:new E({values:Da})}));var gt=O(dt(),t=>{t.addCase(Pn,(e,r)=>{let a=mp(e),n=r.payload;e.defaultNumberOfResults=e.numberOfResults=n,e.firstResult=Ni(a,n)}).addCase(wn,(e,r)=>{e.numberOfResults=r.payload,e.firstResult=0}).addCase(Rt,e=>{e.firstResult=0}).addCase(En,(e,r)=>{let a=r.payload;e.firstResult=Ni(a,e.numberOfResults)}).addCase(ct,(e,r)=>{let a=r.payload;e.firstResult=Ni(a,e.numberOfResults)}).addCase(kn,e=>{let r=mp(e),a=Math.max(r-1,Ra);e.firstResult=Ni(a,e.numberOfResults)}).addCase(In,e=>{let r=mp(e),a=wE(e),n=Math.min(r+1,a);e.firstResult=Ni(n,e.numberOfResults)}).addCase(ie.fulfilled,(e,r)=>{r.payload&&(e.numberOfResults=r.payload.pagination.numberOfResults,e.firstResult=r.payload.pagination.firstResult)}).addCase(se,(e,r)=>{var a,n;e.firstResult=(a=r.payload.firstResult)!=null?a:e.firstResult,e.numberOfResults=(n=r.payload.numberOfResults)!=null?n:e.defaultNumberOfResults}).addCase(R.fulfilled,(e,r)=>{let{response:a}=r.payload;e.totalCountFiltered=a.totalCountFiltered}).addCase(ra.fulfilled,(e,r)=>{let{response:a}=r.payload;e.totalCountFiltered=a.pagination.totalCount}).addCase(me,e=>{ht(e)}).addCase(rr,e=>{ht(e)}).addCase(zt,e=>{ht(e)}).addCase(Kr,e=>{ht(e)}).addCase(Kn,e=>{ht(e)}).addCase(nr,e=>{ht(e)}).addCase(ir,e=>{ht(e)}).addCase(Ce,e=>{ht(e)}).addCase(br,e=>{ht(e)}).addCase(Rr,e=>{ht(e)}).addCase(Ta,e=>{ht(e)}).addCase(na,e=>{ht(e)})});function ht(t){t.firstResult=dt().firstResult}function mp(t){let{firstResult:e,numberOfResults:r}=t;return gp(e,r)}function wE(t){let{totalCountFiltered:e,numberOfResults:r}=t;return hp(e,r)}function Ni(t,e){return(t-1)*e}function gp(t,e){return Math.round(t/e)+1}function hp(t,e){let r=Math.min(t,bi);return Math.ceil(r/e)}function EE(t){return t.pagination.firstResult}function Py(t){return t.pagination.numberOfResults}function IE(t){return t.pagination.totalCountFiltered}var oa=t=>{let e=EE(t),r=Py(t);return gp(e,r)},Cu=t=>{let e=IE(t),r=Py(t);return hp(e,r)},Sp=(t,e)=>{let r=oa(t),a=Cu(t),n=kE(r,e);return n=OE(n),n=qE(n,a),TE(n)};function kE(t,e){let r=e%2==0,a=Math.floor(e/2),n=r?a-1:a,o=t-a,i=t+n;return{start:o,end:i}}function OE(t){let e=Math.max(Ra-t.start,0),r=t.start+e,a=t.end+e;return{start:r,end:a}}function qE(t,e){let r=Math.max(t.end-e,0),a=Math.max(t.start-r,Ra),n=t.end-r;return{start:a,end:n}}function TE(t){let e=[];for(let r=t.start;r<=t.end;++r)e.push(r);return e}var ho=()=>w("analytics/pager/resize",(t,e)=>{var r;return t.makePagerResize({currentResultsPerPage:((r=e.pagination)==null?void 0:r.numberOfResults)||dt().numberOfResults})}),So=()=>w("analytics/pager/number",(t,e)=>t.makePagerNumber({pagerNumber:oa(e)})),xu=()=>w("analytics/pager/next",(t,e)=>t.makePagerNext({pagerNumber:oa(e)})),vu=()=>w("analytics/pager/previous",(t,e)=>t.makePagerPrevious({pagerNumber:oa(e)}));var DE=new z({numberOfPages:new I({default:5,min:0})}),VE=new z({page:new I({min:1})});function wy(t,e={}){if(!NE(t))throw A;let r=N(t),{dispatch:a}=t,n=de(t,DE,e.options,"buildPager"),i=Pe(t,VE,e.initialState,"buildPager").page;i&&a(En(i));let s=()=>oa(t.state),c=()=>{let{numberOfPages:l}=n;return Sp(t.state,l)},u=()=>Cu(t.state);return{...r,get state(){let l=s(),d=u(),f=l>Ra&&d>0,p=l<d;return{currentPage:l,currentPages:c(),maxPage:d,hasPreviousPage:f,hasNextPage:p}},selectPage(l){a(ct(l))},nextPage(){a(In())},previousPage(){a(kn())},isCurrentPage(l){return l===this.state.currentPage}}}function NE(t){return t.addReducers({configuration:j,pagination:gt}),!0}function Ey(t,e={}){let{dispatch:r}=t,a=wy(t,e);return{...a,get state(){return a.state},selectPage(n){a.selectPage(n),r($t({legacy:So()}))},nextPage(){a.nextPage(),r($t({legacy:xu()}))},previousPage(){a.previousPage(),r($t({legacy:vu()}))}}}var ME=t=>({build:e=>Ey(e,t)});function Iy(t){if(!LE(t))throw A;let e=N(t),r=()=>t.state;return{...e,get state(){return{hasError:r().search.error!==null,error:r().search.error}}}}function LE(t){return t.addReducers({search:W}),!0}function ky(t){return Iy(t)}var QE=()=>({build:t=>ky(t)});function yo(t){if(!BE(t))throw A;let e=N(t),r=()=>t.state;return{...e,get state(){let a=r();return{hasError:a.search.error!==null,isLoading:a.search.isLoading,hasResults:!!a.search.results.length,firstSearchExecuted:Ri(a)}}}}function BE(t){return t.addReducers({search:W}),!0}function Oy(t){if(!jE(t))throw A;let e=N(t),r=yo(t),a=()=>t.state,n=()=>{let o=a().search.duration/1e3;return Math.round((o+Number.EPSILON)*100)/100};return{...e,get state(){return{...r.state,durationInMilliseconds:a().search.duration,durationInSeconds:n(),firstResult:a().pagination.firstResult+1,hasDuration:a().search.duration!==0,hasQuery:a().search.queryExecuted!=="",lastResult:a().pagination.firstResult+a().search.results.length,query:a().search.queryExecuted,total:a().pagination.totalCountFiltered}}}}function jE(t){return t.addReducers({search:W,pagination:gt}),!0}function qy(t){return Oy(t)}var UE=()=>({build:t=>qy(t)});var _E=new z({fieldsToInclude:new H({required:!1,each:new b({required:!0,emptyAllowed:!1})})});function Fu(t,e){if(!$E(t))throw A;let r=N(t),a=yo(t),{dispatch:n}=t,o=()=>t.state,i=de(t,_E,e==null?void 0:e.options,"buildCoreResultList");i.fieldsToInclude&&n(Hr(i.fieldsToInclude));let s=()=>t.state.search.results.length<t.state.search.response.totalCountFiltered,c=0,u=0,l=5,d=200,f=!1;return{...r,get state(){let m=o();return{...a.state,results:m.search.results,moreResultsAvailable:s(),searchResponseId:m.search.searchResponseId}},fetchMoreResults:()=>{if(t.state.search.isLoading)return;if(!s()){t.logger.info("No more results are available for the result list to fetch.");return}if(Date.now()-c<d){if(u++,u>=l){c=Date.now(),!f&&t.logger.error(`The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively ${l} times, with little delay. Please verify the conditions under which the function is called.`),f=!0;return}}else u=0;f=!1,(e==null?void 0:e.fetchMoreResultsActionCreator)&&n(e==null?void 0:e.fetchMoreResultsActionCreator()).then(()=>c=Date.now())}}}function $E(t){return t.addReducers({search:W,configuration:j,fields:Yr}),!0}function Ty(t,e){return Fu(t,{...e,fetchMoreResultsActionCreator:Wr})}var WE=t=>({build:e=>Ty(e,t)});var HE=new z({numberOfResults:new I({min:0})});function Dy(t,e={}){if(!zE(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,i=Pe(t,HE,e.initialState,"buildResultsPerPage").numberOfResults;return i!==void 0&&a(Pn(i)),{...r,get state(){return{numberOfResults:n().pagination.numberOfResults}},set(s){a(wn(s))},isSetTo(s){return s===this.state.numberOfResults}}}function zE(t){return t.addReducers({pagination:gt,configuration:j}),!0}function Vy(t,e={}){if(!GE(t))throw A;let r=Dy(t,e),{dispatch:a}=t;return{...r,get state(){return{...r.state}},set(n){r.set(n),a($t({legacy:ho()}))}}}function GE(t){return t.addReducers({pagination:gt,configuration:j}),!0}var YE=t=>({build:e=>Vy(e,t)});var Mi={id:P},Co=h("querySuggest/register",t=>y(t,{...Mi,count:new I({min:0})})),Ny=h("querySuggest/unregister",t=>y(t,Mi)),cr=h("querySuggest/selectSuggestion",t=>y(t,{...Mi,expression:le})),ia=h("querySuggest/clear",t=>y(t,Mi)),sa=J("querySuggest/fetch",async(t,{getState:e,rejectWithValue:r,extra:{apiClient:a,validatePayload:n}})=>{n(t,Mi);let o=t.id,i=await KE(o,e()),s=await a.querySuggest(i);return ye(s)?r(s.error):{id:o,q:i.q,...s.success}}),KE=async(t,e)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,count:e.querySuggest[t].count,q:e.querySet[t],locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,actionsHistory:e.configuration.analytics.enabled?Mt.getHistory():[],...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&{visitorId:await at(e.configuration.analytics),...e.configuration.analytics.enabled&&await On(e.configuration.analytics)},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var ca=()=>w("analytics/searchbox/submit",t=>t.makeSearchboxSubmit());var My={id:P,query:le},xo=h("querySet/register",t=>y(t,My)),Ua=h("querySet/update",t=>y(t,My));var vo=O(Ys(),t=>{t.addCase(xo,(e,r)=>{let{id:a,query:n}=r.payload;a in e||(e[a]=n)}).addCase(Ua,(e,r)=>{let{id:a,query:n}=r.payload;yp(e,a,n)}).addCase(cr,(e,r)=>{let{id:a,expression:n}=r.payload;yp(e,a,n)}).addCase(R.fulfilled,(e,r)=>{let{queryExecuted:a}=r.payload;Ly(e,a)}).addCase(se,(e,r)=>{ee(r.payload.q)||Ly(e,r.payload.q)}).addCase(ie.fulfilled,(e,r)=>{if(!!r.payload)for(let[a,n]of Object.entries(r.payload.querySet))yp(e,a,n)})});function Ly(t,e){Object.keys(t).forEach(r=>t[r]=e)}var yp=(t,e,r)=>{e in t&&(t[e]=r)};var bu=t=>w("analytics/querySuggest",(e,r)=>{let a=Cp(r,t);return e.makeOmniboxAnalytics(a)});function Cp(t,e){let{id:r,suggestion:a}=e,n=t.querySuggest&&t.querySuggest[r];if(!n)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let o=n.completions.map(u=>u.expression),i=n.partialQueries.length-1,s=n.partialQueries[i]||"",c=n.responseId;return{suggestionRanking:o.indexOf(a),partialQuery:s,partialQueries:n.partialQueries,suggestions:o,querySuggestResponseId:c}}var Qy=()=>({});var Fo=O(Qy(),t=>t.addCase(Co,(e,r)=>{let a=r.payload.id;a in e||(e[a]=JE(r.payload))}).addCase(Ny,(e,r)=>{delete e[r.payload.id]}).addCase(sa.pending,(e,r)=>{let a=e[r.meta.arg.id];!a||(a.currentRequestId=r.meta.requestId,a.isLoading=!0)}).addCase(sa.fulfilled,(e,r)=>{let a=e[r.meta.arg.id];if(!a||r.meta.requestId!==a.currentRequestId)return;let{q:n}=r.payload;n&&a.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),a.responseId=r.payload.responseId,a.completions=r.payload.completions,a.isLoading=!1,a.error=null}).addCase(sa.rejected,(e,r)=>{let a=e[r.meta.arg.id];!a||(a.error=r.payload||null,a.isLoading=!1)}).addCase(ia,(e,r)=>{let a=e[r.payload.id];!a||(a.responseId="",a.completions=[],a.partialQueries=[])}));function JE(t){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...t}}var He=O(Fe(),t=>t.addCase(Qe,(e,r)=>({...e,...r.payload})).addCase(lt,(e,r)=>{e.q=r.payload}).addCase(cr,(e,r)=>{e.q=r.payload.expression}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.query)!=null?n:e}).addCase(se,(e,r)=>{var a,n;e.q=(a=r.payload.q)!=null?a:e.q,e.enableQuerySyntax=(n=r.payload.enableQuerySyntax)!=null?n:e.enableQuerySyntax}));function By(t,e){return t=XE(t),t.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,a,n,o)=>a?xp(a,e.notMatchDelimiters):n?xp(n,e.exactMatchDelimiters):o?xp(o,e.correctionDelimiters):r)}function xp(t,e){return e?e.open+t+e.close:t}function XE(t){let e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(e).join("|")+")",a=RegExp(r),n=RegExp(r,"g");return a.test(t)?t.replace(n,o=>e[o]):t}var Ru={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},vp={open:new b,close:new b},Fp={id:P,numberOfSuggestions:new I({min:0}),enableQuerySyntax:new $,highlightOptions:new E({values:{notMatchDelimiters:new E({values:vp}),exactMatchDelimiters:new E({values:vp}),correctionDelimiters:new E({values:vp})}}),clearFilters:new $},jy=new z(Fp);function Uy(t,e){var u,l;if(!eI(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o=((u=e.options)==null?void 0:u.id)||Xa("search_box"),i={id:o,highlightOptions:{...(l=e.options)==null?void 0:l.highlightOptions},...Ru,...e.options};de(t,jy,i,"buildSearchBox"),a(xo({id:o,query:t.state.query.q})),i.numberOfSuggestions&&a(Co({id:o,count:i.numberOfSuggestions}));let s=()=>t.state.querySet[i.id],c=async d=>{let{enableQuerySyntax:f,clearFilters:p}=i;a(oc({q:s(),enableQuerySyntax:f,clearFilters:p})),e.isNextAnalyticsReady?a(e.executeSearchActionCreator(d)):a(e.executeSearchActionCreator(d.legacy))};return{...r,updateText(d){a(Ua({id:o,query:d})),this.showSuggestions()},clear(){a(Ua({id:o,query:""})),a(ia({id:o}))},showSuggestions(){i.numberOfSuggestions&&a(e.fetchQuerySuggestionsActionCreator({id:o}))},selectSuggestion(d){a(cr({id:o,expression:d})),c({legacy:bu({id:o,suggestion:d}),next:{actionCause:T.omniboxAnalytics,getEventExtraPayload:f=>new L(()=>f).getOmniboxAnalyticsMetadata(o,d)}}).then(()=>{a(ia({id:o}))})},submit(d=ca()){c({legacy:d}),a(ia({id:o}))},get state(){let d=n(),f=d.querySuggest[i.id],p=ZE(f,i.highlightOptions),m=f?f.isLoading:!1;return{value:s(),suggestions:p,isLoading:d.search.isLoading,isLoadingSuggestions:m}}}}function ZE(t,e){return t?t.completions.map(r=>({highlightedValue:By(r.highlighted,e),rawValue:r.expression})):[]}function eI(t){return t.addReducers({query:He,querySuggest:Fo,configuration:j,querySet:vo,search:W}),!0}function Au(t,e={}){let r=Uy(t,{...e,executeSearchActionCreator:R,fetchQuerySuggestionsActionCreator:sa,isNextAnalyticsReady:!0});return{...r,submit(){r.submit(ca())},get state(){return r.state}}}var tI=t=>({build:e=>Au(e,t)});var Pu=O(zs(),t=>{t.addCase(Rn,(e,r)=>{let{id:a}=r.payload;e[a]||(e[a]={q:"",cache:{}})}),t.addCase(Ut,(e,r)=>{let{q:a,id:n}=r.payload;!a||(e[n].q=a)}),t.addCase(An,(e,r)=>{let{id:a}=r.payload;Object.entries(e[a].cache).forEach(([n,o])=>{Gs(o)&&delete e[a].cache[n]})}),t.addCase(jn.pending,(e,r)=>{for(let n in e)for(let o in e[n].cache)e[n].cache[o].isActive=!1;if(!wu(e,r.meta)){rI(e,r.meta);return}let a=wu(e,r.meta);a.isLoading=!0,a.isActive=!0,a.error=null}),t.addCase(jn.fulfilled,(e,r)=>{let{results:a,searchUid:n,totalCountFiltered:o,duration:i}=r.payload,{cacheTimeout:s}=r.meta.arg,c=wu(e,r.meta);c.isActive=!0,c.searchUid=n,c.isLoading=!1,c.error=null,c.results=a,c.expiresAt=s?s+Date.now():0,c.totalCountFiltered=o,c.duration=i}),t.addCase(jn.rejected,(e,r)=>{let a=wu(e,r.meta);a.error=r.error||null,a.isLoading=!1,a.isActive=!1})}),rI=(t,e)=>{let{q:r,id:a}=e.arg;t[a].cache[r]={isLoading:!0,error:null,results:[],expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0}},wu=(t,e)=>{let{q:r,id:a}=e.arg;return t[a].cache[r]||null};var aI={searchBoxId:pe,maxResultsPerQuery:new I({required:!0,min:1}),cacheTimeout:new I},_y=new z(aI);function $y(t,e){if(!nI(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o={searchBoxId:e.options.searchBoxId||Xa("instant-results-"),cacheTimeout:e.options.cacheTimeout||6e4,maxResultsPerQuery:e.options.maxResultsPerQuery};de(t,_y,o,"buildInstantResults");let i=o.searchBoxId;a(Rn({id:i}));let s=()=>n().instantResults[i],c=d=>s().cache[d],u=()=>s().q,l=()=>{let d=c(u());return d?d.isLoading?[]:d.results:[]};return{...r,updateQuery(d){if(!d)return;let f=c(d);(!f||!f.isLoading&&(f.error||Gs(f)))&&a(jn({id:i,q:d,maxResultsPerQuery:o.maxResultsPerQuery,cacheTimeout:o.cacheTimeout})),a(Ut({id:i,q:d}))},clearExpired(){a(An({id:i}))},get state(){let d=u(),f=c(d);return{q:d,isLoading:(f==null?void 0:f.isLoading)||!1,error:(f==null?void 0:f.error)||null,results:l()}}}}function nI(t){return t.addReducers({instantResults:Pu}),!0}var oI=t=>({build:e=>$y(e,t)});var bo=()=>w("analytics/sort/results",(t,e)=>t.makeResultsSort({resultsSortBy:e.sortCriteria||rt()}));var Wy={by:new vt({enum:Vt,required:!0})},Ro=h("sortCriteria/register",t=>Hy(t)),Ao=h("sortCriteria/update",t=>Hy(t)),Hy=t=>dn(t)?(t.forEach(e=>y(e,Wy)),{payload:t}):y(t,Wy);var Po=O(rt(),t=>{t.addCase(Ro,(e,r)=>fr(r.payload)).addCase(Ao,(e,r)=>fr(r.payload)).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.sortCriteria)!=null?n:e}).addCase(se,(e,r)=>{var a;return(a=r.payload.sortCriteria)!=null?a:e})});function iI(t,e){if(!e)return;let r=new z({criterion:new H({each:Vm})}),a=sI(e),n={...e,criterion:a};Pe(t,r,n,"buildSort")}function sI(t){return t.criterion?dn(t.criterion)?t.criterion:[t.criterion]:[]}function zy(t,e){var i;if(!cI(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state;iI(t,e.initialState);let o=(i=e.initialState)==null?void 0:i.criterion;return o&&a(Ro(o)),{...r,sortBy(s){a(Ao(s)),a(ct(1))},isSortedBy(s){return this.state.sortCriteria===fr(s)},get state(){return{sortCriteria:n().sortCriteria}}}}function cI(t){return t.addReducers({configuration:j,sortCriteria:Po}),!0}function Gy(t,e={}){let{dispatch:r}=t,a=zy(t,e),n=()=>r(R({legacy:bo(),next:{actionCause:T.resultsSort,getEventExtraPayload:o=>new L(()=>o).getResultSortMetadata()}}));return{...a,get state(){return a.state},sortBy(o){a.sortBy(o),n()}}}var uI=t=>({build:e=>Gy(e,t)});var _a=P,Eu=new E({options:{required:!0},values:{caption:le,expression:le,state:new b({constrainTo:["idle","selected","excluded"]})}}),Iu=new H({required:!0,each:Eu});var wo=h("staticFilter/register",t=>y(t,{id:_a,values:Iu})),Ar=h("staticFilter/toggleSelect",t=>y(t,{id:_a,value:Eu})),Pr=h("staticFilter/toggleExclude",t=>y(t,{id:_a,value:Eu})),ua=h("staticFilter/deselectAllFilterValues",t=>y(t,_a)),ku=t=>w("analytics/staticFilter/select",e=>e.makeStaticFilterSelect(t)),Eo=t=>w("analytics/staticFilter/deselect",e=>e.makeStaticFilterDeselect(t)),Ou=t=>w("analytics/staticFilter/clearAll",e=>e.makeStaticFilterClearAll(t));var Io=O(Ks(),t=>t.addCase(wo,(e,r)=>{let a=r.payload,{id:n}=a;n in e||(e[n]=a)}).addCase(Ar,(e,r)=>{let{id:a,value:n}=r.payload,o=e[a];if(!o)return;let i=o.values.find(c=>c.caption===n.caption);if(!i)return;let s=i.state==="selected";i.state=s?"idle":"selected"}).addCase(Pr,(e,r)=>{let{id:a,value:n}=r.payload,o=e[a];if(!o)return;let i=o.values.find(c=>c.caption===n.caption);if(!i)return;let s=i.state==="excluded";i.state=s?"idle":"excluded"}).addCase(ua,(e,r)=>{let a=r.payload,n=e[a];!n||n.values.forEach(o=>o.state="idle")}).addCase(Ce,e=>{Object.values(e).forEach(r=>{r.values.forEach(a=>a.state="idle")})}).addCase(se,(e,r)=>{let a=r.payload.sf||{};Object.entries(e).forEach(([n,o])=>{let i=a[n]||[];o.values.forEach(s=>{s.state=i.includes(s.caption)?"selected":"idle"})})}));function bp(t){return{state:"idle",...t}}var lI=new z({id:_a,values:Iu});function Yy(t,e){if(!dI(t))throw A;de(t,lI,e.options,"buildStaticFilter");let r=N(t),{dispatch:a}=t,n=()=>t.state,{id:o}=e.options;return a(wo(e.options)),{...r,toggleSelect(i){a(Ar({id:o,value:i})),a(R({legacy:qu(o,i),next:Tu(o,i)}))},toggleSingleSelect(i){i.state==="idle"&&a(ua(o)),a(Ar({id:o,value:i})),a(R({legacy:qu(o,i),next:Tu(o,i)}))},toggleExclude(i){a(Pr({id:o,value:i})),a(R({legacy:qu(o,i),next:Tu(o,i)}))},toggleSingleExclude(i){i.state==="idle"&&a(ua(o)),a(Pr({id:o,value:i})),a(R({legacy:qu(o,i),next:Tu(o,i)}))},deselectAll(){a(ua(o)),a(R({legacy:Ou({staticFilterId:o}),next:{actionCause:T.staticFilterClearAll,getEventExtraPayload:i=>new L(()=>i).getStaticFilterClearAllMetadata(o)}}))},isValueSelected(i){return i.state==="selected"},isValueExcluded(i){return i.state==="excluded"},get state(){var c;let i=((c=n().staticFilterSet[o])==null?void 0:c.values)||[],s=i.some(u=>u.state!=="idle");return{id:o,values:i,hasActiveValues:s}}}}function dI(t){return t.addReducers({staticFilterSet:Io}),!0}function qu(t,e){let{caption:r,expression:a,state:n}=e;return(n==="idle"?ku:Eo)({staticFilterId:t,staticFilterValue:{caption:r,expression:a}})}function Tu(t,e){return{actionCause:e.state==="selected"?T.staticFilterDeselect:T.staticFilterSelect,getEventExtraPayload:a=>new L(()=>a).getStaticFilterToggleMetadata(t,e)}}var pI=t=>({build:e=>Yy(e,t)});var ko=O(Js(),t=>{t.addCase(Un,(e,r)=>{let a=r.payload,{id:n}=a;n in e||(e[n]={...a,isActive:!1})}).addCase(Rt,(e,r)=>{let a=r.payload;Ky(e,a)}).addCase(se,(e,r)=>{let a=r.payload.tab||"";Ky(e,a)}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.tabSet)!=null?n:e})});function Ky(t,e){e in t&&Object.keys(t).forEach(a=>{t[a].isActive=a===e})}var fI=new z({expression:le,id:P}),mI=new z({isActive:new $});function Jy(t,e){if(hI(e.options.id),!gI(t))throw A;let r=N(t),{dispatch:a}=t;de(t,fI,e.options,"buildTab");let n=Pe(t,mI,e.initialState,"buildTab"),{id:o,expression:i}=e.options;return a(Un({id:o,expression:i})),n.isActive&&a(Rt(o)),{...r,select(){a(Rt(o))},get state(){var c;return{isActive:(c=t.state.tabSet[o])==null?void 0:c.isActive}}}}function gI(t){return t.addReducers({configuration:j,tabSet:ko}),!0}function hI(t){let e=_n().analytics.originLevel2;if(t===e)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${e}". Please specify a different value.`)}function Xy(t,e){let{dispatch:r}=t,a=Jy(t,e),n=()=>r(R({legacy:Mr(),next:{actionCause:T.interfaceChange,getEventExtraPayload:o=>new L(()=>o).getInterfaceChangeMetadata()}}));return{...a,get state(){return a.state},select(){a.select(),n()}}}var SI=t=>({build:e=>Xy(e,t)});function Zy(t){if(!yI(t))throw A;let e=N(t),r=()=>t.state;return{...e,sort(a){return Tn(a,this.state.facetIds)},get state(){return{facetIds:r().search.response.facets.map(o=>o.facetId)}}}}function yI(t){return t.addReducers({search:W,facetOptions:Oe}),!0}function eC(t){return Zy(t)}var CI=()=>({build:t=>eC(t)});var xI={categoryFacetId:G,categoryFacetPath:new H({required:!0,each:P})},vI=(t,{categoryFacetId:e,categoryFacetPath:r})=>{let a=t.categoryFacetSet[e],n=a==null?void 0:a.request.field,o=`${n}_${e}`;return{categoryFacetId:e,categoryFacetPath:r,categoryFacetField:n,categoryFacetTitle:o}},Du=t=>w("analytics/categoryFacet/breadcrumb",(e,r)=>(y(t,xI),e.makeBreadcrumbFacet(vI(r,t))));var Vu=()=>w("analytics/facet/deselectAllBreadcrumbs",t=>t.makeBreadcrumbResetAll());var Nu=(t,{facetId:e,selection:r})=>{let n=(t.dateFacetSet[e]||t.numericFacetSet[e]).request.field,o=`${n}_${e}`;return{facetId:e,facetField:n,facetTitle:o,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}};var Li=t=>w("analytics/dateFacet/breadcrumb",(e,r)=>{y(t,Ba(t.selection));let a=Nu(r,t);return e.makeBreadcrumbFacet(a)});var Qi=t=>w("analytics/numericFacet/breadcrumb",(e,r)=>{y(t,Ba(t.selection));let a=Nu(r,t);return e.makeBreadcrumbFacet(a)});var Mu=t=>Object.keys(t.facetSet).map(e=>{let r=t.facetValuesSelector(t.engine.state,e).map(a=>({value:a,deselect:()=>{a.state==="selected"?t.executeToggleSelect({facetId:e,selection:a}):a.state==="excluded"&&t.executeToggleExclude({facetId:e,selection:a})}}));return{facetId:e,field:t.facetSet[e].request.field,values:r}}).filter(e=>e.values.length);function tC(t){let e=N(t),{dispatch:r}=t;return{...e,get state(){return{facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(Ce())},deselectBreadcrumb(a){a.deselect()}}}function rC(t){if(!FI(t))throw A;let e=tC(t),{dispatch:r}=t,a=()=>t.state,n=()=>{let v={engine:t,facetSet:a().facetSet,executeToggleSelect:({facetId:C,selection:F})=>{r(rr({facetId:C,selection:F})),r(Ma({facetId:C,freezeCurrentValues:!1})),r(R({legacy:oo({facetId:C,facetValue:F.value}),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:D=>new L(()=>D).getFacetMetadata(C,F.value)}}))},executeToggleExclude:({facetId:C,selection:F})=>{r(Xr({facetId:C,selection:F})),r(Ma({facetId:C,freezeCurrentValues:!1})),r(R({legacy:oo({facetId:C,facetValue:F.value}),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:D=>new L(()=>D).getFacetMetadata(C,F.value)}}))},facetValuesSelector:vm};return Mu(v)},o=()=>{let v={engine:t,facetSet:a().numericFacetSet,executeToggleSelect:C=>{r(ir(C)),r(R({legacy:Qi(C),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:F=>new L(()=>F).getRangeFacetBreadcrumbMetadata(C.facetId,C.selection)}}))},executeToggleExclude:C=>{r(ta(C)),r(R({legacy:Qi(C),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:F=>new L(()=>F).getRangeFacetBreadcrumbMetadata(C.facetId,C.selection)}}))},facetValuesSelector:ZS};return Mu(v)},i=()=>{let v={engine:t,facetSet:a().dateFacetSet,executeToggleSelect:C=>{r(nr(C)),r(R({legacy:Li(C),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:F=>new L(()=>F).getRangeFacetBreadcrumbMetadata(C.facetId,C.selection)}}))},executeToggleExclude:C=>{r(ea(C)),r(R({legacy:Li(C),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:F=>new L(()=>F).getRangeFacetBreadcrumbMetadata(C.facetId,C.selection)}}))},facetValuesSelector:oy};return Mu(v)},s=()=>Object.keys(a().categoryFacetSet).map(c).filter(v=>v.path.length),c=v=>{let C=bm(a(),v);return{facetId:v,field:a().categoryFacetSet[v].request.field,path:C,deselect:()=>{r(zt(v)),r(R({legacy:Du({categoryFacetPath:C.map(F=>F.value),categoryFacetId:v}),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:F=>new L(()=>F).getCategoryFacetBreadcrumbMetadata(v,C.map(D=>D.value))}}))}}},u=()=>{var C;let v=(C=a().staticFilterSet)!=null?C:{};return Object.values(v).map(l)},l=v=>{let{id:C,values:F}=v,D=F.filter(Q=>Q.state!=="idle").map(Q=>d(C,Q));return{id:C,values:D}},d=(v,C)=>({value:C,deselect:()=>{let{caption:F,expression:D}=C,Q=Eo({staticFilterId:v,staticFilterValue:{caption:F,expression:D}});C.state==="selected"?r(Ar({id:v,value:C})):C.state==="excluded"&&r(Pr({id:v,value:C})),r(R({legacy:Q}))}}),f=()=>{var C,F;let v=(F=(C=a().automaticFacetSet)==null?void 0:C.set)!=null?F:{};return Object.values(v).map(D=>p(D.response))},p=v=>{let{field:C,label:F}=v,D=v.values.filter(Q=>Q.state==="selected").map(Q=>m(C,Q));return{facetId:C,field:C,label:F,values:D}},m=(v,C)=>({value:C,deselect:()=>{r(na({field:v,selection:C})),r(R({legacy:oo({facetId:v,facetValue:C.value}),next:{actionCause:T.breadcrumbFacet,getEventExtraPayload:F=>new L(()=>F).getFacetMetadata(v,C.value)}}))}});function S(){return!![...n(),...o(),...i(),...s(),...u(),...f()].length}return{...e,get state(){return{facetBreadcrumbs:n(),categoryFacetBreadcrumbs:s(),numericFacetBreadcrumbs:o(),dateFacetBreadcrumbs:i(),staticFilterBreadcrumbs:u(),automaticFacetBreadcrumbs:f(),hasBreadcrumbs:S()}},deselectAll:()=>{e.deselectAll(),r(R({legacy:Vu(),next:{actionCause:T.breadcrumbResetAll,getEventExtraPayload:v=>new L(()=>v).getBaseMetadata()}}))}}}function FI(t){return t.addReducers({configuration:j,search:W,facetSet:ft,numericFacetSet:We,dateFacetSet:mt,categoryFacetSet:pt}),!0}var bI=()=>({build:t=>rC(t)});function aC(t){return t.type==="redirect"}var Rp=class{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let e=this.response.preprocessingOutput.triggers.filter(aC);return e.length?e[0].content:null}};var Oo=h("standaloneSearchBox/register",t=>y(t,{id:P,redirectionUrl:P})),qo=h("standaloneSearchBox/reset",t=>y(t,{id:P})),To=h("standaloneSearchBox/updateAnalyticsToSearchFromLink",t=>y(t,{id:P})),Do=h("standaloneSearchBox/updateAnalyticsToOmniboxFromLink"),la=J("standaloneSearchBox/fetchRedirect",async(t,{dispatch:e,getState:r,rejectWithValue:a,extra:{apiClient:n,validatePayload:o}})=>{o(t,{id:new b({emptyAllowed:!1})});let i=await AI(r()),s=await n.plan(i);if(ye(s))return a(s.error);let{redirectionUrl:c}=new Rp(s.success);return c&&e(RI(c)),c||""}),RI=t=>w("analytics/standaloneSearchBox/redirect",e=>e.makeTriggerRedirect({redirectedTo:t})),AI=async t=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,q:t.query.q,...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},...t.configuration.analytics.enabled&&{visitorId:await at(t.configuration.analytics)},...t.configuration.analytics.enabled&&await On(t.configuration.analytics),...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}});function nC(){return{}}var Lu=O(nC(),t=>t.addCase(Oo,(e,r)=>{let{id:a,redirectionUrl:n}=r.payload;a in e||(e[a]=oC(n))}).addCase(qo,(e,r)=>{let{id:a}=r.payload,n=e[a];if(n){e[a]=oC(n.defaultRedirectionUrl);return}}).addCase(la.pending,(e,r)=>{let a=e[r.meta.arg.id];!a||(a.isLoading=!0)}).addCase(la.fulfilled,(e,r)=>{let a=r.payload,n=e[r.meta.arg.id];!n||(n.redirectTo=a||n.defaultRedirectionUrl,n.isLoading=!1)}).addCase(la.rejected,(e,r)=>{let a=e[r.meta.arg.id];!a||(a.isLoading=!1)}).addCase(To,(e,r)=>{let a=e[r.payload.id];!a||(a.analytics.cause="searchFromLink")}).addCase(Do,(e,r)=>{let a=e[r.payload.id];!a||(a.analytics.cause="omniboxFromLink",a.analytics.metadata=r.payload.metadata)}));function oC(t){return{defaultRedirectionUrl:t,redirectTo:"",isLoading:!1,analytics:{cause:"",metadata:null}}}var iC=new z({...Fp,redirectionUrl:new b({required:!0,emptyAllowed:!1})});function sC(t,e){if(!PI(t))throw A;let{dispatch:r}=t,a=()=>t.state,n=e.options.id||Xa("standalone_search_box"),o={id:n,highlightOptions:{...e.options.highlightOptions},...Ru,...e.options};de(t,iC,o,"buildStandaloneSearchBox");let i=Au(t,{options:o});return r(Oo({id:n,redirectionUrl:o.redirectionUrl})),{...i,updateText(s){i.updateText(s),r(To({id:n}))},selectSuggestion(s){let c=Cp(a(),{id:n,suggestion:s});r(cr({id:n,expression:s})),r(Do({id:n,metadata:c})),this.submit()},afterRedirection(){r(qo({id:n}))},submit(){r(Qe({q:this.state.value,enableQuerySyntax:o.enableQuerySyntax})),r(la({id:n}))},get state(){let c=a().standaloneSearchBoxSet[n];return{...i.state,isLoading:c.isLoading,redirectTo:c.redirectTo,analytics:c.analytics}}}}function PI(t){return t.addReducers({standaloneSearchBoxSet:Lu,configuration:j,query:He,querySuggest:Fo}),!0}var wI=t=>({build:e=>sC(e,t)});var Qu=O(rn(),t=>{t.addCase(R.fulfilled,(e,r)=>{var n;e.set={};let a=(n=r.payload.response.generateAutomaticFacets)==null?void 0:n.facets;a==null||a.forEach(o=>{e.set[o.field]={response:o}})}).addCase(Su,(e,r)=>{r.payload.desiredCount&&(e.desiredCount=r.payload.desiredCount),r.payload.numberOfValues&&(e.numberOfValues=r.payload.numberOfValues)}).addCase(na,(e,r)=>{var c;let{field:a,selection:n}=r.payload,o=(c=e.set[a])==null?void 0:c.response;if(!o)return;let i=o.values.find(u=>u.value===n.value);if(!i)return;let s=i.state==="selected";i.state=s?"idle":"selected"}).addCase(yu,(e,r)=>{var o;let a=r.payload,n=(o=e.set[a])==null?void 0:o.response;if(!!n)for(let i of n.values)i.state="idle"}).addCase(se,(e,r)=>{var o,i,s;let a=(o=r.payload.af)!=null?o:{},n=Object.keys(e.set);for(let c in a)if(!e.set[c]){let u=EI(c),l=a[c].map(d=>II(d));u.values.push(...l),e.set[c]={response:u}}for(let c of n)if(!(c in a)){let u=(i=e.set[c])==null?void 0:i.response;for(let l of u.values)l.state="idle"}for(let c in a){let u=(s=e.set[c])==null?void 0:s.response;if(u){let l=u.values;for(let d of l)a[c].includes(d.value)?d.state==="idle"&&(d.state="selected"):d.state="idle"}}}).addCase(ie.fulfilled,(e,r)=>{if(!!r.payload&&Object.keys(r.payload.automaticFacetSet.set).length!==0)return r.payload.automaticFacetSet}).addCase(Ce,e=>{Object.values(e.set).forEach(({response:r})=>{r.values.forEach(a=>a.state="idle")})})});function EI(t){return{field:t,values:[],moreValuesAvailable:!1,label:"",indexScore:0}}function II(t){return{value:t,state:"selected",numberOfResults:0}}var da=()=>new b({required:!1,emptyAllowed:!0}),Bu=h("advancedSearchQueries/update",t=>y(t,{aq:da(),cq:da(),lq:da(),dq:da()})),ju=h("advancedSearchQueries/register",t=>y(t,{aq:da(),cq:da(),lq:da(),dq:da()}));var Uu=O(bt(),t=>{t.addCase(Bu,(e,r)=>{let{aq:a,cq:n,lq:o,dq:i}=r.payload;Ae(a)||(e.aq=a,e.aqWasSet=!0),Ae(n)||(e.cq=n,e.cqWasSet=!0),Ae(o)||(e.lq=o,e.lqWasSet=!0),Ae(i)||(e.dq=i,e.dqWasSet=!0)}).addCase(ju,(e,r)=>{let{aq:a,cq:n,lq:o,dq:i}=r.payload;Ae(a)||(e.defaultFilters.aq=a,e.aqWasSet||(e.aq=a)),Ae(n)||(e.defaultFilters.cq=n,e.cqWasSet||(e.cq=n)),Ae(o)||(e.defaultFilters.lq=o,e.lqWasSet||(e.lq=o)),Ae(i)||(e.defaultFilters.dq=i,e.dqWasSet||(e.dq=i))}).addCase(ie.fulfilled,(e,r)=>{var a,n;return(n=(a=r.payload)==null?void 0:a.advancedSearchQueries)!=null?n:e}).addCase(se,(e,r)=>{let{aq:a,cq:n}=r.payload;Ae(a)||(e.aq=a,e.aqWasSet=!0),Ae(n)||(e.cq=n,e.cqWasSet=!0)})});function cC(t,e){return t.q!==e.q?ca():t.sortCriteria!==e.sortCriteria?bo():t.firstResult!==e.firstResult?So():t.numberOfResults!==e.numberOfResults?ho():Vo(t.f,e.f)?Bi(t.f,e.f):Vo(t.fExcluded,e.fExcluded)?Bi(t.fExcluded,e.fExcluded,!0):Vo(t.cf,e.cf)?Bi(t.cf,e.cf):Vo(t.af,e.af)?Bi(t.af,e.af):Vo(t.nf,e.nf)?lC(t.nf,e.nf):Vo(t.df,e.df)?lC(t.df,e.df):Mr()}function Vo(t={},e={}){return JSON.stringify(t)!==JSON.stringify(e)}function uC(t){let e={};return Object.keys(t).forEach(r=>e[r]=t[r].map(a=>`${a.start}..${a.end}`)),e}function Bi(t={},e={},r=!1){let a=Object.keys(t),n=Object.keys(e),o=a.filter(f=>!n.includes(f));if(o.length){let f=o[0];return t[f].length>1?ke(f):Ze({facetId:f,facetValue:t[f][0]})}let i=n.filter(f=>!a.includes(f));if(i.length){let f=i[0];return r?Pt({facetId:f,facetValue:e[f][0]}):be({facetId:f,facetValue:e[f][0]})}let s=n.find(f=>e[f].filter(p=>t[f].includes(p)));if(!s)return Mr();let c=t[s],u=e[s],l=u.filter(f=>!c.includes(f));if(l.length)return r?Pt({facetId:s,facetValue:l[0]}):be({facetId:s,facetValue:l[0]});let d=c.filter(f=>!u.includes(f));return d.length?Ze({facetId:s,facetValue:d[0]}):Mr()}function lC(t={},e={}){return Bi(uC(t),uC(e))}function dC(t){var e,r,a,n,o,i;return{q:Fe().q,enableQuerySyntax:Fe().enableQuerySyntax,aq:(r=(e=t.advancedSearchQueries)==null?void 0:e.defaultFilters.aq)!=null?r:bt().defaultFilters.aq,cq:(n=(a=t.advancedSearchQueries)==null?void 0:a.defaultFilters.cq)!=null?n:bt().defaultFilters.cq,firstResult:dt().firstResult,numberOfResults:(i=(o=t.pagination)==null?void 0:o.defaultNumberOfResults)!=null?i:dt().defaultNumberOfResults,sortCriteria:rt(),f:{},fExcluded:{},cf:{},nf:{},df:{},debug:Br(),sf:{},tab:"",af:{}}}var kI=new z({parameters:new E({options:{required:!0},values:Ts})});function pC(t,e){let{dispatch:r}=t,a=N(t);return Pe(t,kI,e.initialState,"buildSearchParameterManager"),r(se(e.initialState.parameters)),{...a,synchronize(n){let o=_u(t,n);r(se(o))},get state(){return{parameters:Ap(t)}}}}function _u(t,e){return{...dC(t.state),...e}}function fC(t,e){return TI(t,e)}function Ap(t){let e=t.state;return{...OI(e),...qI(e),...DI(e),...mC(e,gC,"f"),...mC(e,VI,"fExcluded"),...NI(e),...MI(e),...LI(e),...QI(e)}}function OI(t){if(t.query===void 0)return{};let e=t.query.q;return e!==Fe().q?{q:e}:{}}function qI(t){var r;let e=Object.values((r=t.tabSet)!=null?r:{}).find(a=>a.isActive);return e?{tab:e.id}:{}}function TI(t,e){let r=t.state.tabSet,a=e.tab;if(!r||!Object.entries(r).length||!a)return!0;let n=a in r;return n||t.logger.warn(`The tab search parameter "${a}" is invalid. Ignoring change.`),n}function DI(t){if(t.sortCriteria===void 0)return{};let e=t.sortCriteria;return e!==rt()?{sortCriteria:e}:{}}function mC(t,e,r){if(t.facetSet===void 0)return{};let a=Object.entries(t.facetSet).filter(([n])=>{var o,i,s;return(s=(i=(o=t.facetOptions)==null?void 0:o.facets[n])==null?void 0:i.enabled)!=null?s:!0}).map(([n,{request:o}])=>{let i=e(o.currentValues);return i.length?{[n]:i}:{}}).reduce((n,o)=>({...n,...o}),{});return Object.keys(a).length?{[r]:a}:{}}function gC(t){return t.filter(e=>e.state==="selected").map(e=>e.value)}function VI(t){return t.filter(e=>e.state==="excluded").map(e=>e.value)}function NI(t){if(t.categoryFacetSet===void 0)return{};let e=Object.entries(t.categoryFacetSet).filter(([r])=>{var a,n,o;return(o=(n=(a=t.facetOptions)==null?void 0:a.facets[r])==null?void 0:n.enabled)!=null?o:!0}).map(([r,a])=>{let o=Ke(a.request.currentValues).map(i=>i.value);return o.length?{[r]:o}:{}}).reduce((r,a)=>({...r,...a}),{});return Object.keys(e).length?{cf:e}:{}}function MI(t){if(t.numericFacetSet===void 0)return{};let e=Object.entries(t.numericFacetSet).filter(([r])=>{var a,n,o;return(o=(n=(a=t.facetOptions)==null?void 0:a.facets[r])==null?void 0:n.enabled)!=null?o:!0}).map(([r,{request:a}])=>{let n=hC(a.currentValues);return n.length?{[r]:n}:{}}).reduce((r,a)=>({...r,...a}),{});return Object.keys(e).length?{nf:e}:{}}function LI(t){if(t.dateFacetSet===void 0)return{};let e=Object.entries(t.dateFacetSet).filter(([r])=>{var a,n,o;return(o=(n=(a=t.facetOptions)==null?void 0:a.facets[r])==null?void 0:n.enabled)!=null?o:!0}).map(([r,{request:a}])=>{let n=hC(a.currentValues);return n.length?{[r]:n}:{}}).reduce((r,a)=>({...r,...a}),{});return Object.keys(e).length?{df:e}:{}}function hC(t){return t.filter(e=>e.state==="selected")}function QI(t){var a;let e=(a=t.automaticFacetSet)==null?void 0:a.set;if(e===void 0)return{};let r=Object.entries(e).map(([n,{response:o}])=>{let i=gC(o.values);return i.length?{[n]:i}:{}}).reduce((n,o)=>({...n,...o}),{});return Object.keys(r).length?{af:r}:{}}function $u(t,e){let{dispatch:r}=t,a=pC(t,e);return{...a,synchronize(n){let o=SC(t),i=_u(t,o),s=_u(t,n);Vi(i,s)||!fC(t,s)||(a.synchronize(n),r(R({legacy:cC(i,s)})))},get state(){return{parameters:SC(t)}}}}function SC(t){let e=t.state;return{...Ap(t),...BI(e),...jI(e),...UI(e),..._I(e),...$I(e),...zI(e),...WI(e)}}function BI(t){if(t.query===void 0)return{};let e=t.query.enableQuerySyntax;return e!==void 0&&e!==Fe().enableQuerySyntax?{enableQuerySyntax:e}:{}}function jI(t){if(t.advancedSearchQueries===void 0)return{};let{aq:e,defaultFilters:r}=t.advancedSearchQueries;return e!==r.aq?{aq:e}:{}}function UI(t){if(t.advancedSearchQueries===void 0)return{};let{cq:e,defaultFilters:r}=t.advancedSearchQueries;return e!==r.cq?{cq:e}:{}}function _I(t){if(t.pagination===void 0)return{};let e=t.pagination.firstResult;return e!==dt().firstResult?{firstResult:e}:{}}function $I(t){if(t.pagination===void 0)return{};let{numberOfResults:e,defaultNumberOfResults:r}=t.pagination;return e!==r?{numberOfResults:e}:{}}function WI(t){if(t.staticFilterSet===void 0)return{};let e=Object.entries(t.staticFilterSet).map(([r,a])=>{let n=HI(a.values);return n.length?{[r]:n}:{}}).reduce((r,a)=>({...r,...a}),{});return Object.keys(e).length?{sf:e}:{}}function HI(t){return t.filter(e=>e.state==="selected").map(e=>e.caption)}function zI(t){if(t.debug===void 0)return{};let e=t.debug;return e!==Br()?{debug:e}:{}}var GI=()=>({buildWithProps:(t,e)=>{if(!YI(t))throw A;return $u(t,{initialState:e.initialState})}});function YI(t){return t.addReducers({advancedSearchQueries:Uu,automaticFacetSet:Qu,categoryFacetSet:pt,configuration:$n,dateFacetSet:mt,debug:jr,facetOptions:Oe,facetSet:ft,numericFacetSet:We,pagination:gt,query:He,sortCriteria:Po,staticFilterSet:Io,tabSet:ko}),!0}var Wu="&",ji="=",yC="..",Pp="...";function Hu(){return{serialize:KI,deserialize:rk}}function KI(t){return Object.entries(t).map(JI).filter(e=>e).join(Wu)}function JI(t){let[e,r]=t;return vC(e)?dk(e)?XI(r)?ek(e,r):"":e==="nf"||e==="df"?ZI(r)?tk(e,r):"":`${e}${ji}${encodeURIComponent(r)}`:""}function XI(t){return wp(t)?CC(t,r=>typeof r=="string"):!1}function ZI(t){return wp(t)?CC(t,r=>wp(r)&&"start"in r&&"end"in r):!1}function wp(t){return!!(t&&typeof t=="object")}function CC(t,e){return Object.entries(t).filter(a=>{let n=a[1];return!Array.isArray(n)||!n.every(e)}).length===0}function ek(t,e){return Object.entries(e).map(([r,a])=>`${t}-${r}${ji}${a.map(n=>encodeURIComponent(n)).join(",")}`).join(Wu)}function tk(t,e){return Object.entries(e).map(([r,a])=>{let n=a.map(({start:o,end:i,endInclusive:s})=>`${o}${s?Pp:yC}${i}`).join(",");return`${t}-${r}${ji}${n}`}).join(Wu)}function rk(t){return t.split(Wu).map(a=>ak(a)).map(nk).filter(ck).map(uk).reduce((a,n)=>{let[o,i]=n;if(FC(o)){let s={...a[o],...i};return{...a,[o]:s}}return{...a,[o]:i}},{})}function ak(t){let[e,...r]=t.split(ji),a=r.join(ji);return[e,a]}function nk(t){let[e,r]=t,n=/^(f|fExcluded|cf|nf|df|sf|af)-(.+)$/.exec(e);if(!n)return t;let o=n[1],i=n[2],s=r.split(","),c=ok(o,s),u={[i]:c};return[o,JSON.stringify(u)]}function ok(t,e){return t==="nf"?ik(e):t==="df"?sk(e):e}function ik(t){return t.map(e=>{let{startAsString:r,endAsString:a,isEndInclusive:n}=bC(e);return{start:parseFloat(r),end:parseFloat(a),endInclusive:n}}).filter(({start:e,end:r})=>Number.isFinite(e)&&Number.isFinite(r)).map(({start:e,end:r,endInclusive:a})=>mo({start:e,end:r,state:"selected",endInclusive:a}))}function xC(t){try{return Ng(t)?(Ls(t,Ci),!0):_t(t)?(ba(t),!0):!1}catch(e){return!1}}function sk(t){return t.map(e=>{let{isEndInclusive:r,startAsString:a,endAsString:n}=bC(e);return{start:a,end:n,endInclusive:r}}).filter(({start:e,end:r})=>xC(e)&&xC(r)).map(({start:e,end:r,endInclusive:a})=>Zr({start:e,end:r,state:"selected",endInclusive:a}))}function ck(t){let e=vC(t[0]),r=t.length===2;return e&&r}function vC(t){return t in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,f:!0,fExcluded:!0,cf:!0,nf:!0,df:!0,debug:!0,sf:!0,tab:!0,af:!0}}function uk(t){let[e,r]=t;return e==="enableQuerySyntax"?[e,r==="true"]:e==="debug"?[e,r==="true"]:e==="firstResult"?[e,parseInt(r)]:e==="numberOfResults"?[e,parseInt(r)]:FC(e)?[e,lk(r)]:[e,decodeURIComponent(r)]}function lk(t){let e=JSON.parse(t),r={};return Object.entries(e).forEach(a=>{let[n,o]=a;r[n]=o.map(i=>ln(i)?decodeURIComponent(i):i)}),r}function FC(t){return["f","fExcluded","cf","nf","df","sf","af"].includes(t)}function dk(t){return["f","af","cf","sf","fExcluded"].includes(t)}function bC(t){let e=t.indexOf(Pp)!==-1,[r,a]=t.split(e?Pp:yC);return{isEndInclusive:e,startAsString:r,endAsString:a}}var pk=new z({fragment:new b});function RC(t,e){let r;function a(){r=t.state.search.requestId}function n(){return r!==t.state.search.requestId}if(!mk(t))throw A;Pe(t,pk,e.initialState,"buildUrlManager");let o=N(t),i=e.initialState.fragment;a();let s=$u(t,{initialState:{parameters:zu(i)}});return{...o,subscribe(c){let u=()=>{let l=this.state.fragment;!fk(i,l)&&n()&&(i=l,c()),a()};return u(),t.subscribe(u)},get state(){return{fragment:Hu().serialize(s.state.parameters)}},synchronize(c){i=c;let u=zu(c);s.synchronize(u)}}}function fk(t,e){if(t===e)return!0;let r=zu(t),a=zu(e);return Vi(r,a)}function zu(t){return Hu().deserialize(t)}function mk(t){return t.addReducers({configuration:j}),!0}var gk=()=>({buildWithProps:(t,e)=>RC(t,{initialState:e.initialState})});function AC(t){return yo(t)}var hk=()=>({build:t=>AC(t)});async function Gu(t,e){var s;let{search:r,accessToken:a,organizationId:n,analytics:o}=t.configuration,i=((s=t.query)==null?void 0:s.q)||"";return{url:r.apiBaseUrl,accessToken:a,organizationId:n,enableNavigation:!1,...o.enabled&&{visitorId:await at(t.configuration.analytics)},q:i,...e,requestedOutputSize:e.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var $a=J("resultPreview/fetchResultContent",async(t,{extra:e,getState:r,rejectWithValue:a})=>{let n=r(),o=await Gu(n,t),i=await e.apiClient.html(o);return ye(i)?a(i.error):{content:i.success,uniqueId:t.uniqueId}}),No=h("resultPreview/next"),Mo=h("resultPreview/previous"),Lo=h("resultPreview/prepare",t=>y(t,{results:new H({required:!0})})),PC=2048,Qo=J("resultPreview/updateContentURL",async(t,{getState:e,extra:r})=>{let a=e(),n=pg(await t.buildResultPreviewRequest(a,{uniqueId:t.uniqueId,requestedOutputSize:t.requestedOutputSize}),t.path);return(n==null?void 0:n.length)>PC&&r.logger.error(`The content URL was truncated as it exceeds the maximum allowed length of ${PC} characters.`),{contentURL:n}});var wC=t=>w("analytics/resultPreview/open",(e,r)=>{ot(t);let a=Le(t,r),n=_e(t);return e.makeDocumentQuickview(a,n)});function Ep(){return{uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]}}var Ip=t=>{let{content:e,isLoading:r,uniqueId:a,contentURL:n}=Ep();t.content=e,t.isLoading=r,t.uniqueId=a,t.contentURL=n},kp=t=>t.filter(e=>e.hasHtmlVersion).map(e=>e.uniqueId),Yu=O(Ep(),t=>{t.addCase($a.pending,e=>{e.isLoading=!0}).addCase($a.fulfilled,(e,r)=>{let{content:a,uniqueId:n}=r.payload;e.position=e.resultsWithPreview.indexOf(n),e.content=a,e.uniqueId=n,e.isLoading=!1}).addCase(R.fulfilled,(e,r)=>{Ip(e),e.resultsWithPreview=kp(r.payload.response.results)}).addCase(Wr.fulfilled,(e,r)=>{Ip(e),e.resultsWithPreview=e.resultsWithPreview.concat(kp(r.payload.response.results))}).addCase($t.fulfilled,Ip).addCase(Lo,(e,r)=>{e.resultsWithPreview=kp(r.payload.results)}).addCase(No,e=>{if(e.isLoading)return;let r=e.position+1;r>e.resultsWithPreview.length-1&&(r=0),e.position=r}).addCase(Mo,e=>{if(e.isLoading)return;let r=e.position-1;r<0&&(r=e.resultsWithPreview.length-1),e.position=r}).addCase(Qo.fulfilled,(e,r)=>{e.contentURL=r.payload.contentURL})});function EC(t,e,r,a,n){if(!Sk(t))throw A;let{dispatch:o}=t,i=()=>t.state,s=N(t),{result:c,maximumPreviewSize:u}=e.options,l=()=>{let{resultsWithPreview:f,position:p}=i().resultPreview;return f[p]},d=f=>{o(Qo({uniqueId:f,requestedOutputSize:u,buildResultPreviewRequest:r,path:a})),e.options.onlyContentURL||o($a({uniqueId:f,requestedOutputSize:u})),n&&n()};return{...s,fetchResultContent(){d(c.uniqueId)},next(){o(No()),d(l())},previous(){o(Mo()),d(l())},get state(){let f=i(),p=c.hasHtmlVersion,m=f.resultPreview,S=c.uniqueId===m.uniqueId?m.content:"",v=m.isLoading,C=m.contentURL,F=l();return{content:S,resultHasPreview:p,isLoading:v,contentURL:C,currentResultUniqueId:F}}}}function Sk(t){return t.addReducers({configuration:j,resultPreview:Yu}),!0}function IC(t,e){if(!yk(t))throw A;let{dispatch:r}=t,a=()=>t.state,n=()=>a().search.results,s=EC(t,e,Gu,"/html",()=>{t.dispatch(wC(e.options.result))});return r(Lo({results:n()})),{...s,get state(){return{...s.state,currentResult:n().findIndex(c=>c.uniqueId===s.state.currentResultUniqueId)+1,totalResults:n().length}}}}function yk(t){return t.addReducers({search:W}),!0}var Ck=t=>({build:e=>IC(e,t)});var xk=t=>w("analytics/folding/showMore",(e,r)=>(ot(t),e.makeShowMoreFoldedResults(Le(t,r),_e(t)))),vk=()=>w("analytics/folding/showLess",t=>t.makeShowLessFoldedResults()),kC={logShowMoreFoldedResults:xk,logShowLessFoldedResults:vk};function Fk(t,e){return t.raw[e.collection]}function Op(t,e){return t.raw[e.parent]}function Ui(t,e){let r=t.raw[e.child];return ts(r)?r[0]:r}function bk(t,e){return(t||e)!==void 0&&t===e}function OC(t,e,r,a=[]){let n=Ui(t,r);return n?a.indexOf(n)!==-1?[]:e.filter(o=>{let i=Ui(o,r)===Ui(t,r);return Op(o,r)===n&&!i}).map(o=>({result:o,children:OC(o,e,r,[...a,n])})):[]}function Rk(t,e){return t.find(r=>{let a=Op(r,e)===void 0,n=bk(Op(r,e),Ui(r,e));return a||n})}function qC(t){return t.parentResult?qC(t.parentResult):t}function Ak(t,e,r){var o;let a=ws(t),n=(o=r!=null?r:Rk(a,e))!=null?o:qC(t);return{result:n,children:OC(n,a,e),moreResultsAvailable:!0,isLoadingMoreResults:!1}}function Ku(t,e,r){let a={};return t.forEach(n=>{let o=Fk(n,e);!o||!Ui(n,e)&&!n.parentResult||(a[o]=Ak(n,e,r))}),a}function TC(t,e){if(!t.collections[e])throw new Error(`Missing collection ${e} from ${Object.keys(t.collections)}: Folding most probably in an invalid state...`);return t.collections[e]}var Ju=O(pc(),t=>t.addCase(R.fulfilled,(e,{payload:r})=>{e.collections=e.enabled?Ku(r.response.results,e.fields):{}}).addCase($t.fulfilled,(e,{payload:r})=>{e.collections=e.enabled?Ku(r.response.results,e.fields):{}}).addCase(Wr.fulfilled,(e,{payload:r})=>{e.collections=e.enabled?{...e.collections,...Ku(r.response.results,e.fields)}:{}}).addCase(zr,(e,{payload:r})=>{var a,n,o,i;return e.enabled?e:{enabled:!0,collections:{},fields:{collection:(a=r.collectionField)!=null?a:e.fields.collection,parent:(n=r.parentField)!=null?n:e.fields.parent,child:(o=r.childField)!=null?o:e.fields.child},filterFieldRange:(i=r.numberOfFoldedResults)!=null?i:e.filterFieldRange}}).addCase(Gr.pending,(e,{meta:r})=>{let a=r.arg;TC(e,a).isLoadingMoreResults=!0}).addCase(Gr.rejected,(e,{meta:r})=>{let a=r.arg;TC(e,a).isLoadingMoreResults=!1}).addCase(Gr.fulfilled,(e,{payload:{collectionId:r,results:a,rootResult:n}})=>{let o=Ku(a,e.fields,n);if(!o||!o[r])throw new Error(`Unable to create collection ${r} from received results: ${JSON.stringify(a)}. Folding most probably in an invalid state... `);e.collections[r]=o[r],e.collections[r].moreResultsAvailable=!1}));var Pk=new z(ap);function DC(t,e,r){var s;if(!wk(t))throw A;let a=Fu(t,e),{dispatch:n}=t,o=()=>t.state,i=((s=e.options)==null?void 0:s.folding)?de(t,Pk,e.options.folding,"buildFoldedResultList"):{};return n(zr({...i})),{...a,loadCollection:c=>{n(e.loadCollectionActionCreator(c.result.raw[t.state.folding.fields.collection])),n(r.logShowMoreFoldedResults(c.result))},logShowMoreFoldedResults:c=>{n(r.logShowMoreFoldedResults(c))},logShowLessFoldedResults:()=>{n(r.logShowLessFoldedResults())},findResultById(c){return qp(this.state.results,u=>u.result.uniqueId===c.result.uniqueId)},findResultByCollection(c){return qp(this.state.results,u=>u.result.raw.foldingcollection===c.result.raw.foldingcollection)},get state(){let c=o();return{...a.state,results:a.state.results.map(u=>{let l=u.raw[c.folding.fields.collection];return!l||!c.folding.collections[l]?{result:u,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}:c.folding.collections[l]})}}}}function wk(t){return t.addReducers({search:W,configuration:$n,folding:Ju,query:He}),!0}function qp(t,e){for(let r=0;r<t.length;r++){let a=t[r];if(e(a))return a;if(a.children.length){let n=qp(a.children,e);if(n)return n}}return null}function VC(t,e={}){let r=DC(t,{...e,loadCollectionActionCreator:Gr,fetchMoreResultsActionCreator:Wr},kC);return{...r,get state(){return r.state}}}var Ek=t=>({build:e=>VC(e,t)});var NC=()=>({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}});var pa=O(NC(),t=>t.addCase(R.pending,e=>{e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore}}).addCase(R.fulfilled,(e,r)=>{var s;let a=[],n=[],o=[],i=[];r.payload.response.triggers.forEach(c=>{switch(c.type){case"redirect":a.push(c.content);break;case"query":n.push(c.content);break;case"execute":o.push({functionName:c.content.name,params:c.content.params});break;case"notify":i.push(c.content);break}}),e.redirectTo=(s=a[0])!=null?s:"",e.query=e.queryModification.newQuery,e.executions=o,e.notifications=i}).addCase(Mn,(e,r)=>{e.queryModification={...r.payload,queryToIgnore:""}}).addCase($r,(e,r)=>{e.queryModification.queryToIgnore=r.payload}));function MC(t){if(!Ik(t))throw A;let e=N(t),{dispatch:r}=t,a=()=>t.state,n=a().triggers.redirectTo;return{...e,subscribe(o){let i=()=>{let s=n!==this.state.redirectTo;n=this.state.redirectTo,s&&this.state.redirectTo&&(o(),r(tc()))};return i(),t.subscribe(i)},get state(){return{redirectTo:a().triggers.redirectTo}}}}function Ik(t){return t.addReducers({triggers:pa}),!0}var kk=()=>({build:t=>MC(t)});function LC(t){if(!Ok(t))throw A;let e=N(t),{dispatch:r}=t,a=()=>t.state,n=()=>a().triggers.queryModification.newQuery,o=()=>a().triggers.queryModification.originalQuery;return{...e,get state(){return{newQuery:n(),originalQuery:o(),wasQueryModified:n()!==""}},undo(){r($r(n())),r(Qe({q:o()})),r(R({legacy:Zs({undoneQuery:n()}),next:{actionCause:T.undoTriggerQuery,getEventExtraPayload:()=>new L(a).getUndoTriggerQueryMetadata(n())}}))}}}function Ok(t){return t.addReducers({triggers:pa,query:He}),!0}var qk=()=>({build:t=>LC(t)});function QC(t){if(!Tk(t))throw A;let e=N(t),{dispatch:r}=t,a=()=>t.state,n=a().triggers.executions;return{...e,subscribe(o){let i=()=>{let s=!ja(this.state.executions,n,(c,u)=>c.functionName===u.functionName&&ja(c.params,u.params));n=this.state.executions,s&&this.state.executions.length&&(o(),r(rc()))};return i(),t.subscribe(i)},get state(){return{executions:a().triggers.executions}}}}function Tk(t){return t.addReducers({triggers:pa}),!0}var Dk=()=>({build:t=>QC(t)});function BC(t){if(!Vk(t))throw A;let e=N(t),{dispatch:r}=t,a=()=>t.state,n=a().triggers.notifications;return{...e,subscribe(o){let i=()=>{let s=!ja(n,this.state.notifications);n=this.state.notifications,s&&(o(),r(ec()))};return i(),t.subscribe(i)},get state(){return{notifications:a().triggers.notifications}}}}function Vk(t){return t.addReducers({triggers:pa}),!0}var Nk=()=>({build:t=>BC(t)});var Xu=()=>new E({values:{questionAnswerId:P},options:{required:!0}}),Tp=()=>new E({values:{linkText:le,linkURL:le},options:{required:!0}});function Bo(t){return y(t,Xu())}function wr(t,e){var a,n;let r=e!=null?e:(n=(a=t.search)==null?void 0:a.questionAnswer)==null?void 0:n.documentId;return r&&t.search&&oh(t,r.contentIdKey,r.contentIdValue)}function Wa(t,e){var n,o,i,s,c;let r=(o=(n=t.questionAnswering)==null?void 0:n.relatedQuestions.findIndex(u=>u.questionAnswerId===e))!=null?o:-1;if(r===-1)return null;let a=(c=(s=(i=t.search)==null?void 0:i.questionAnswer)==null?void 0:s.relatedQuestions)==null?void 0:c[r];return a!=null?a:null}var Dp=()=>w("analytics/smartSnippet/expand",t=>t.makeExpandSmartSnippet()),Vp=()=>w("analytics/smartSnippet/collapse",t=>t.makeCollapseSmartSnippet()),Np=()=>w("analytics/smartSnippet/like",t=>t.makeLikeSmartSnippet()),Mp=()=>w("analytics/smartSnippet/dislike",t=>t.makeDislikeSmartSnippet());function Lp(){return w("analytics/smartSnippet/source/open",(t,e)=>{let r=wr(e);return t.makeOpenSmartSnippetSource(Le(r,e),_e(r))})}var _i=t=>w("analytics/smartSnippet/source/open",(e,r)=>{y(t,Tp());let a=wr(r);return e.makeOpenSmartSnippetInlineLink(Le(a,r),{..._e(a),...t})}),Qp=()=>w("analytics/smartSnippet/feedbackModal/open",t=>t.makeOpenSmartSnippetFeedbackModal()),Bp=()=>w("analytics/smartSnippet/feedbackModal/close",t=>t.makeCloseSmartSnippetFeedbackModal()),jp=t=>w("analytics/smartSnippet/sendFeedback",e=>e.makeSmartSnippetFeedbackReason(t)),Up=t=>w("analytics/smartSnippet/sendFeedback",e=>e.makeSmartSnippetFeedbackReason("other",t)),_p=t=>w("analytics/smartSnippetSuggestion/expand",(e,r)=>{Bo(t);let a=Wa(r,t.questionAnswerId);return a?e.makeExpandSmartSnippetSuggestion({question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId}):null}),$p=t=>w("analytics/smartSnippetSuggestion/expand",(e,r)=>{Bo(t);let a=Wa(r,t.questionAnswerId);return a?e.makeCollapseSmartSnippetSuggestion({question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId}):null}),$i=t=>w("analytics/smartSnippet/source/open",(e,r)=>{y(t,Xu());let a=Wa(r,t.questionAnswerId);if(!a)return null;let n=wr(r,a.documentId);return n?e.makeOpenSmartSnippetSuggestionSource(Le(n,r),{question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId}):null}),Zu=(t,e)=>w("analytics/smartSnippet/source/open",(r,a)=>{y(t,Xu()),y(e,Tp());let n=Wa(a,t.questionAnswerId);if(!n)return null;let o=wr(a,n.documentId);return o?r.makeOpenSmartSnippetSuggestionInlineLink(Le(o,a),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId,linkText:e.linkText,linkURL:e.linkURL}):null}),el={logExpandSmartSnippet:Dp,logCollapseSmartSnippet:Vp,logLikeSmartSnippet:Np,logDislikeSmartSnippet:Mp,logOpenSmartSnippetSource:Lp,logOpenSmartSnippetInlineLink:_i,logOpenSmartSnippetFeedbackModal:Qp,logCloseSmartSnippetFeedbackModal:Bp,logSmartSnippetFeedback:jp,logSmartSnippetDetailedFeedback:Up,logExpandSmartSnippetSuggestion:_p,logCollapseSmartSnippetSuggestion:$p,logOpenSmartSnippetSuggestionSource:$i};var jo=h("smartSnippet/expand"),Uo=h("smartSnippet/collapse"),_o=h("smartSnippet/like"),$o=h("smartSnippet/dislike"),Wo=h("smartSnippet/feedbackModal/open"),fa=h("smartSnippet/feedbackModal/close"),Ho=h("smartSnippet/related/expand",t=>Bo(t)),zo=h("smartSnippet/related/collapse",t=>Bo(t));var Wp=()=>({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]});var jC=(t,e)=>t.findIndex(r=>r.questionAnswerId===e.questionAnswerId);function UC({question:t,answerSnippet:e,documentId:{contentIdKey:r,contentIdValue:a}}){return as({question:t,answerSnippet:e,contentIdKey:r,contentIdValue:a})}function Mk(t,e){let r=UC(t);return e&&r===e.questionAnswerId?e:{contentIdKey:t.documentId.contentIdKey,contentIdValue:t.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}var ur=O(Wp(),t=>t.addCase(jo,e=>{e.expanded=!0}).addCase(Uo,e=>{e.expanded=!1}).addCase(_o,e=>{e.liked=!0,e.disliked=!1,e.feedbackModalOpen=!1}).addCase($o,e=>{e.liked=!1,e.disliked=!0}).addCase(Wo,e=>{e.feedbackModalOpen=!0}).addCase(fa,e=>{e.feedbackModalOpen=!1}).addCase(R.fulfilled,(e,r)=>{let a=r.payload.response.questionAnswer.relatedQuestions.map((o,i)=>Mk(o,e.relatedQuestions[i])),n=UC(r.payload.response.questionAnswer);return e.questionAnswerId===n?{...e,relatedQuestions:a}:{...Wp(),relatedQuestions:a,questionAnswerId:n}}).addCase(Ho,(e,r)=>{let a=jC(e.relatedQuestions,r.payload);a!==-1&&(e.relatedQuestions[a].expanded=!0)}).addCase(zo,(e,r)=>{let a=jC(e.relatedQuestions,r.payload);a!==-1&&(e.relatedQuestions[a].expanded=!1)}));var Lk={results:new H({required:!0,each:new E({values:hn})}),maxLength:new I({required:!0,min:1,default:10})},Go=h("recentResults/registerRecentResults",t=>y(t,Lk)),ma=h("recentResults/pushRecentResult",t=>(ot(t),{payload:t})),Yo=h("recentResults/clearRecentResults");function Ko(t,e,r){if(!Qk(t))throw A;let a=1e3,n={selectionDelay:a,debounceWait:a,...e.options},o;return{select:sc(r,n.debounceWait,{isImmediate:!0}),beginDelayedSelect(){o=setTimeout(r,n.selectionDelay)},cancelPendingSelect(){o&&clearTimeout(o)}}}function Qk(t){return t.addReducers({configuration:j}),!0}function _C(t,e,r){var c;if(!Bk(t))throw A;let a=N(t),n=()=>t.state,o=()=>wr(n()),i=null,s=Ko(t,{options:{selectionDelay:(c=r==null?void 0:r.options)==null?void 0:c.selectionDelay}},()=>{let u=o();if(!u){i=null;return}let{searchResponseId:l}=n().search;i!==l&&(i=l,t.dispatch(e.logOpenSmartSnippetSource()),t.dispatch(ma(u)))});return{...a,get state(){let u=n();return{question:u.search.questionAnswer.question,answer:u.search.questionAnswer.answerSnippet,documentId:u.search.questionAnswer.documentId,expanded:u.questionAnswering.expanded,answerFound:u.search.questionAnswer.answerSnippet!=="",liked:u.questionAnswering.liked,disliked:u.questionAnswering.disliked,feedbackModalOpen:u.questionAnswering.feedbackModalOpen,source:o()}},expand(){t.dispatch(e.logExpandSmartSnippet()),t.dispatch(jo())},collapse(){t.dispatch(e.logCollapseSmartSnippet()),t.dispatch(Uo())},like(){t.dispatch(e.logLikeSmartSnippet()),t.dispatch(_o())},dislike(){t.dispatch(e.logDislikeSmartSnippet()),t.dispatch($o())},openFeedbackModal(){t.dispatch(e.logOpenSmartSnippetFeedbackModal()),t.dispatch(Wo())},closeFeedbackModal(){t.dispatch(e.logCloseSmartSnippetFeedbackModal()),t.dispatch(fa())},sendFeedback(u){t.dispatch(e.logSmartSnippetFeedback(u)),t.dispatch(fa())},sendDetailedFeedback(u){t.dispatch(e.logSmartSnippetDetailedFeedback(u)),t.dispatch(fa())},selectSource(){s.select()},beginDelayedSelectSource(){s.beginDelayedSelect()},cancelPendingSelectSource(){s.cancelPendingSelect()}}}function Bk(t){return t.addReducers({search:W,questionAnswering:ur}),!0}function tl(t,e){if(!jk(t))throw A;let r=()=>t.state,a=new Set,n=l=>a.has(l)?!0:(a.add(l),!1),o=null,i=l=>{o!==l&&(o=l,c={},a.clear())},s=(l,d,f)=>{var p;return Ko(t,{options:{selectionDelay:(p=e==null?void 0:e.options)==null?void 0:p.selectionDelay}},()=>{n(d)||t.dispatch(f?Zu({questionAnswerId:f},l):_i(l))})},c={},u=(l,d)=>{let{searchResponseId:f}=r().search;i(f);let p=as({...l,questionAnswerId:d});return p in c||(c[p]=s(l,p,d)),c[p]};return{selectInlineLink(l,d){var f;(f=u(l,d))==null||f.select()},beginDelayedSelectInlineLink(l,d){var f;(f=u(l,d))==null||f.beginDelayedSelect()},cancelPendingSelectInlineLink(l,d){var f;(f=u(l,d))==null||f.cancelPendingSelect()}}}function jk(t){return t.addReducers({search:W,questionAnswering:ur}),!0}function $C(t,e){var n;let r=_C(t,el,e),a=tl(t,{options:{selectionDelay:(n=e==null?void 0:e.options)==null?void 0:n.selectionDelay}});return{...r,get state(){return r.state},selectInlineLink(o){a.selectInlineLink(o)},beginDelayedSelectInlineLink(o){a.beginDelayedSelectInlineLink(o)},cancelPendingSelectInlineLink(o){a.cancelPendingSelectInlineLink(o)}}}var Uk=t=>({build:e=>$C(e,t)});function WC(t,e){if(!_k(t))throw A;let r=N(t),a=()=>t.state,n=o=>{let{contentIdKey:i,contentIdValue:s}=o;return t.state.search.results.find(c=>vr(c,i)===s)};return{...r,get state(){let o=a();return{questions:o.search.questionAnswer.relatedQuestions.map((i,s)=>({question:i.question,answer:i.answerSnippet,documentId:i.documentId,questionAnswerId:o.questionAnswering.relatedQuestions[s].questionAnswerId,expanded:o.questionAnswering.relatedQuestions[s].expanded,source:n(i.documentId)}))}},expand(o){let i={questionAnswerId:o};t.dispatch(e.logExpandSmartSnippetSuggestion(i)),t.dispatch(Ho(i))},collapse(o){let i={questionAnswerId:o};t.dispatch(e.logCollapseSmartSnippetSuggestion(i)),t.dispatch(zo(i))}}}function _k(t){return t.addReducers({search:W,questionAnswering:ur}),!0}function HC(t,e){if(!$k(t))throw A;let r=()=>t.state,a=d=>{let f=r(),p=Wa(f,d);return p?wr(f,p.documentId):null},n=new Set,o=d=>n.has(d)?!0:(n.add(d),!1),i=null,s=d=>{i!==d&&(i=d,u={},n.clear())},c=(d,f)=>{var p;return Ko(t,{options:{selectionDelay:(p=e==null?void 0:e.options)==null?void 0:p.selectionDelay}},()=>{o(f)||(t.dispatch($i({questionAnswerId:f})),t.dispatch(ma(d)))})},u={},l=d=>{let{searchResponseId:f}=r().search;s(f);let p=a(d);return p?(d in u||(u[d]=c(p,d)),u[d]):null};return{selectSource(d){var f;(f=l(d))==null||f.select()},beginDelayedSelectSource(d){var f;(f=l(d))==null||f.beginDelayedSelect()},cancelPendingSelectSource(d){var f;(f=l(d))==null||f.cancelPendingSelect()}}}function $k(t){return t.addReducers({search:W,questionAnswering:ur}),!0}function zC(t,e){var o,i;let r=WC(t,el),a=tl(t,{options:{selectionDelay:(o=e==null?void 0:e.options)==null?void 0:o.selectionDelay}}),n=HC(t,{options:{selectionDelay:(i=e==null?void 0:e.options)==null?void 0:i.selectionDelay}});return{...r,get state(){return r.state},selectSource(s){n.selectSource(s)},beginDelayedSelectSource(s){n.beginDelayedSelectSource(s)},cancelPendingSelectSource(s){n.cancelPendingSelectSource(s)},selectInlineLink(s,c){a.selectInlineLink(c,s)},beginDelayedSelectInlineLink(s,c){a.beginDelayedSelectInlineLink(c,s)},cancelPendingSelectInlineLink(s,c){a.cancelPendingSelectInlineLink(c,s)}}}var Wk=t=>({build:e=>zC(e,t)});var Hk={queries:new H({required:!0,each:new b({emptyAllowed:!1})}),maxLength:new I({required:!0,min:1,default:10})},Jo=h("recentQueries/registerRecentQueries",t=>y(t,Hk)),Xo=h("recentQueries/clearRecentQueries");var GC=()=>w("analytics/recentQueries/clear",t=>t.makeClearRecentQueries()),YC=()=>w("analytics/recentQueries/click",t=>t.makeRecentQueryClick());function KC(){return{queries:[],maxLength:10}}var rl=O(KC(),t=>{t.addCase(Jo,(e,r)=>{e.queries=r.payload.queries.slice(0,r.payload.maxLength),e.maxLength=r.payload.maxLength}).addCase(Xo,e=>{e.queries=[]}).addCase(R.fulfilled,(e,r)=>{let a=r.payload.queryExecuted.trim(),n=r.payload.response.results;if(!a.length||!n.length)return;e.queries=e.queries.filter(i=>i!==a);let o=e.queries.slice(0,e.maxLength-1);e.queries=[a,...o]})});var zk={queries:[]},Gk={maxLength:10,clearFilters:!0},Yk=new z({queries:new H({required:!0})}),Kk=new z({maxLength:new I({required:!0,min:1}),clearFilters:new $});function Jk(t,e){de(t,Kk,e==null?void 0:e.options,"buildRecentQueriesList"),Pe(t,Yk,e==null?void 0:e.initialState,"buildRecentQueriesList")}function JC(t,e){if(!Xk(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o={...Gk,...e==null?void 0:e.options},i={...zk,...e==null?void 0:e.initialState};Jk(t,{options:o,initialState:i});let s={queries:i.queries,maxLength:o.maxLength};return a(Jo(s)),{...r,get state(){let c=n();return{...c.recentQueries,analyticsEnabled:c.configuration.analytics.enabled}},clear(){a(GC()),a(Xo())},executeRecentQuery(c){let u=new I({required:!0,min:0,max:this.state.queries.length}).validate(c);if(u)throw new Error(u);a(oc({q:this.state.queries[c],clearFilters:o.clearFilters})),a(R({legacy:YC(),next:{actionCause:T.recentQueryClick,getEventExtraPayload:l=>new L(()=>l).getBaseMetadata()}}))}}}function Xk(t){return t.addReducers({search:W,recentQueries:rl}),!0}var Zk=t=>({build:e=>JC(e,t)});var XC=()=>w("analytics/recentResults/clear",t=>t.makeClearRecentResults());function ZC(){return{results:[],maxLength:10}}var al=O(ZC(),t=>{t.addCase(Go,(e,r)=>{e.results=r.payload.results.slice(0,r.payload.maxLength),e.maxLength=r.payload.maxLength}).addCase(Yo,e=>{e.results=[]}).addCase(ma,(e,r)=>{let a=r.payload;e.results=e.results.filter(o=>o.uniqueId!==a.uniqueId);let n=e.results.slice(0,e.maxLength-1);e.results=[a,...n]})});var eO={initialState:{results:[]},options:{maxLength:10}},tO=new z({results:new H({required:!0})}),rO=new z({maxLength:new I({required:!0,min:1})});function aO(t,e){de(t,rO,e==null?void 0:e.options,"buildRecentResultsList"),Pe(t,tO,e==null?void 0:e.initialState,"buildRecentResultsList")}function ex(t,e){if(!nO(t))throw A;let r=N(t),{dispatch:a}=t,n=()=>t.state,o={...eO,...e};aO(t,o);let i={results:o.initialState.results,maxLength:o.options.maxLength};return a(Go(i)),{...r,get state(){return n().recentResults},clear(){a(XC()),a(Yo())}}}function nO(t){return t.addReducers({recentResults:al}),!0}var oO=t=>({build:e=>ex(e,t)});function tx(t,e){if(!iO(t))throw A;let{facetSearch:r,allowedValues:a,...n}=e.options.facet,o=Be(t,n);t.dispatch(tr({...Ti,...n,facetId:o,...a&&{allowedValues:{type:"simple",values:a}}}));let i=$c(t,{options:{...r,facetId:o},select:c=>{t.dispatch(re()),t.dispatch(R({legacy:be({facetId:o,facetValue:c.rawValue}),next:{actionCause:T.facetSelect,getEventExtraPayload:u=>new L(()=>u).getFacetMetadata(o,c.rawValue)}}))},exclude:c=>{t.dispatch(re()),t.dispatch(R({legacy:Pt({facetId:o,facetValue:c.rawValue}),next:{actionCause:T.facetExclude,getEventExtraPayload:u=>new L(()=>u).getFacetMetadata(o,c.rawValue)}}))},isForFieldSuggestions:!0});return{...N(t),...i,updateText:function(c){i.updateText(c),i.search()},get state(){return i.state}}}function iO(t){return t.addReducers({facetSet:ft,configuration:j,facetSearchSet:lo,search:W}),!0}var sO=t=>({build:e=>tx(e,t)});function rx(t,e){if(!cO(t))throw A;let{facetSearch:r,...a}=e.options.facet,n=Be(t,a);t.dispatch(Ht({...ki,...a,facetId:n}));let o=Mc(t,{options:{...r,facetId:n},isForFieldSuggestions:!0});return{...N(t),...o,updateText:function(s){o.updateText(s),o.search()},get state(){return o.state}}}function cO(t){return t.addReducers({categoryFacetSet:pt,configuration:j,categoryFacetSearchSet:ro,search:W}),!0}var uO=t=>({build:e=>rx(e,t)});function ax(t,e){let{dispatch:r}=t,a=N(t),{field:n}=e;return{...a,toggleSelect(o){r(na({field:n,selection:o})),r(R({legacy:Uc(n,o),next:_c(n,o)}))},deselectAll(){r(yu(n)),r(R({legacy:ke(n),next:{actionCause:T.facetClearAll,getEventExtraPayload:o=>new L(()=>o).getFacetClearAllMetadata(n)}}))},get state(){var s,c;let o=(c=(s=t.state.automaticFacetSet)==null?void 0:s.set[n])==null?void 0:c.response;return o?{field:o.field,label:o.label,values:o.values}:{field:"",values:[],label:""}}}}function nx(t){return{desiredCount:t.desiredCount,numberOfValues:t.numberOfValues}}function ox(t,e){if(!lO(t))throw A;let{dispatch:r}=t,a=nx(e.options);return r(Su(a)),{...N(t),get state(){var i,s;return{automaticFacets:(s=(i=t.state.search.response.generateAutomaticFacets)==null?void 0:i.facets.map(c=>ax(t,{field:c.field})))!=null?s:[]}}}}function lO(t){return t.addReducers({automaticFacetSet:Qu,configuration:j,search:W}),!0}var dO=t=>({build:e=>ox(e,t)});function Jle(t){return t.addReducers({advancedSearchQueries:Uu}),{updateAdvancedSearchQueries:Bu,registerAdvancedSearchQueries:ju}}function cde(t){return t.addReducers({categoryFacetSet:pt}),{deselectAllCategoryFacetValues:zt,registerCategoryFacet:Ht,toggleSelectCategoryFacetValue:Kr,updateCategoryFacetNumberOfValues:qa,updateCategoryFacetSortCriterion:eo,updateFacetAutoSelection:st,updateCategoryFacetBasePath:xc}}function xde(t){return t.addReducers({facetSet:ft}),{deselectAllFacetValues:me,registerFacet:tr,toggleSelectFacetValue:rr,toggleExcludeFacetValue:Xr,updateFacetIsFieldExpanded:Na,updateFacetNumberOfValues:Va,updateFacetSortCriterion:so,updateFreezeCurrentValues:Ma,updateFacetAutoSelection:st}}function Ide(t){return t.addReducers({configuration:j}),{disableAnalytics:Sn,enableAnalytics:yn,setOriginLevel2:Os,setOriginLevel3:qs,updateAnalyticsConfiguration:Lr,updateBasicConfiguration:jt}}function Nde(t){return t.addReducers({configuration:j,pipeline:vn,searchHub:bn}),{updateSearchConfiguration:it}}function jde(t){return t.addReducers({context:fc}),{addContext:ka,removeContext:Oa,setContext:Ia}}function Hde(t){return t.addReducers({dictionaryFieldContext:gc}),{addContext:Gn,removeContext:Yn,setContext:zn}}function Kde(t){return t.addReducers({debug:jr}),{disableDebug:Cn,enableDebug:Qr}}function npe(t){return t.addReducers({dateFacetSet:mt}),{deselectAllDateFacetValues:Tc,registerDateFacet:ar,toggleSelectDateFacetValue:nr,toggleExcludeDateFacetValue:ea,updateDateFacetSortCriterion:qc,updateDateFacetValues:br}}function dpe(t){return t.addReducers({facetOptions:Oe}),{updateFacetOptions:re,enableFacet:$e,disableFacet:xe}}function hpe(t){return t.addReducers({didYouMean:Sc,query:He}),{applyDidYouMeanCorrection:lt,disableDidYouMean:Bs,enableDidYouMean:Dn,enableAutomaticQueryCorrection:js,disableAutomaticQueryCorrection:Vn}}function xpe(t){return t.addReducers({fields:Yr}),{registerFieldsToInclude:Hr,enableFetchAllFields:Wn,disableFetchAllFields:Ea,fetchFieldsDescription:Hn}}function Ape(t){return t.addReducers({history:hu,facetOrder:du}),{back:yi,forward:Ds}}function Tpe(t){return t.addReducers({numericFacetSet:We}),{deselectAllNumericFacetValues:Nc,registerNumericFacet:or,toggleSelectNumericFacetValue:ir,toggleExcludeNumericFacetValue:ta,updateNumericFacetSortCriterion:Vc,updateNumericFacetValues:Rr}}function Bpe(t){return t.addReducers({folding:Ju}),{registerFolding:zr,loadCollection:Gr}}function $pe(t){return t.addReducers({pagination:gt}),{nextPage:In,previousPage:kn,registerNumberOfResults:Pn,registerPage:En,updateNumberOfResults:wn,updatePage:ct}}function Gpe(t){return t.addReducers({pipeline:vn}),{setPipeline:xn}}function Zpe(t){return t.addReducers({query:He}),{updateQuery:Qe}}function ofe(t){return t.addReducers({querySet:vo}),{registerQuerySetQuery:xo,updateQuerySetQuery:Ua}}function mfe(t){return t.addReducers({instantResults:Pu}),{registerInstantResults:Rn,updateInstantResultsQuery:Ut,clearExpiredResults:An}}function Afe(t){return t.addReducers({querySuggest:Fo,querySet:vo}),{clearQuerySuggest:ia,fetchQuerySuggestions:sa,registerQuerySuggest:Co,selectQuerySuggestion:cr}}function Ofe(t){return t.addReducers({search:W}),{executeSearch:Ln,fetchMoreResults:Bn,fetchFacetValues:ac,fetchPage:Qn,fetchInstantResults:Kg}}function Vfe(t){return t.addReducers({searchHub:bn}),{setSearchHub:Fn}}function Qfe(t){return t.addReducers({sortCriteria:Po}),{registerSortCriterion:Ro,updateSortCriterion:Ao}}function Yfe(t){return t.addReducers({standaloneSearchBoxSet:Lu}),{registerStandaloneSearchBox:Oo,fetchRedirectUrl:la,updateAnalyticsToSearchFromLink:To,updateAnalyticsToOmniboxFromLink:Do,resetStandaloneSearchBox:qo}}function tme(t){return t.addReducers({staticFilterSet:Io}),{registerStaticFilter:wo,toggleSelectStaticFilterValue:Ar,toggleExcludeStaticFilterValue:Pr,deselectAllStaticFilterValues:ua}}function ime(t){return t.addReducers({tabSet:ko}),{registerTab:Un,updateActiveTab:Rt}}function lme(t){return t.addReducers({questionAnswering:ur}),{collapseSmartSnippet:Uo,expandSmartSnippet:jo,dislikeSmartSnippet:$o,likeSmartSnippet:_o,openFeedbackModal:Wo,closeFeedbackModal:fa,expandSmartSnippetRelatedQuestion:Ho,collapseSmartSnippetRelatedQuestion:zo}}function fme(t){return t.addReducers({}),{deselectAllBreadcrumbs:Ce,deselectAllNonBreadcrumbs:Ur}}function yme(t){return t.addReducers({recentQueries:rl}),{registerRecentQueries:Jo,clearRecentQueries:Xo}}function bme(t){return t.addReducers({recentResults:al}),{registerRecentResults:Go,clearRecentResults:Yo,pushRecentResult:ma}}var nl=h("excerptLength/set",t=>y(t,new I({min:0,required:!0})));function ix(){return{length:void 0}}var sx=O(ix(),t=>{t.addCase(nl,(e,r)=>{e.length=r.payload})});function Nme(t){return t.addReducers({excerptLength:sx}),{setExcerptLength:nl}}function Wme(t){return t.addReducers({resultPreview:Yu}),{fetchResultContent:$a,updateContentURL:Qo,nextPreview:No,previousPreview:Mo,preparePreviewPagination:Lo}}function cx(t){var e,r,a;return(a=(r=(e=t.search)==null?void 0:e.response)==null?void 0:r.extendedResults)==null?void 0:a.generativeQuestionAnsweringId}var ux=t=>w("analytics/generatedAnswer/streamEnd",(e,r)=>{let a=cx(r);return a?e.makeGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:a,answerGenerated:t}):null});var lx=async t=>{var e;return{accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.platformUrl,streamId:(e=t.search.extendedResults)==null?void 0:e.generativeQuestionAnsweringId}};var dx=["default","bullet","step","concise"];var Wi=new b({required:!0}),px=new b,Hp=new $({required:!0}),pO={id:Wi,title:Wi,uri:Wi,permanentid:Wi,clickUri:px},fx=h("generatedAnswer/setIsVisible",t=>y(t,Hp)),zp=h("generatedAnswer/updateMessage",t=>y(t,{textDelta:Wi})),Gp=h("generatedAnswer/updateCitations",t=>y(t,{citations:new H({required:!0,each:new E({values:pO})})})),Yp=h("generatedAnswer/updateError",t=>y(t,{message:px,code:new I({min:0})})),Hi=h("generatedAnswer/resetAnswer"),mx=h("generatedAnswer/like"),gx=h("generatedAnswer/dislike"),hx=h("generatedAnswer/feedbackModal/open"),Sx=h("generatedAnswer/feedbackModal/close"),yx=h("generatedAnswer/sendFeedback"),zi=h("generatedAnswer/setIsLoading",t=>y(t,Hp)),ol=h("generatedAnswer/setIsStreaming",t=>y(t,Hp)),Cx=h("generatedAnswer/updateResponseFormat",t=>y(t,{answerStyle:new b({required:!0,constrainTo:dx})})),lge=J("generatedAnswer/streamAnswer",async(t,e)=>{var l;let r=e.getState(),{dispatch:a,extra:n}=e,{setAbortControllerRef:o}=t,i=await lx(r),s=(d,f)=>{switch(d){case"genqa.messageType":a(zp(JSON.parse(f)));break;case"genqa.citationsType":a(Gp(JSON.parse(f)));break;case"genqa.endOfStreamType":a(ol(!1)),a(ux(JSON.parse(f).answerGenerated));break;default:r.debug&&n.logger.warn(`Unknown payloadType: "${d}"`)}};a(zi(!0));let c=d=>d.streamId===e.getState().search.extendedResults.generativeQuestionAnsweringId,u=(l=n.streamingClient)==null?void 0:l.streamGeneratedAnswer(i,{write:d=>{c(i)&&(a(zi(!1)),d.payload&&d.payloadType&&s(d.payloadType,d.payload))},abort:d=>{c(i)&&a(Yp(d))},close:()=>{c(i)&&a(ol(!1))},resetAnswer:()=>{c(i)&&a(Hi())}});u?o(u):a(zi(!1))});function Kp(){return{isVisible:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{answerStyle:"default"},feedbackModalOpen:!1,feedbackSubmitted:!1}}var xx=O(Kp(),t=>t.addCase(fx,(e,{payload:r})=>{e.isVisible=r}).addCase(zp,(e,{payload:r})=>{e.isLoading=!1,e.isStreaming=!0,e.answer||(e.answer=""),e.answer+=r.textDelta,delete e.error}).addCase(Gp,(e,{payload:r})=>{e.isLoading=!1,e.isStreaming=!0,e.citations=e.citations.concat(r.citations),delete e.error}).addCase(Yp,(e,{payload:r})=>{e.isLoading=!1,e.isStreaming=!1,e.error={...r,isRetryable:r.code===dd},e.citations=[],delete e.answer}).addCase(mx,e=>{e.liked=!0,e.disliked=!1}).addCase(gx,e=>{e.liked=!1,e.disliked=!0}).addCase(hx,e=>{e.feedbackModalOpen=!0}).addCase(Sx,e=>{e.feedbackModalOpen=!1}).addCase(yx,e=>{e.feedbackSubmitted=!0}).addCase(Hi,e=>({...Kp(),responseFormat:e.responseFormat,isVisible:e.isVisible})).addCase(zi,(e,{payload:r})=>{e.isLoading=r}).addCase(ol,(e,{payload:r})=>{e.isStreaming=r}).addCase(Cx,(e,{payload:r})=>{e.responseFormat=r}));function xge(t){return t.addReducers({generatedAnswer:xx}),{resetAnswer:Hi}}var fO=new z({content:new ue({required:!0}),conditions:new ue({required:!0}),priority:new I({required:!1,default:0,min:0}),fields:new H({required:!1,each:P})});function mO(t){if(!gO(t))throw A;let e=[],r=a=>{a.forEach(n=>{if(fO.validate(n),!n.conditions.every(i=>i instanceof Function))throw new li("Each result template conditions should be a function that takes a result as an argument and returns a boolean")})};return{registerTemplates(...a){let n=[];r(a),a.forEach(o=>{let i={...o,priority:o.priority||0,fields:o.fields||[]};e.push(i),n.push(...i.fields)}),e.sort((o,i)=>i.priority-o.priority),n.length&&t.dispatch(Hr(n))},selectTemplate(a){let n=e.find(o=>o.conditions.every(i=>i(a)));return n?n.content:null}}}function gO(t){return t.addReducers({fields:Yr}),!0}var vx;(o=>{o.getResultProperty=vr,o.fieldsMustBeDefined=eh,o.fieldsMustNotBeDefined=th,o.fieldMustMatch=rh,o.fieldMustNotMatch=ah})(vx||(vx={}));function Bhe(t){return t.addReducers({}),{logClearBreadcrumbs:Vu,logInterfaceLoad:Es,logSearchFromLink:Is,logOmniboxFromLink:ks,logInterfaceChange:Mr,logDidYouMeanClick:Us,logCategoryFacetBreadcrumb:Du,logFacetBreadcrumb:oo,logFacetClearAll:ke,logFacetDeselect:Ze,logFacetSelect:be,logFacetShowLess:no,logFacetShowMore:ao,logFacetUpdateSort:Yt,logDateFacetBreadcrumb:Li,logNumericFacetBreadcrumb:Qi,logNavigateBackward:fu,logNavigateForward:pu,logPageNext:xu,logPageNumber:So,logPagePrevious:vu,logPagerResize:ho,logSearchboxSubmit:ca,logQuerySuggestionClick:bu,logResultsSort:bo,logDislikeSmartSnippet:Mp,logLikeSmartSnippet:Np,logOpenSmartSnippetFeedbackModal:Qp,logCloseSmartSnippetFeedbackModal:Bp,logSmartSnippetFeedback:jp,logSmartSnippetDetailedFeedback:Up,logExpandSmartSnippet:Dp,logCollapseSmartSnippet:Vp,logExpandSmartSnippetSuggestion:_p,logCollapseSmartSnippetSuggestion:$p,logNoResultsBack:mu,logStaticFilterSelect:ku,logStaticFilterDeselect:Eo,logStaticFilterClearAll:Ou,logTriggerQuery:Xs,logUndoTriggerQuery:Zs,logNotifyTrigger:ec,logTriggerRedirect:tc,logTriggerExecute:rc}}var Fx=t=>w({prefix:"analytics/result/open",__legacy__getBuilder:(e,r)=>(ot(t),e.makeDocumentOpen(Le(t,r),_e(t))),analyticsType:"itemClick",analyticsPayloadBuilder:e=>{var n,o;let r=Le(t,e),a=_e(t);return{searchUid:(o=(n=e.search)==null?void 0:n.response.searchUid)!=null?o:"",position:r.documentPosition,itemMetadata:{uniqueFieldName:a.contentIDKey,uniqueFieldValue:a.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});function zhe(t){return t.addReducers({}),{logDocumentOpen:Fx,logOpenSmartSnippetSource:Lp,logOpenSmartSnippetSuggestionSource:$i,logOpenSmartSnippetInlineLink:_i,logOpenSmartSnippetSuggestionInlineLink:Zu}}function Zhe(t){return t.addReducers({}),{logSearchEvent:Eg,logClickEvent:Ig,logCustomEvent:kg}}function hO(t){let{by:e,order:r}=t;switch(e){case Vt.Relevancy:return di();case Vt.QRE:return nd();case Vt.NoSort:return od();case Vt.Date:if(!r)throw new Error('An order (i.e., ascending or descending) should be specified for a sort criterion sorted by "date"');return rd(r);default:if(!r)throw new Error(`An order (i.e., ascending or descending) should be specified for a sort criterion sorted by a field, such as "${e}"`);return ad(e,r)}}function SO(t){return t===void 0||t===Vr.Ascending||t===Vr.Descending}function yO(t){let e=t.split(","),r=new Error(`Wrong criterion expression format for "${t}"`);if(!e.length)throw r;return e.map(a=>{let n=a.trim().split(" "),o=n[0].toLowerCase(),i=n[1]&&n[1].toLowerCase();if(n.length>2||o==="")throw r;if(!SO(i))throw new Error(`Wrong criterion sort order "${i}" in expression "${t}". Order should either be "${Vr.Ascending}" or "${Vr.Descending}"`);return hO({by:o,order:i})})}function qe(t){return t.negate?"NOT ":""}function St(t){return{contains:"=",differentThan:"<>",fuzzyMatch:"~=",greaterThan:">",greaterThanOrEqual:">=",isExactly:"==",lowerThan:"<",lowerThanOrEqual:"<=",phoneticMatch:"%=",regexMatch:"/=",wildcardMatch:"*="}[t]}function bx(t){return{toQuerySyntax(){let{field:e,value:r}=t,a=St(t.operator);return`${qe(t)}@${e}${a}${r}`}}}function Rx(t){return{toQuerySyntax(){let e=qe(t),{field:r,from:a,to:n}=t,o=St("isExactly");return`${e}@${r}${o}${a}..${n}`}}}function Ax(t){return{toQuerySyntax(){let e=qe(t),{expression:r}=t;return`${e}"${r}"`}}}function Px(t){return{toQuerySyntax(){let e=qe(t),{field:r}=t;return`${e}@${r}`}}}function wx(t){return{toQuerySyntax(){let{expression:e,negate:r}=t;return r?`NOT (${e})`:e}}}function Ex(t){return{toQuerySyntax(){let e=qe(t),{startTerm:r,otherTerms:a}=t,n=CO(a),o=`${r} ${n}`;return t.negate?`${e}(${o})`:o}}}function CO(t){return t.map(e=>{let{endTerm:r,maxKeywordsBetween:a}=e;return`near:${a} ${r}`}).join(" ")}function Ix(t){return{toQuerySyntax(){let{field:e,value:r}=t,a=qe(t),n=St(t.operator);return`${a}@${e}${n}${r}`}}}function kx(t){return{toQuerySyntax(){let e=qe(t),{field:r,from:a,to:n}=t,o=St("isExactly");return`${e}@${r}${o}${a}..${n}`}}}function Ox(t){return{toQuerySyntax(){let{name:e,parameters:r}=t,a=xO(r);return`$${e}(${a})`}}}function xO(t){return Object.entries(t).map(e=>{let[r,a]=e,n=typeof a=="string"?a:a.toQuerySyntax();return`${r}: ${n}`}).join(", ")}function qx(t){return{toQuerySyntax(){let e=qe(t),{field:r,operator:a,value:n}=t,o=St(a),i=a==="fuzzyMatch"?` $quoteVar(value: ${n})`:`("${n}")`;return`${e}@${r}${o}${i}`}}}function Tx(t){return{toQuerySyntax(){let{field:e}=t,r=qe(t),a=St(t.operator),n=t.values.map(i=>`"${i}"`),o=n.length===1?n[0]:`(${n.join(",")})`;return`${r}@${e}${a}${o}`}}}function yye(){let t=[],e="and";return{addExpression(r){return t.push(r),this},addKeyword(r){return t.push(wx(r)),this},addNear(r){return t.push(Ex(r)),this},addExactMatch(r){return t.push(Ax(r)),this},addFieldExists(r){return t.push(Px(r)),this},addStringField(r){return t.push(Tx(r)),this},addStringFacetField(r){return t.push(qx(r)),this},addNumericField(r){return t.push(Ix(r)),this},addNumericRangeField(r){return t.push(kx(r)),this},addDateField(r){return t.push(bx(r)),this},addDateRangeField(r){return t.push(Rx(r)),this},addQueryExtension(r){return t.push(Ox(r)),this},joinUsing(r){return e=r,this},toQuerySyntax(){let r=vO(e),a=t.map(n=>n.toQuerySyntax()).join(`) ${r} (`);return t.length<=1?a:`(${a})`}}}function vO(t){return t==="and"?"AND":"OR"}Jp();export{Ci as API_DATE_FORMAT,Yh as DefaultFieldsToInclude,dP as EcommerceDefaultFieldsToInclude,np as MinimumFieldsToInclude,vx as ResultTemplatesHelpers,Vt as SortBy,Vr as SortOrder,pi as VERSION,vd as analyticsUrl,Tt as baseFacetResponseSelector,fr as buildCriterionExpression,Zr as buildDateRange,rd as buildDateSortCriterion,ad as buildFieldSortCriterion,od as buildNoSortCriterion,mo as buildNumericRange,yye as buildQueryExpression,nd as buildQueryRankingExpressionSortCriterion,di as buildRelevanceSortCriterion,mO as buildResultTemplatesManager,Hu as buildSearchParameterSerializer,bp as buildStaticFilterValue,h as createAction,J as createAsyncThunk,O as createReducer,oa as currentPageSelector,Sp as currentPagesSelector,dO as defineAutomaticFacetGenerator,bI as defineBreadcrumbManager,ZP as defineCategoryFacet,uO as defineCategoryFieldSuggestions,FP as defineContext,mw as defineDateFacet,Ew as defineDateFilter,RP as defineDictionaryFieldContext,PP as defineDidYouMean,Dk as defineExecuteTrigger,uw as defineFacet,CI as defineFacetManager,sO as defineFieldSuggestions,Ek as defineFoldedResultList,FE as defineHistoryManager,oI as defineInstantResults,Nk as defineNotifyTrigger,xw as defineNumericFacet,Rw as defineNumericFilter,ME as definePager,QE as defineQueryError,UE as defineQuerySummary,qk as defineQueryTrigger,Ck as defineQuickview,Zk as defineRecentQueriesList,oO as defineRecentResultsList,kk as defineRedirectionTrigger,mP as defineRelevanceInspector,WE as defineResultList,YE as defineResultsPerPage,tI as defineSearchBox,iP as defineSearchEngine,GI as defineSearchParameterManager,hk as defineSearchStatus,Uk as defineSmartSnippet,Wk as defineSmartSnippetQuestionsList,uI as defineSort,wI as defineStandaloneSearchBox,pI as defineStaticFilter,SI as defineTab,gk as defineUrlManager,KR as deserializeRelativeDate,Jl as facetRequestSelector,bb as facetResponseSelectedValuesSelector,ci as facetResponseSelector,hi as getOrganizationEndpoints,_h as getSampleSearchEngineConfiguration,Jle as loadAdvancedSearchQueryActions,fme as loadBreadcrumbActions,cde as loadCategoryFacetSetActions,zhe as loadClickAnalyticsActions,Ide as loadConfigurationActions,jde as loadContextActions,npe as loadDateFacetSetActions,Kde as loadDebugActions,Hde as loadDictionaryFieldContextActions,hpe as loadDidYouMeanActions,Nme as loadExcerptLengthActions,dpe as loadFacetOptionsActions,xde as loadFacetSetActions,xpe as loadFieldActions,Bpe as loadFoldingActions,xge as loadGeneratedAnswerActions,Zhe as loadGenericAnalyticsActions,Ape as loadHistoryActions,mfe as loadInstantResultsActions,Tpe as loadNumericFacetSetActions,$pe as loadPaginationActions,Gpe as loadPipelineActions,Zpe as loadQueryActions,ofe as loadQuerySetActions,Afe as loadQuerySuggestActions,lme as loadQuestionAnsweringActions,yme as loadRecentQueriesActions,bme as loadRecentResultsActions,Wme as loadResultPreviewActions,Ofe as loadSearchActions,Bhe as loadSearchAnalyticsActions,Nde as loadSearchConfigurationActions,Vfe as loadSearchHubActions,Qfe as loadSortCriteriaActions,Yfe as loadStandaloneSearchBoxSetActions,tme as loadStaticFilterSetActions,ime as loadTabSetActions,Cu as maxPageSelector,yO as parseCriterionExpression,vs as platformUrl,ba as validateRelativeDate};
/**
 * @license
 *
 * Copyright 2023 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//# sourceMappingURL=headless.esm.js.map
