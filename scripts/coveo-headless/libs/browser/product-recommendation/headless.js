/**
 * @license
 *
 * Copyright 2023 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function (global, factory) {
    const isCommonjs = typeof exports === 'object' && typeof module !== 'undefined';
    
    if (isCommonjs) {
      return factory(exports);
    }
    
    const isAmd = typeof define === 'function' && define.amd;

    if (isAmd) {
      return define(['exports'], factory);
    }

    global = typeof globalThis !== 'undefined' ? globalThis : global || self;
    factory(global.CoveoHeadlessProductRecommendation = {});
  })(this, (function (exports) { 'use strict';
var js=Object.create;var Jt=Object.defineProperty;var qs=Object.getOwnPropertyDescriptor;var Us=Object.getOwnPropertyNames;var Vs=Object.getPrototypeOf,_s=Object.prototype.hasOwnProperty;var go=t=>Jt(t,"__esModule",{value:!0});var K=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Bs=(t,e)=>{go(t);for(var r in e)Jt(t,r,{get:e[r],enumerable:!0})},$s=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Us(e))!_s.call(t,n)&&n!=="default"&&Jt(t,n,{get:()=>e[n],enumerable:!(r=qs(e,n))||r.enumerable});return t},Ie=t=>$s(go(Jt(t!=null?js(Vs(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Ro=K((op,Co)=>{Co.exports=fetch});var xo=K(Lt=>{"use strict";var tr=Lt&&Lt.__assign||function(){return tr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},tr.apply(this,arguments)};Object.defineProperty(Lt,"__esModule",{value:!0});var ec={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function tc(t){var e=tr(tr({},ec),t);return e.numOfAttempts<1&&(e.numOfAttempts=1),e}Lt.getSanitizedOptions=tc});var Ao=K(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});function rc(t){var e=Math.random()*t;return Math.round(e)}Wr.fullJitter=rc});var wo=K(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});function nc(t){return t}Kr.noJitter=nc});var Po=K(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});var oc=Ao(),ic=wo();function ac(t){switch(t.jitter){case"full":return oc.fullJitter;case"none":default:return ic.noJitter}}Gr.JitterFactory=ac});var Jr=K(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});var sc=Po(),cc=function(){function t(e){this.options=e,this.attempt=0}return t.prototype.apply=function(){var e=this;return new Promise(function(r){return setTimeout(r,e.jitteredDelay)})},t.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(t.prototype,"jitteredDelay",{get:function(){var e=sc.JitterFactory(this.options);return e(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){var e=this.options.startingDelay,r=this.options.timeMultiple,n=this.numOfDelayedAttempts,o=e*Math.pow(r,n);return Math.min(o,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),t}();Yr.Delay=cc});var Eo=K(Pe=>{"use strict";var uc=Pe&&Pe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dc=Pe&&Pe.__awaiter||function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function c(d){try{s(n.next(d))}catch(p){a(p)}}function u(d){try{s(n.throw(d))}catch(p){a(p)}}function s(d){d.done?i(d.value):o(d.value).then(c,u)}s((n=n.apply(t,e||[])).next())})},lc=Pe&&Pe.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(s){return function(d){return u([s,d])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(d){s=[6,d],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(Pe,"__esModule",{value:!0});var mc=Jr(),pc=function(t){uc(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.apply=function(){return dc(this,void 0,void 0,function(){return lc(this,function(r){return[2,this.isFirstAttempt?!0:t.prototype.apply.call(this)]})})},Object.defineProperty(e.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),e}(mc.Delay);Pe.SkipFirstDelay=pc});var ko=K(Nt=>{"use strict";var fc=Nt&&Nt.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Nt,"__esModule",{value:!0});var gc=Jr(),hc=function(t){fc(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(gc.Delay);Nt.AlwaysDelay=hc});var Oo=K(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});var yc=Eo(),vc=ko();function Sc(t,e){var r=bc(t);return r.setAttemptNumber(e),r}Xr.DelayFactory=Sc;function bc(t){return t.delayFirstAttempt?new vc.AlwaysDelay(t):new yc.SkipFirstDelay(t)}});var Io=K(We=>{"use strict";var Zr=We&&We.__awaiter||function(t,e,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function c(d){try{s(n.next(d))}catch(p){a(p)}}function u(d){try{s(n.throw(d))}catch(p){a(p)}}function s(d){d.done?i(d.value):o(d.value).then(c,u)}s((n=n.apply(t,e||[])).next())})},en=We&&We.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(s){return function(d){return u([s,d])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(d){s=[6,d],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(We,"__esModule",{value:!0});var Cc=xo(),Rc=Oo();function xc(t,e){return e===void 0&&(e={}),Zr(this,void 0,void 0,function(){var r,n;return en(this,function(o){switch(o.label){case 0:return r=Cc.getSanitizedOptions(e),n=new Ac(t,r),[4,n.execute()];case 1:return[2,o.sent()]}})})}We.backOff=xc;var Ac=function(){function t(e,r){this.request=e,this.options=r,this.attemptNumber=0}return t.prototype.execute=function(){return Zr(this,void 0,void 0,function(){var e,r;return en(this,function(n){switch(n.label){case 0:if(this.attemptLimitReached)return[3,7];n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return n.sent(),[4,this.request()];case 3:return[2,n.sent()];case 4:return e=n.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(r=n.sent(),!r||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(t.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),t.prototype.applyDelay=function(){return Zr(this,void 0,void 0,function(){var e;return en(this,function(r){switch(r.label){case 0:return e=Rc.DelayFactory(this.options,this.attemptNumber),[4,e.apply()];case 1:return r.sent(),[2]}})})},t}()});var To=K((gp,Fo)=>{"use strict";function wc(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(t=`${t}`,t=t.replace(/[ \t\n\f\r]/g,""),t.length%4==0&&(t=t.replace(/==?$/,"")),t.length%4==1||/[^+/0-9A-Za-z]/.test(t))return null;let e="",r=0,n=0;for(let o=0;o<t.length;o++)r<<=6,r|=Ec(t[o]),n+=6,n===24&&(e+=String.fromCharCode((r&16711680)>>16),e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,e+=String.fromCharCode(r)):n===18&&(r>>=2,e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255)),e}var Pc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Ec(t){let e=Pc.indexOf(t);return e<0?void 0:e}Fo.exports=wc});var Lo=K((hp,Do)=>{"use strict";function kc(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let e;for(t=`${t}`,e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return null;let r="";for(e=0;e<t.length;e+=3){let n=[void 0,void 0,void 0,void 0];n[0]=t.charCodeAt(e)>>2,n[1]=(t.charCodeAt(e)&3)<<4,t.length>e+1&&(n[1]|=t.charCodeAt(e+1)>>4,n[2]=(t.charCodeAt(e+1)&15)<<2),t.length>e+2&&(n[2]|=t.charCodeAt(e+2)>>6,n[3]=t.charCodeAt(e+2)&63);for(let o=0;o<n.length;o++)typeof n[o]=="undefined"?r+="=":r+=Ic(n[o])}return r}var Oc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Ic(t){if(t>=0&&t<64)return Oc[t]}Do.exports=kc});var Mo=K((yp,No)=>{"use strict";var Fc=To(),Tc=Lo();No.exports={atob:Fc,btoa:Tc}});var Qo=K((Ap,zo)=>{"use strict";var rn=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;if(!rn)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!rn.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');zo.exports.AbortController=rn.AbortController});var Ba=K((qy,_a)=>{var Wl=/(^|; )Coveo-Pendragon=([^;]*)/;_a.exports=()=>Wl.exec(document.cookie)?.pop()||null});var Qa=K((eo,to)=>{(function(t,e){typeof eo=="object"&&typeof to!="undefined"?to.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs=e()})(eo,function(){"use strict";var t=1e3,e=6e4,r=36e5,n="millisecond",o="second",i="minute",a="hour",c="day",u="week",s="month",d="quarter",p="year",g="date",m="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,R={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(A){var S=["th","st","nd","rd"],v=A%100;return"["+A+(S[(v-20)%10]||S[v]||S[0])+"]"}},b=function(A,S,v){var P=String(A);return!P||P.length>=S?A:""+Array(S+1-P.length).join(v)+A},w={s:b,z:function(A){var S=-A.utcOffset(),v=Math.abs(S),P=Math.floor(v/60),C=v%60;return(S<=0?"+":"-")+b(P,2,"0")+":"+b(C,2,"0")},m:function A(S,v){if(S.date()<v.date())return-A(v,S);var P=12*(v.year()-S.year())+(v.month()-S.month()),C=S.clone().add(P,s),O=v-C<0,I=S.clone().add(P+(O?-1:1),s);return+(-(P+(v-C)/(O?C-I:I-C))||0)},a:function(A){return A<0?Math.ceil(A)||0:Math.floor(A)},p:function(A){return{M:s,y:p,w:u,d:c,D:g,h:a,m:i,s:o,ms:n,Q:d}[A]||String(A||"").toLowerCase().replace(/s$/,"")},u:function(A){return A===void 0}},E="en",k={};k[E]=R;var B="$isDayjsObject",z=function(A){return A instanceof Be||!(!A||!A[B])},G=function A(S,v,P){var C;if(!S)return E;if(typeof S=="string"){var O=S.toLowerCase();k[O]&&(C=O),v&&(k[O]=v,C=O);var I=S.split("-");if(!C&&I.length>1)return A(I[0])}else{var U=S.name;k[U]=S,C=U}return!P&&C&&(E=C),C||!P&&E},M=function(A,S){if(z(A))return A.clone();var v=typeof S=="object"?S:{};return v.date=A,v.args=arguments,new Be(v)},D=w;D.l=G,D.i=z,D.w=function(A,S){return M(A,{locale:S.$L,utc:S.$u,x:S.$x,$offset:S.$offset})};var Be=function(){function A(v){this.$L=G(v.locale,null,!0),this.parse(v),this.$x=this.$x||v.x||{},this[B]=!0}var S=A.prototype;return S.parse=function(v){this.$d=function(P){var C=P.date,O=P.utc;if(C===null)return new Date(NaN);if(D.u(C))return new Date;if(C instanceof Date)return new Date(C);if(typeof C=="string"&&!/Z$/i.test(C)){var I=C.match(h);if(I){var U=I[2]-1||0,Q=(I[7]||"0").substring(0,3);return O?new Date(Date.UTC(I[1],U,I[3]||1,I[4]||0,I[5]||0,I[6]||0,Q)):new Date(I[1],U,I[3]||1,I[4]||0,I[5]||0,I[6]||0,Q)}}return new Date(C)}(v),this.init()},S.init=function(){var v=this.$d;this.$y=v.getFullYear(),this.$M=v.getMonth(),this.$D=v.getDate(),this.$W=v.getDay(),this.$H=v.getHours(),this.$m=v.getMinutes(),this.$s=v.getSeconds(),this.$ms=v.getMilliseconds()},S.$utils=function(){return D},S.isValid=function(){return this.$d.toString()!==m},S.isSame=function(v,P){var C=M(v);return this.startOf(P)<=C&&C<=this.endOf(P)},S.isAfter=function(v,P){return M(v)<this.startOf(P)},S.isBefore=function(v,P){return this.endOf(P)<M(v)},S.$g=function(v,P,C){return D.u(v)?this[P]:this.set(C,v)},S.unix=function(){return Math.floor(this.valueOf()/1e3)},S.valueOf=function(){return this.$d.getTime()},S.startOf=function(v,P){var C=this,O=!!D.u(P)||P,I=D.p(v),U=function(He,ie){var Oe=D.w(C.$u?Date.UTC(C.$y,ie,He):new Date(C.$y,ie,He),C);return O?Oe:Oe.endOf(c)},Q=function(He,ie){return D.w(C.toDate()[He].apply(C.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(ie)),C)},Y=this.$W,ee=this.$M,ce=this.$D,it="set"+(this.$u?"UTC":"");switch(I){case p:return O?U(1,0):U(31,11);case s:return O?U(1,ee):U(0,ee+1);case u:var $e=this.$locale().weekStart||0,Ft=(Y<$e?Y+7:Y)-$e;return U(O?ce-Ft:ce+(6-Ft),ee);case c:case g:return Q(it+"Hours",0);case a:return Q(it+"Minutes",1);case i:return Q(it+"Seconds",2);case o:return Q(it+"Milliseconds",3);default:return this.clone()}},S.endOf=function(v){return this.startOf(v,!1)},S.$set=function(v,P){var C,O=D.p(v),I="set"+(this.$u?"UTC":""),U=(C={},C[c]=I+"Date",C[g]=I+"Date",C[s]=I+"Month",C[p]=I+"FullYear",C[a]=I+"Hours",C[i]=I+"Minutes",C[o]=I+"Seconds",C[n]=I+"Milliseconds",C)[O],Q=O===c?this.$D+(P-this.$W):P;if(O===s||O===p){var Y=this.clone().set(g,1);Y.$d[U](Q),Y.init(),this.$d=Y.set(g,Math.min(this.$D,Y.daysInMonth())).$d}else U&&this.$d[U](Q);return this.init(),this},S.set=function(v,P){return this.clone().$set(v,P)},S.get=function(v){return this[D.p(v)]()},S.add=function(v,P){var C,O=this;v=Number(v);var I=D.p(P),U=function(ee){var ce=M(O);return D.w(ce.date(ce.date()+Math.round(ee*v)),O)};if(I===s)return this.set(s,this.$M+v);if(I===p)return this.set(p,this.$y+v);if(I===c)return U(1);if(I===u)return U(7);var Q=(C={},C[i]=e,C[a]=r,C[o]=t,C)[I]||1,Y=this.$d.getTime()+v*Q;return D.w(Y,this)},S.subtract=function(v,P){return this.add(-1*v,P)},S.format=function(v){var P=this,C=this.$locale();if(!this.isValid())return C.invalidDate||m;var O=v||"YYYY-MM-DDTHH:mm:ssZ",I=D.z(this),U=this.$H,Q=this.$m,Y=this.$M,ee=C.weekdays,ce=C.months,it=C.meridiem,$e=function(ie,Oe,Tt,Yt){return ie&&(ie[Oe]||ie(P,O))||Tt[Oe].slice(0,Yt)},Ft=function(ie){return D.s(U%12||12,ie,"0")},He=it||function(ie,Oe,Tt){var Yt=ie<12?"AM":"PM";return Tt?Yt.toLowerCase():Yt};return O.replace(y,function(ie,Oe){return Oe||function(Tt){switch(Tt){case"YY":return String(P.$y).slice(-2);case"YYYY":return D.s(P.$y,4,"0");case"M":return Y+1;case"MM":return D.s(Y+1,2,"0");case"MMM":return $e(C.monthsShort,Y,ce,3);case"MMMM":return $e(ce,Y);case"D":return P.$D;case"DD":return D.s(P.$D,2,"0");case"d":return String(P.$W);case"dd":return $e(C.weekdaysMin,P.$W,ee,2);case"ddd":return $e(C.weekdaysShort,P.$W,ee,3);case"dddd":return ee[P.$W];case"H":return String(U);case"HH":return D.s(U,2,"0");case"h":return Ft(1);case"hh":return Ft(2);case"a":return He(U,Q,!0);case"A":return He(U,Q,!1);case"m":return String(Q);case"mm":return D.s(Q,2,"0");case"s":return String(P.$s);case"ss":return D.s(P.$s,2,"0");case"SSS":return D.s(P.$ms,3,"0");case"Z":return I}return null}(ie)||I.replace(":","")})},S.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},S.diff=function(v,P,C){var O,I=this,U=D.p(P),Q=M(v),Y=(Q.utcOffset()-this.utcOffset())*e,ee=this-Q,ce=function(){return D.m(I,Q)};switch(U){case p:O=ce()/12;break;case s:O=ce();break;case d:O=ce()/3;break;case u:O=(ee-Y)/6048e5;break;case c:O=(ee-Y)/864e5;break;case a:O=ee/r;break;case i:O=ee/e;break;case o:O=ee/t;break;default:O=ee}return C?O:D.a(O)},S.daysInMonth=function(){return this.endOf(s).$D},S.$locale=function(){return k[this.$L]},S.locale=function(v,P){if(!v)return this.$L;var C=this.clone(),O=G(v,P,!0);return O&&(C.$L=O),C},S.clone=function(){return D.w(this.$d,this)},S.toDate=function(){return new Date(this.valueOf())},S.toJSON=function(){return this.isValid()?this.toISOString():null},S.toISOString=function(){return this.$d.toISOString()},S.toString=function(){return this.$d.toUTCString()},A}(),Re=Be.prototype;return M.prototype=Re,[["$ms",n],["$s",o],["$m",i],["$H",a],["$W",c],["$M",s],["$y",p],["$D",g]].forEach(function(A){Re[A[1]]=function(S){return this.$g(S,A[0],A[1])}}),M.extend=function(A,S){return A.$i||(A(S,Be,M),A.$i=!0),M},M.locale=G,M.isDayjs=z,M.unix=function(A){return M(1e3*A)},M.en=k[E],M.Ls=k,M.p={},M})});var Wa=K((ro,no)=>{(function(t,e){typeof ro=="object"&&typeof no!="undefined"?no.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs_plugin_timezone=e()})(ro,function(){"use strict";var t={year:0,month:1,day:2,hour:3,minute:4,second:5},e={};return function(r,n,o){var i,a=function(d,p,g){g===void 0&&(g={});var m=new Date(d),h=function(y,R){R===void 0&&(R={});var b=R.timeZoneName||"short",w=y+"|"+b,E=e[w];return E||(E=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:y,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:b}),e[w]=E),E}(p,g);return h.formatToParts(m)},c=function(d,p){for(var g=a(d,p),m=[],h=0;h<g.length;h+=1){var y=g[h],R=y.type,b=y.value,w=t[R];w>=0&&(m[w]=parseInt(b,10))}var E=m[3],k=E===24?0:E,B=m[0]+"-"+m[1]+"-"+m[2]+" "+k+":"+m[4]+":"+m[5]+":000",z=+d;return(o.utc(B).valueOf()-(z-=z%1e3))/6e4},u=n.prototype;u.tz=function(d,p){d===void 0&&(d=i);var g=this.utcOffset(),m=this.toDate(),h=m.toLocaleString("en-US",{timeZone:d}),y=Math.round((m-new Date(h))/1e3/60),R=o(h,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(m.getTimezoneOffset()/15)-y,!0);if(p){var b=R.utcOffset();R=R.add(g-b,"minute")}return R.$x.$timezone=d,R},u.offsetName=function(d){var p=this.$x.$timezone||o.tz.guess(),g=a(this.valueOf(),p,{timeZoneName:d}).find(function(m){return m.type.toLowerCase()==="timezonename"});return g&&g.value};var s=u.startOf;u.startOf=function(d,p){if(!this.$x||!this.$x.$timezone)return s.call(this,d,p);var g=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return s.call(g,d,p).tz(this.$x.$timezone,!0)},o.tz=function(d,p,g){var m=g&&p,h=g||p||i,y=c(+o(),h);if(typeof d!="string")return o(d).tz(h);var R=function(k,B,z){var G=k-60*B*1e3,M=c(G,z);if(B===M)return[G,B];var D=c(G-=60*(M-B)*1e3,z);return M===D?[G,M]:[k-60*Math.min(M,D)*1e3,Math.max(M,D)]}(o.utc(d,m).valueOf(),y,h),b=R[0],w=R[1],E=o(b).utcOffset(w);return E.$x.$timezone=h,E},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(d){i=d}}})});var Ka=K((oo,io)=>{(function(t,e){typeof oo=="object"&&typeof io!="undefined"?io.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis!="undefined"?globalThis:t||self).dayjs_plugin_utc=e()})(oo,function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,o,i){var a=o.prototype;i.utc=function(m){var h={date:m,utc:!0,args:arguments};return new o(h)},a.utc=function(m){var h=i(this.toDate(),{locale:this.$L,utc:!0});return m?h.add(this.utcOffset(),t):h},a.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var c=a.parse;a.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),c.call(this,m)};var u=a.init;a.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds()}else u.call(this)};var s=a.utcOffset;a.utcOffset=function(m,h){var y=this.$utils().u;if(y(m))return this.$u?0:y(this.$offset)?s.call(this):this.$offset;if(typeof m=="string"&&(m=function(E){E===void 0&&(E="");var k=E.match(e);if(!k)return null;var B=(""+k[0]).match(r)||["-",0,0],z=B[0],G=60*+B[1]+ +B[2];return G===0?0:z==="+"?G:-G}(m),m===null))return this;var R=Math.abs(m)<=16?60*m:m,b=this;if(h)return b.$offset=R,b.$u=m===0,b;if(m!==0){var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(b=this.local().add(R+w,t)).$offset=R,b.$x.$localOffset=w}else b=this.utc();return b};var d=a.format;a.format=function(m){var h=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,h)},a.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var p=a.toDate;a.toDate=function(m){return m==="s"&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var g=a.diff;a.diff=function(m,h,y){if(m&&this.$u===m.$u)return g.call(this,m,h,y);var R=this.local(),b=i(m).local();return g.call(R,b,h,y)}}})});var us=K((Kv,cs)=>{"use strict";function am(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}cs.exports=sm;function sm(t,e,r){var n=r&&r.stringify||am,o=1;if(typeof t=="object"&&t!==null){var i=e.length+o;if(i===1)return t;var a=new Array(i);a[0]=n(t);for(var c=1;c<i;c++)a[c]=n(e[c]);return a.join(" ")}if(typeof t!="string")return t;var u=e.length;if(u===0)return t;for(var s="",d=1-o,p=-1,g=t&&t.length||0,m=0;m<g;){if(t.charCodeAt(m)===37&&m+1<g){switch(p=p>-1?p:0,t.charCodeAt(m+1)){case 100:case 102:if(d>=u||e[d]==null)break;p<m&&(s+=t.slice(p,m)),s+=Number(e[d]),p=m+2,m++;break;case 105:if(d>=u||e[d]==null)break;p<m&&(s+=t.slice(p,m)),s+=Math.floor(Number(e[d])),p=m+2,m++;break;case 79:case 111:case 106:if(d>=u||e[d]===void 0)break;p<m&&(s+=t.slice(p,m));var h=typeof e[d];if(h==="string"){s+="'"+e[d]+"'",p=m+2,m++;break}if(h==="function"){s+=e[d].name||"<anonymous>",p=m+2,m++;break}s+=n(e[d]),p=m+2,m++;break;case 115:if(d>=u)break;p<m&&(s+=t.slice(p,m)),s+=String(e[d]),p=m+2,m++;break;case 37:p<m&&(s+=t.slice(p,m)),s+="%",p=m+2,m++,d--;break}++d}++m}return p===-1?t:(p<g&&(s+=t.slice(p)),s)}});var gs=K((Gv,_r)=>{"use strict";var ds=us();_r.exports=ke;var Kt=Rm().console||{},cm={mapHttpRequest:Vr,mapHttpResponse:Vr,wrapRequestSerializer:mo,wrapResponseSerializer:mo,wrapErrorSerializer:mo,req:Vr,res:Vr,err:ms,errWithCause:ms};function qr(t,e){return t==="silent"?1/0:e.levels.values[t]}var co=Symbol("pino.logFuncs"),uo=Symbol("pino.hierarchy"),um={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function ls(t,e){let r={logger:e,parent:t[uo]};e[uo]=r}function dm(t,e,r){let n={};e.forEach(o=>{n[o]=r[o]?r[o]:Kt[o]||Kt[um[o]||"log"]||Gt}),t[co]=n}function lm(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function ke(t){t=t||{},t.browser=t.browser||{};let e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");let r=t.browser.write||Kt;t.browser.write&&(t.browser.asObject=!0);let n=t.serializers||{},o=lm(t.browser.serialize,n),i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);let a=Object.keys(t.customLevels||{}),c=["error","fatal","warn","info","debug","trace"].concat(a);typeof r=="function"&&c.forEach(function(y){r[y]=r}),(t.enabled===!1||t.browser.disabled)&&(t.level="silent");let u=t.level||"info",s=Object.create(r);s.log||(s.log=Gt),dm(s,c,r),ls({},s),Object.defineProperty(s,"levelVal",{get:p}),Object.defineProperty(s,"level",{get:g,set:m});let d={transmit:e,serialize:o,asObject:t.browser.asObject,levels:c,timestamp:Sm(t)};s.levels=mm(t),s.level=u,s.setMaxListeners=s.getMaxListeners=s.emit=s.addListener=s.on=s.prependListener=s.once=s.prependOnceListener=s.removeListener=s.removeAllListeners=s.listeners=s.listenerCount=s.eventNames=s.write=s.flush=Gt,s.serializers=n,s._serialize=o,s._stdErrSerialize=i,s.child=h,e&&(s._logEvent=lo());function p(){return qr(this.level,this)}function g(){return this._level}function m(y){if(y!=="silent"&&!this.levels.values[y])throw Error("unknown level "+y);this._level=y,tt(this,d,s,"error"),tt(this,d,s,"fatal"),tt(this,d,s,"warn"),tt(this,d,s,"info"),tt(this,d,s,"debug"),tt(this,d,s,"trace"),a.forEach(R=>{tt(this,d,s,R)})}function h(y,R){if(!y)throw new Error("missing bindings for child Pino");R=R||{},o&&y.serializers&&(R.serializers=y.serializers);let b=R.serializers;if(o&&b){var w=Object.assign({},n,b),E=t.browser.serialize===!0?Object.keys(w):o;delete y.serializers,Ur([y],E,w,this._stdErrSerialize)}function k(z){this._childLevel=(z._childLevel|0)+1,this.bindings=y,w&&(this.serializers=w,this._serialize=E),e&&(this._logEvent=lo([].concat(z._logEvent.bindings,y)))}k.prototype=this;let B=new k(this);return ls(this,B),B.level=this.level,B}return s}function mm(t){let e=t.customLevels||{},r=Object.assign({},ke.levels.values,e),n=Object.assign({},ke.levels.labels,pm(e));return{values:r,labels:n}}function pm(t){let e={};return Object.keys(t).forEach(function(r){e[t[r]]=r}),e}ke.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ke.stdSerializers=cm;ke.stdTimeFunctions=Object.assign({},{nullTime:ps,epochTime:fs,unixTime:bm,isoTime:Cm});function fm(t){let e=[];t.bindings&&e.push(t.bindings);let r=t[uo];for(;r.parent;)r=r.parent,r.logger.bindings&&e.push(r.logger.bindings);return e.reverse()}function tt(t,e,r,n){if(t[n]=qr(t.level,r)>qr(n,r)?Gt:r[co][n],!e.transmit&&t[n]===Gt)return;t[n]=hm(t,e,r,n);let o=fm(t);o.length!==0&&(t[n]=gm(o,t[n]))}function gm(t,e){return function(){return e.apply(this,[...t,...arguments])}}function hm(t,e,r,n){return function(o){return function(){let a=e.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Kt?Kt:this;for(var s=0;s<c.length;s++)c[s]=arguments[s];if(e.serialize&&!e.asObject&&Ur(c,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?o.call(u,ym(this,n,c,a)):o.apply(u,c),e.transmit){let d=e.transmit.level||t._level,p=r.levels.values[d],g=r.levels.values[n];if(g<p)return;vm(this,{ts:a,methodLevel:n,methodValue:g,transmitLevel:d,transmitValue:r.levels.values[e.transmit.level||t._level],send:e.transmit.send,val:qr(t._level,r)},c)}}}(t[co][n])}function ym(t,e,r,n){t._serialize&&Ur(r,t._serialize,t.serializers,t._stdErrSerialize);let o=r.slice(),i=o[0],a={};n&&(a.time=n),a.level=t.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),i!==null&&typeof i=="object"){for(;c--&&typeof o[0]=="object";)Object.assign(a,o.shift());i=o.length?ds(o.shift(),o):void 0}else typeof i=="string"&&(i=ds(o.shift(),o));return i!==void 0&&(a.msg=i),a}function Ur(t,e,r,n){for(let o in t)if(n&&t[o]instanceof Error)t[o]=ke.stdSerializers.err(t[o]);else if(typeof t[o]=="object"&&!Array.isArray(t[o]))for(let i in t[o])e&&e.indexOf(i)>-1&&i in r&&(t[o][i]=r[i](t[o][i]))}function vm(t,e,r){let n=e.send,o=e.ts,i=e.methodLevel,a=e.methodValue,c=e.val,u=t._logEvent.bindings;Ur(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=o,t._logEvent.messages=r.filter(function(s){return u.indexOf(s)===-1}),t._logEvent.level.label=i,t._logEvent.level.value=a,n(i,t._logEvent,c),t._logEvent=lo(u)}function lo(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function ms(t){let e={type:t.constructor.name,msg:t.message,stack:t.stack};for(let r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Sm(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?ps:fs}function Vr(){return{}}function mo(t){return t}function Gt(){}function ps(){return!1}function fs(){return Date.now()}function bm(){return Math.round(Date.now()/1e3)}function Cm(){return new Date(Date.now()).toISOString()}function Rm(){function t(e){return typeof e!="undefined"&&e}try{return typeof globalThis!="undefined"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}_r.exports.default=ke;_r.exports.pino=ke});Bs(exports,{buildCartRecommendationsList:()=>Es,buildContext:()=>Ds,buildController:()=>_e,buildDictionaryFieldContext:()=>Ls,buildFrequentlyBoughtTogetherList:()=>Ps,buildFrequentlyViewedDifferentCategoryList:()=>Ms,buildFrequentlyViewedSameCategoryList:()=>Ns,buildFrequentlyViewedTogetherList:()=>ks,buildPopularBoughtRecommendationsList:()=>Os,buildPopularViewedRecommendationsList:()=>Is,buildProductRecommendationEngine:()=>Rs,buildUserInterestRecommendationsList:()=>Fs,getSampleProductRecommendationEngineConfiguration:()=>po,loadClickAnalyticsActions:()=>Im,loadConfigurationActions:()=>km,loadContextActions:()=>Tm,loadDictionaryFieldContextActions:()=>Dm,loadProductRecommendationsActions:()=>Om,loadSearchHubActions:()=>Lm});var Dt=()=>global.crypto,ho=()=>{typeof window=="undefined"&&(Dt()||(global.crypto=require("crypto")),!Dt().getRandomValues&&Dt().webcrypto&&(global.crypto.getRandomValues=Dt().webcrypto.getRandomValues.bind(Dt().webcrypto)))};function Hs(t,e){let r=`
  The following properties are invalid:

    ${t.join(`
	`)}
  
  ${e}
  `;return new zr(r)}var zr=class extends Error{constructor(t){super(t);this.name="SchemaValidationError"}},j=class{constructor(t){this.definition=t}validate(t={},e=""){let r={...this.default,...t},n=[];for(let o in this.definition){let i=this.definition[o].validate(r[o]);i&&n.push(`${o}: ${i}`)}if(n.length)throw Hs(n,e);return r}get default(){let t={};for(let e in this.definition){let r=this.definition[e].default;r!==void 0&&(t[e]=r)}return t}},ze=class{constructor(t={}){this.baseConfig=t}validate(t){return this.baseConfig.required&&q(t)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return this.baseConfig.required===!0}};function xe(t){return t===void 0}function zs(t){return t===null}function q(t){return xe(t)||zs(t)}var Qe=class{constructor(t={}){this.config=t,this.value=new ze(t)}validate(t){let e=this.value.validate(t);return e||(Qs(t)?t<this.config.min?`minimum value of ${this.config.min} not respected.`:t>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function Qs(t){return xe(t)||yo(t)}function yo(t){return typeof t=="number"&&!isNaN(t)}var Fe=class{constructor(t={}){this.value=new ze(t)}validate(t){let e=this.value.validate(t);return e||(Ws(t)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function Ws(t){return xe(t)||vo(t)}function vo(t){return typeof t=="boolean"}var Ks=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,L=class{constructor(t={}){this.config={emptyAllowed:!0,url:!1,...t},this.value=new ze(this.config)}validate(t){let{emptyAllowed:e,url:r,regex:n,constrainTo:o}=this.config,i=this.value.validate(t);return i||(xe(t)?null:Xt(t)?!e&&!t.length?"value is an empty string.":r&&!Ks.test(t)?"value is not a valid URL.":n&&!n.test(t)?`value did not match provided regex ${n}`:o&&!o.includes(t)?`value should be one of: ${o.join(", ")}.`:null:"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function Xt(t){return Object.prototype.toString.call(t)==="[object String]"}var $=class{constructor(t={}){this.config={options:{required:!1},values:{},...t}}validate(t){if(xe(t))return this.config.options.required?"value is required and is currently undefined":null;if(!So(t))return"value is not an object";for(let[r,n]of Object.entries(this.config.values))if(n.required&&q(t[r]))return`value does not contain ${r}`;let e="";for(let[r,n]of Object.entries(this.config.values)){let o=t[r],i=n.validate(o);i!==null&&(e+=" "+i)}return e===""?null:e}get default(){}get required(){return!!this.config.options.required}};function So(t){return t!==void 0&&typeof t=="object"}var ue=class{constructor(t={}){this.config=t,this.value=new ze(this.config)}validate(t){if(!q(t)&&!Array.isArray(t))return"value is not an array";let e=this.value.validate(t);if(e!==null)return e;if(q(t))return null;if(this.config.max!==void 0&&t.length>this.config.max)return`value contains more than ${this.config.max}`;if(this.config.min!==void 0&&t.length<this.config.min)return`value contains less than ${this.config.min}`;if(this.config.each!==void 0){let r="";return t.forEach(n=>{this.config.each.required&&q(n)&&(r=`value is null or undefined: ${t.join(",")}`);let o=this.validatePrimitiveValue(n,this.config.each);o!==null&&(r+=" "+o)}),r===""?null:r}return null}validatePrimitiveValue(t,e){return vo(t)||Xt(t)||yo(t)||So(t)?e.validate(t):"value is not a primitive value"}get default(){}get required(){return this.value.required}};function bo(t){return Array.isArray(t)}var Qr=class{constructor(t){this.config=t,this.value=new ze(t)}validate(t){let e=this.value.validate(t);return e!==null?e:xe(t)||Object.values(this.config.enum).find(n=>n===t)?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}};var Zt=t=>t;function er(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function Te(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:er(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:er(),extendedResults:{}}}function Ae(t){let{url:e,accessToken:r,organizationId:n,authentication:o,...i}=t;return i}var we=t=>{let{response:e}=t;return e.body?Gs(t):Ys(e)},Gs=t=>Xs(t)?Zs(t):Js(t)?t.body:{message:"unknown",statusCode:0,type:"unknown"},Ys=t=>{let e=JSON.parse(JSON.stringify(t,Object.getOwnPropertyNames(t)));return{...e,message:`Client side error: ${e.message||""}`,statusCode:400,type:"ClientError"}};function Js(t){return t.body.statusCode!==void 0}function Xs(t){return t.body.exception!==void 0}var Zs=t=>({message:t.body.exception.code,statusCode:t.response.status,type:t.body.exception.code});var Vo=Ie(Ro()),_o=Ie(Io());var at=new Error("Failed to load reducers."),Mt=class extends Error{constructor(){super();this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},st=class extends Error{constructor(e,r){super();this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=r!=null?r:0}};var Dc=Ie(Mo());var Lc=new Set(["1",1,"yes",!0]);function rr(){if(typeof navigator=="undefined"||typeof window=="undefined")return!1;let t=navigator,e=window;return[t.globalPrivacyControl,t.doNotTrack,t.msDoNotTrack,e.doNotTrack].some(r=>Lc.has(r))}function jo(t){let e={};for(let[r,n]of t)e[r]=n;return e}function jt(t){if(typeof t!="object"||!t)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}function qo(t){let e=[];for(let r in t){let n=encodeURIComponent(r),o=encodeURIComponent(t[r]);e.push(`${n}=${o}`)}return e.join("&")}function Uo(t){return typeof t!="object"||!t?!1:Object.values(t).every(Nc)}function Nc(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"}function Bo(t){return t===429}var ae=class{static async call(e){let r=Mc(e),{logger:n}=e,o=await ae.preprocessRequest(r,e);n.info(o,"Platform request");let{url:i,...a}=o,c=async()=>{let u=await(0,Vo.default)(i,a);if(Bo(u.status))throw u;return u};try{let u=await(0,_o.backOff)(c,{retry:s=>{let d=s&&Bo(s.status);return d&&n.info("Platform retrying request"),d}});if(u.status===419)throw n.info("Platform renewing token"),new Mt;if(u.status===404)throw new st(i,u.status);return n.info({response:u,requestInfo:o},"Platform response"),u}catch(u){return u.message==="Failed to fetch"?new st(i):u}}static async preprocessRequest(e,r){let{origin:n,preprocessRequest:o,logger:i,requestMetadata:a}=r,{signal:c,...u}=e,s=jt(u);try{let d=await o(e,n,a);return{...e,...d}}catch(d){i.error(d,"Platform request preprocessing failed. Returning default request options.")}return s}};function $o(t,e){let r=!e||!e.environment||e.environment==="prod"?"":e.environment,n=!e||!e.region||e.region==="us"?"":`-${e.region}`;return`https://${t}${r}${n}.cloud.coveo.com`}function nr(t,e="prod"){let r=e==="prod"?"":e,n=`https://${t}.org${r}.coveo.com`,o=`https://${t}.analytics.org${r}.coveo.com`,i=`${n}/rest/search/v2`,a=`https://${t}.admin.org${r}.coveo.com`;return{platform:n,analytics:o,search:i,admin:a}}function tn(t){return(t==null?void 0:t.multiRegionSubDomain)?`https://${t.multiRegionSubDomain}.org.coveo.com`:$o("platform",t)}function Ho(t){return $o("analytics",t)}function Mc(t){let{url:e,method:r,requestParams:n,contentType:o,accessToken:i,signal:a}=t,c=t.method==="POST"||t.method==="PUT",u=jc(n,o);return{url:e,method:r,headers:{"Content-Type":o,Authorization:`Bearer ${i}`,...t.headers},...c&&{body:u},signal:a}}function jc(t,e){return e==="application/x-www-form-urlencoded"?Uo(t)?qo(t):"":JSON.stringify(t)}function Wo(){if(typeof window=="undefined"){let{AbortController:t}=Qo();return new t}return typeof AbortController=="undefined"?null:new AbortController}var Ke=class{constructor(){this.currentAbortController=null}async enqueue(e,r){var i;let n=this.currentAbortController,o=this.currentAbortController=Wo();n&&(r.warnOnAbort&&r.logger.warn("Cancelling current pending search query"),n.abort());try{return await e((i=o==null?void 0:o.signal)!=null?i:null)}finally{this.currentAbortController===o&&(this.currentAbortController=null)}}};var or=class{constructor(e){this._params={};this._basePath=e}addParam(e,r){this._params={...this.params,[e]:r}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([e,r])=>`${e}=${encodeURIComponent(r)}`).join("&")}`:this.basePath}},Ko=t=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(t),Go=(t,e)=>{let r=nn(t);return r&&r.organizationId===e?r:null},nn=t=>{let e=t.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return(e==null?void 0:e.groups)?e.groups:null};function Yo(t){return((t.headers.get("content-type")||"").split(";").find(n=>n.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var he=(t,e,r,n)=>{let o=new or(`${t.url}${n}`);return o.addParam("organizationId",t.organizationId),t.authentication&&o.addParam("authentication",t.authentication),{accessToken:t.accessToken,method:e,contentType:r,url:o.href,origin:"searchApiFetch"}};var Jo=async(t,e)=>{let r=await ae.call({...he(t,"POST","application/x-www-form-urlencoded","/html"),requestParams:Ae(t),requestMetadata:{method:"html"},...e});if(r instanceof Error)throw r;let n=Yo(r),o=await r.arrayBuffer(),a=new TextDecoder(n).decode(o);return qc(a)?{success:a}:{error:we({response:r,body:a})}};function qc(t){return typeof t=="string"}function Uc(t){return{statusCode:t.statusCode,type:t.name,message:t.message}}function Vc(t){return{statusCode:t.code,type:t.name,message:t.message,ignored:!0}}function ir(t,e){if(e&&t.name==="AbortError")return{error:Vc(t)};if(t instanceof st)return{error:Uc(t)};throw t}var on=class{constructor(e){this.options=e;this.apiCallsQueues={unknown:new Ke,mainSearch:new Ke,facetValues:new Ke,foldingCollection:new Ke,instantResults:new Ke}}async plan(e){let r=await ae.call({...he(e,"POST","application/json","/plan"),requestParams:Ae(e),requestMetadata:{method:"plan"},...this.options});if(r instanceof Error)return ir(r);let n=await r.json();return $c(n)?{success:n}:{error:we({response:r,body:n})}}async querySuggest(e){let r=await ae.call({...he(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:Ae(e),...this.options});if(r instanceof Error)return ir(r);let n=await r.json(),o={response:r,body:n};return Bc(n)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(o)).body}:{error:we(o)}}async search(e,r){var c;let n=(c=r==null?void 0:r.origin)!=null?c:"unknown",o=await this.apiCallsQueues[n].enqueue(u=>ae.call({...he(e,"POST","application/json",""),requestParams:Ae(e),requestMetadata:{method:"search",origin:r==null?void 0:r.origin},...this.options,signal:u!=null?u:void 0}),{logger:this.options.logger,warnOnAbort:!(r==null?void 0:r.disableAbortWarning)});if(o instanceof Error)return ir(o,r==null?void 0:r.disableAbortWarning);let i=await o.json(),a={response:o,body:i};return an(i)?(a.body=_c(i),{success:(await this.options.postprocessSearchResponseMiddleware(a)).body}):{error:we(a)}}async facetSearch(e){let r=await ae.call({...he(e,"POST","application/json","/facet"),requestParams:Ae(e),requestMetadata:{method:"facetSearch"},...this.options});if(r instanceof Error)throw r;let n=await r.json(),o={response:r,body:n};return(await this.options.postprocessFacetSearchResponseMiddleware(o)).body}async recommendations(e){let r=await ae.call({...he(e,"POST","application/json",""),requestParams:Ae(e),requestMetadata:{method:"recommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return an(n)?{success:n}:{error:we({response:r,body:n})}}async html(e){return Jo(e,{...this.options})}async productRecommendations(e){let r=await ae.call({...he(e,"POST","application/json",""),requestParams:Ae(e),requestMetadata:{method:"productRecommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return an(n)?{success:n}:{error:we({response:r,body:n})}}async fieldDescriptions(e){let r=await ae.call({...he(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return Hc(n)?{success:n}:{error:we({response:r,body:n})}}};var Xo=t=>t.error!==void 0;function an(t){return t.results!==void 0}function _c(t){let e=er();return q(t.questionAnswer)?(t.questionAnswer=e,t):(t.questionAnswer={...e,...t.questionAnswer},t)}function Bc(t){return t.completions!==void 0}function $c(t){return t.preprocessingOutput!==void 0}function Hc(t){return t.fields!==void 0}var Zo=t=>t,ei=t=>t,ti=t=>t;function de(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!1)var o,i;throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map(function(a){return"'"+a+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ee(t){return!!t&&!!t[_]}function pe(t){var e;return!!t&&(function(r){if(!r||typeof r!="object")return!1;var n=Object.getPrototypeOf(r);if(n===null)return!0;var o=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return o===Object||typeof o=="function"&&Function.toString.call(o)===Xc}(t)||Array.isArray(t)||!!t[mi]||!!((e=t.constructor)===null||e===void 0?void 0:e[mi])||sn(t)||cn(t))}function Ge(t,e,r){r===void 0&&(r=!1),ct(t)===0?(r?Object.keys:dt)(t).forEach(function(n){r&&typeof n=="symbol"||e(n,t[n],t)}):t.forEach(function(n,o){return e(o,n,t)})}function ct(t){var e=t[_];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:sn(t)?2:cn(t)?3:0}function ut(t,e){return ct(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function zc(t,e){return ct(t)===2?t.get(e):t[e]}function ri(t,e,r){var n=ct(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function ni(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function sn(t){return Yc&&t instanceof Map}function cn(t){return Jc&&t instanceof Set}function De(t){return t.o||t.t}function un(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=pi(t);delete e[_];for(var r=dt(e),n=0;n<r.length;n++){var o=r[n],i=e[o];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[o]})}return Object.create(Object.getPrototypeOf(t),e)}function dn(t,e){return e===void 0&&(e=!1),ln(t)||Ee(t)||!pe(t)||(ct(t)>1&&(t.set=t.add=t.clear=t.delete=Qc),Object.freeze(t),e&&Ge(t,function(r,n){return dn(n,!0)},!0)),t}function Qc(){de(2)}function ln(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function ye(t){var e=bn[t];return e||de(18,t),e}function Wc(t,e){bn[t]||(bn[t]=e)}function mn(){return qt}function pn(t,e){e&&(ye("Patches"),t.u=[],t.s=[],t.v=e)}function ar(t){fn(t),t.p.forEach(Kc),t.p=null}function fn(t){t===qt&&(qt=t.l)}function oi(t){return qt={p:[],l:qt,h:t,m:!0,_:0}}function Kc(t){var e=t[_];e.i===0||e.i===1?e.j():e.g=!0}function gn(t,e){e._=e.p.length;var r=e.p[0],n=t!==void 0&&t!==r;return e.h.O||ye("ES5").S(e,t,n),n?(r[_].P&&(ar(e),de(4)),pe(t)&&(t=sr(e,t),e.l||cr(e,t)),e.u&&ye("Patches").M(r[_].t,t,e.u,e.s)):t=sr(e,r,[]),ar(e),e.u&&e.v(e.u,e.s),t!==li?t:void 0}function sr(t,e,r){if(ln(e))return e;var n=e[_];if(!n)return Ge(e,function(c,u){return ii(t,n,e,c,u,r)},!0),e;if(n.A!==t)return e;if(!n.P)return cr(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=n.i===4||n.i===5?n.o=un(n.k):n.o,i=o,a=!1;n.i===3&&(i=new Set(o),o.clear(),a=!0),Ge(i,function(c,u){return ii(t,n,o,c,u,r,a)}),cr(t,o,!1),r&&t.u&&ye("Patches").N(n,r,t.u,t.s)}return n.o}function ii(t,e,r,n,o,i,a){if(Ee(o)){var c=sr(t,o,i&&e&&e.i!==3&&!ut(e.R,n)?i.concat(n):void 0);if(ri(r,n,c),!Ee(c))return;t.m=!1}else a&&r.add(o);if(pe(o)&&!ln(o)){if(!t.h.D&&t._<1)return;sr(t,o),e&&e.A.l||cr(t,o)}}function cr(t,e,r){r===void 0&&(r=!1),!t.l&&t.h.D&&t.m&&dn(e,r)}function hn(t,e){var r=t[_];return(r?De(r):t)[e]}function ai(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function Le(t){t.P||(t.P=!0,t.l&&Le(t.l))}function yn(t){t.o||(t.o=un(t.t))}function vn(t,e,r){var n=sn(e)?ye("MapSet").F(e,r):cn(e)?ye("MapSet").T(e,r):t.O?function(o,i){var a=Array.isArray(o),c={i:a?1:0,A:i?i.A:mn(),P:!1,I:!1,R:{},l:i,t:o,k:null,o:null,j:null,C:!1},u=c,s=Ut;a&&(u=[c],s=Vt);var d=Proxy.revocable(u,s),p=d.revoke,g=d.proxy;return c.k=g,c.j=p,g}(e,r):ye("ES5").J(e,r);return(r?r.A:mn()).p.push(n),n}function Gc(t){return Ee(t)||de(22,t),function e(r){if(!pe(r))return r;var n,o=r[_],i=ct(r);if(o){if(!o.P&&(o.i<4||!ye("ES5").K(o)))return o.t;o.I=!0,n=si(r,i),o.I=!1}else n=si(r,i);return Ge(n,function(a,c){o&&zc(o.t,a)===c||ri(n,a,e(c))}),i===3?new Set(n):n}(t)}function si(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return un(t)}function ci(){function t(a,c){var u=i[a];return u?u.enumerable=c:i[a]=u={configurable:!0,enumerable:c,get:function(){var s=this[_];return Ut.get(s,a)},set:function(s){var d=this[_];Ut.set(d,a,s)}},u}function e(a){for(var c=a.length-1;c>=0;c--){var u=a[c][_];if(!u.P)switch(u.i){case 5:n(u)&&Le(u);break;case 4:r(u)&&Le(u)}}}function r(a){for(var c=a.t,u=a.k,s=dt(u),d=s.length-1;d>=0;d--){var p=s[d];if(p!==_){var g=c[p];if(g===void 0&&!ut(c,p))return!0;var m=u[p],h=m&&m[_];if(h?h.t!==g:!ni(m,g))return!0}}var y=!!c[_];return s.length!==dt(c).length+(y?0:1)}function n(a){var c=a.k;if(c.length!==a.t.length)return!0;var u=Object.getOwnPropertyDescriptor(c,c.length-1);if(u&&!u.get)return!0;for(var s=0;s<c.length;s++)if(!c.hasOwnProperty(s))return!0;return!1}function o(a){a.g&&de(3,JSON.stringify(De(a)))}var i={};Wc("ES5",{J:function(a,c){var u=Array.isArray(a),s=function(p,g){if(p){for(var m=Array(g.length),h=0;h<g.length;h++)Object.defineProperty(m,""+h,t(h,!0));return m}var y=pi(g);delete y[_];for(var R=dt(y),b=0;b<R.length;b++){var w=R[b];y[w]=t(w,p||!!y[w].enumerable)}return Object.create(Object.getPrototypeOf(g),y)}(u,a),d={i:u?5:4,A:c?c.A:mn(),P:!1,I:!1,R:{},l:c,t:a,k:s,o:null,g:!1,C:!1};return Object.defineProperty(s,_,{value:d,writable:!0}),s},S:function(a,c,u){u?Ee(c)&&c[_].A===a&&e(a.p):(a.u&&function s(d){if(d&&typeof d=="object"){var p=d[_];if(p){var g=p.t,m=p.k,h=p.R,y=p.i;if(y===4)Ge(m,function(k){k!==_&&(g[k]!==void 0||ut(g,k)?h[k]||s(m[k]):(h[k]=!0,Le(p)))}),Ge(g,function(k){m[k]!==void 0||ut(m,k)||(h[k]=!1,Le(p))});else if(y===5){if(n(p)&&(Le(p),h.length=!0),m.length<g.length)for(var R=m.length;R<g.length;R++)h[R]=!1;else for(var b=g.length;b<m.length;b++)h[b]=!0;for(var w=Math.min(m.length,g.length),E=0;E<w;E++)m.hasOwnProperty(E)||(h[E]=!0),h[E]===void 0&&s(m[E])}}}}(a.p[0]),e(a.p))},K:function(a){return a.i===4?r(a):n(a)}})}var ui,qt,Sn=typeof Symbol!="undefined"&&typeof Symbol("x")=="symbol",Yc=typeof Map!="undefined",Jc=typeof Set!="undefined",di=typeof Proxy!="undefined"&&Proxy.revocable!==void 0&&typeof Reflect!="undefined",li=Sn?Symbol.for("immer-nothing"):((ui={})["immer-nothing"]=!0,ui),mi=Sn?Symbol.for("immer-draftable"):"__$immer_draftable",_=Sn?Symbol.for("immer-state"):"__$immer_state",Xp=typeof Symbol!="undefined"&&Symbol.iterator||"@@iterator";var Xc=""+Object.prototype.constructor,dt=typeof Reflect!="undefined"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,pi=Object.getOwnPropertyDescriptors||function(t){var e={};return dt(t).forEach(function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)}),e},bn={},Ut={get:function(t,e){if(e===_)return t;var r=De(t);if(!ut(r,e))return function(o,i,a){var c,u=ai(i,a);return u?"value"in u?u.value:(c=u.get)===null||c===void 0?void 0:c.call(o.k):void 0}(t,r,e);var n=r[e];return t.I||!pe(n)?n:n===hn(t.t,e)?(yn(t),t.o[e]=vn(t.A.h,n,t)):n},has:function(t,e){return e in De(t)},ownKeys:function(t){return Reflect.ownKeys(De(t))},set:function(t,e,r){var n=ai(De(t),e);if(n==null?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var o=hn(De(t),e),i=o==null?void 0:o[_];if(i&&i.t===r)return t.o[e]=r,t.R[e]=!1,!0;if(ni(r,o)&&(r!==void 0||ut(t.t,e)))return!0;yn(t),Le(t)}return t.o[e]===r&&(r!==void 0||e in t.o)||Number.isNaN(r)&&Number.isNaN(t.o[e])||(t.o[e]=r,t.R[e]=!0),!0},deleteProperty:function(t,e){return hn(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,yn(t),Le(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=De(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty:function(){de(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){de(12)}},Vt={};Ge(Ut,function(t,e){Vt[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Vt.deleteProperty=function(t,e){return Vt.set.call(this,t,e,void 0)},Vt.set=function(t,e,r){return Ut.set.call(this,t[0],e,r,t[0])};var Zc=function(){function t(r){var n=this;this.O=di,this.D=!0,this.produce=function(o,i,a){if(typeof o=="function"&&typeof i!="function"){var c=i;i=o;var u=n;return function(y){var R=this;y===void 0&&(y=c);for(var b=arguments.length,w=Array(b>1?b-1:0),E=1;E<b;E++)w[E-1]=arguments[E];return u.produce(y,function(k){var B;return(B=i).call.apply(B,[R,k].concat(w))})}}var s;if(typeof i!="function"&&de(6),a!==void 0&&typeof a!="function"&&de(7),pe(o)){var d=oi(n),p=vn(n,o,void 0),g=!0;try{s=i(p),g=!1}finally{g?ar(d):fn(d)}return typeof Promise!="undefined"&&s instanceof Promise?s.then(function(y){return pn(d,a),gn(y,d)},function(y){throw ar(d),y}):(pn(d,a),gn(s,d))}if(!o||typeof o!="object"){if((s=i(o))===void 0&&(s=o),s===li&&(s=void 0),n.D&&dn(s,!0),a){var m=[],h=[];ye("Patches").M(o,s,m,h),a(m,h)}return s}de(21,o)},this.produceWithPatches=function(o,i){if(typeof o=="function")return function(s){for(var d=arguments.length,p=Array(d>1?d-1:0),g=1;g<d;g++)p[g-1]=arguments[g];return n.produceWithPatches(s,function(m){return o.apply(void 0,[m].concat(p))})};var a,c,u=n.produce(o,i,function(s,d){a=s,c=d});return typeof Promise!="undefined"&&u instanceof Promise?u.then(function(s){return[s,a,c]}):[u,a,c]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var e=t.prototype;return e.createDraft=function(r){pe(r)||de(8),Ee(r)&&(r=Gc(r));var n=oi(this),o=vn(this,r,void 0);return o[_].C=!0,fn(n),o},e.finishDraft=function(r,n){var o=r&&r[_],i=o.A;return pn(i,n),gn(void 0,i)},e.setAutoFreeze=function(r){this.D=r},e.setUseProxies=function(r){r&&!di&&de(20),this.O=r},e.applyPatches=function(r,n){var o;for(o=n.length-1;o>=0;o--){var i=n[o];if(i.path.length===0&&i.op==="replace"){r=i.value;break}}o>-1&&(n=n.slice(o+1));var a=ye("Patches").$;return Ee(r)?a(r,n):this.produce(r,function(c){return a(c,n)})},t}(),se=new Zc,eu=se.produce,Zp=se.produceWithPatches.bind(se),ef=se.setAutoFreeze.bind(se),tf=se.setUseProxies.bind(se),rf=se.applyPatches.bind(se),nf=se.createDraft.bind(se),of=se.finishDraft.bind(se),ur=eu;function Ne(t){return Ne=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ne(t)}function Cn(t,e){if(Ne(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ne(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rn(t){var e=Cn(t,"string");return Ne(e)==="symbol"?e:String(e)}function xn(t,e,r){return e=Rn(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fi(Object(r),!0).forEach(function(n){xn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fi(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function te(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var gi=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),An=function(){return Math.random().toString(36).substring(7).split("").join(".")},lr={INIT:"@@redux/INIT"+An(),REPLACE:"@@redux/REPLACE"+An(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+An()}};function tu(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function wn(t,e,r){var n;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(te(0));if(typeof e=="function"&&typeof r=="undefined"&&(r=e,e=void 0),typeof r!="undefined"){if(typeof r!="function")throw new Error(te(1));return r(wn)(t,e)}if(typeof t!="function")throw new Error(te(2));var o=t,i=e,a=[],c=a,u=!1;function s(){c===a&&(c=a.slice())}function d(){if(u)throw new Error(te(3));return i}function p(y){if(typeof y!="function")throw new Error(te(4));if(u)throw new Error(te(5));var R=!0;return s(),c.push(y),function(){if(!!R){if(u)throw new Error(te(6));R=!1,s();var w=c.indexOf(y);c.splice(w,1),a=null}}}function g(y){if(!tu(y))throw new Error(te(7));if(typeof y.type=="undefined")throw new Error(te(8));if(u)throw new Error(te(9));try{u=!0,i=o(i,y)}finally{u=!1}for(var R=a=c,b=0;b<R.length;b++){var w=R[b];w()}return y}function m(y){if(typeof y!="function")throw new Error(te(10));o=y,g({type:lr.REPLACE})}function h(){var y,R=p;return y={subscribe:function(w){if(typeof w!="object"||w===null)throw new Error(te(11));function E(){w.next&&w.next(d())}E();var k=R(E);return{unsubscribe:k}}},y[gi]=function(){return this},y}return g({type:lr.INIT}),n={dispatch:g,subscribe:p,getState:d,replaceReducer:m},n[gi]=h,n}function ru(t){Object.keys(t).forEach(function(e){var r=t[e],n=r(void 0,{type:lr.INIT});if(typeof n=="undefined")throw new Error(te(12));if(typeof r(void 0,{type:lr.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(te(13))})}function mr(t){for(var e=Object.keys(t),r={},n=0;n<e.length;n++){var o=e[n];typeof t[o]=="function"&&(r[o]=t[o])}var i=Object.keys(r),a,c;try{ru(r)}catch(u){c=u}return function(s,d){if(s===void 0&&(s={}),c)throw c;if(!1)var p;for(var g=!1,m={},h=0;h<i.length;h++){var y=i[h],R=r[y],b=s[y],w=R(b,d);if(typeof w=="undefined"){var E=d&&d.type;throw new Error(te(14))}m[y]=w,g=g||w!==b}return g=g||i.length!==Object.keys(s).length,g?m:s}}function lt(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===0?function(n){return n}:e.length===1?e[0]:e.reduce(function(n,o){return function(){return n(o.apply(void 0,arguments))}})}function hi(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(n){return function(){var o=n.apply(void 0,arguments),i=function(){throw new Error(te(15))},a={getState:o.getState,dispatch:function(){return i.apply(void 0,arguments)}},c=e.map(function(u){return u(a)});return i=lt.apply(void 0,c)(o.dispatch),dr(dr({},o),{},{dispatch:i})}}}function yi(t){var e=function(n){var o=n.dispatch,i=n.getState;return function(a){return function(c){return typeof c=="function"?c(o,i,t):a(c)}}};return e}var vi=yi();vi.withExtraArgument=yi;var Pn=vi;var Si=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nu=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(s){return function(d){return u([s,d])}}function u(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=s[0]&2?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(s[0]===6&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(d){s=[6,d],o=0}finally{n=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},mt=function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t},ou=Object.defineProperty,iu=Object.defineProperties,au=Object.getOwnPropertyDescriptors,bi=Object.getOwnPropertySymbols,su=Object.prototype.hasOwnProperty,cu=Object.prototype.propertyIsEnumerable,Ci=function(t,e,r){return e in t?ou(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r},pt=function(t,e){for(var r in e||(e={}))su.call(e,r)&&Ci(t,r,e[r]);if(bi)for(var n=0,o=bi(e);n<o.length;n++){var r=o[n];cu.call(e,r)&&Ci(t,r,e[r])}return t},En=function(t,e){return iu(t,au(e))},uu=function(t,e,r){return new Promise(function(n,o){var i=function(u){try{c(r.next(u))}catch(s){o(s)}},a=function(u){try{c(r.throw(u))}catch(s){o(s)}},c=function(u){return u.done?n(u.value):Promise.resolve(u.value).then(i,a)};c((r=r.apply(t,e)).next())})};var du=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?lt:lt.apply(null,arguments)},xf=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(t){return t}};function lu(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var r=e;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return e===r}function F(t,e){function r(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(e){var i=e.apply(void 0,n);if(!i)throw new Error("prepareAction did not return an object");return pt(pt({type:t,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:t,payload:n[0]}}return r.toString=function(){return""+t},r.type=t,r.match=function(n){return n.type===t},r}var mu=function(t){Si(e,t);function e(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=t.apply(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.prototype.concat.apply(this,r)},e.prototype.prepend=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return r.length===1&&Array.isArray(r[0])?new(e.bind.apply(e,mt([void 0],r[0].concat(this)))):new(e.bind.apply(e,mt([void 0],r.concat(this))))},e}(Array),pu=function(t){Si(e,t);function e(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=t.apply(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.prototype.concat.apply(this,r)},e.prototype.prepend=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return r.length===1&&Array.isArray(r[0])?new(e.bind.apply(e,mt([void 0],r[0].concat(this)))):new(e.bind.apply(e,mt([void 0],r.concat(this))))},e}(Array);function Ri(t){return pe(t)?ur(t,function(){}):t}function fu(t){return typeof t=="boolean"}function gu(){return function(e){return hu(e)}}function hu(t){t===void 0&&(t={});var e=t.thunk,r=e===void 0?!0:e,n=t.immutableCheck,o=n===void 0?!0:n,i=t.serializableCheck,a=i===void 0?!0:i,c=t.actionCreatorCheck,u=c===void 0?!0:c,s=new mu;if(r&&(fu(r)?s.push(Pn):s.push(Pn.withExtraArgument(r.extraArgument))),!1){if(o)var d;if(a)var p;if(u)var g}return s}var kn=!0;function xi(t){var e=gu(),r=t||{},n=r.reducer,o=n===void 0?void 0:n,i=r.middleware,a=i===void 0?e():i,c=r.devTools,u=c===void 0?!0:c,s=r.preloadedState,d=s===void 0?void 0:s,p=r.enhancers,g=p===void 0?void 0:p,m;if(typeof o=="function")m=o;else if(lu(o))m=mr(o);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var h=a;if(typeof h=="function"&&(h=h(e),!kn&&!Array.isArray(h)))throw new Error("when using a middleware builder function, an array of middleware must be returned");if(!kn&&h.some(function(k){return typeof k!="function"}))throw new Error("each middleware provided to configureStore must be a function");var y=hi.apply(void 0,h),R=lt;u&&(R=du(pt({trace:!kn},typeof u=="object"&&u)));var b=new pu(y),w=b;Array.isArray(g)?w=mt([y],g):typeof g=="function"&&(w=g(b));var E=R.apply(void 0,w);return wn(m,d,E)}function yu(t){var e={},r=[],n,o={addCase:function(i,a){var c=typeof i=="string"?i:i.type;if(!c)throw new Error("`builder.addCase` cannot be called with an empty action type");if(c in e)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return e[c]=a,o},addMatcher:function(i,a){return r.push({matcher:i,reducer:a}),o},addDefaultCase:function(i){return n=i,o}};return t(o),[e,r,n]}function vu(t){return typeof t=="function"}function le(t,e,r,n){r===void 0&&(r=[]);var o=typeof e=="function"?yu(e):[e,r,n],i=o[0],a=o[1],c=o[2],u;if(vu(t))u=function(){return Ri(t())};else{var s=Ri(t);u=function(){return s}}function d(p,g){p===void 0&&(p=u());var m=mt([i[g.type]],a.filter(function(h){var y=h.matcher;return y(g)}).map(function(h){var y=h.reducer;return y}));return m.filter(function(h){return!!h}).length===0&&(m=[c]),m.reduce(function(h,y){if(y)if(Ee(h)){var R=h,b=y(R,g);return b===void 0?h:b}else{if(pe(h))return ur(h,function(w){return y(w,g)});var b=y(h,g);if(b===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}return h},p)}return d.getInitialState=u,d}var Su="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",bu=function(t){t===void 0&&(t=21);for(var e="",r=t;r--;)e+=Su[Math.random()*64|0];return e},Cu=["name","message","stack","code"],On=function(){function t(e,r){this.payload=e,this.meta=r}return t}(),Ai=function(){function t(e,r){this.payload=e,this.meta=r}return t}(),Ru=function(t){if(typeof t=="object"&&t!==null){for(var e={},r=0,n=Cu;r<n.length;r++){var o=n[r];typeof t[o]=="string"&&(e[o]=t[o])}return e}return{message:String(t)}},Me=function(){function t(e,r,n){var o=F(e+"/fulfilled",function(d,p,g,m){return{payload:d,meta:En(pt({},m||{}),{arg:g,requestId:p,requestStatus:"fulfilled"})}}),i=F(e+"/pending",function(d,p,g){return{payload:void 0,meta:En(pt({},g||{}),{arg:p,requestId:d,requestStatus:"pending"})}}),a=F(e+"/rejected",function(d,p,g,m,h){return{payload:m,error:(n&&n.serializeError||Ru)(d||"Rejected"),meta:En(pt({},h||{}),{arg:g,requestId:p,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(d==null?void 0:d.name)==="AbortError",condition:(d==null?void 0:d.name)==="ConditionError"})}}),c=!1,u=typeof AbortController!="undefined"?AbortController:function(){function d(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return d.prototype.abort=function(){},d}();function s(d){return function(p,g,m){var h=(n==null?void 0:n.idGenerator)?n.idGenerator(d):bu(),y=new u,R,b=!1;function w(k){R=k,y.abort()}var E=function(){return uu(this,null,function(){var k,B,z,G,M,D,Be;return nu(this,function(Re){switch(Re.label){case 0:return Re.trys.push([0,4,,5]),G=(k=n==null?void 0:n.condition)==null?void 0:k.call(n,d,{getState:g,extra:m}),Au(G)?[4,G]:[3,2];case 1:G=Re.sent(),Re.label=2;case 2:if(G===!1||y.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return b=!0,M=new Promise(function(A,S){return y.signal.addEventListener("abort",function(){return S({name:"AbortError",message:R||"Aborted"})})}),p(i(h,d,(B=n==null?void 0:n.getPendingMeta)==null?void 0:B.call(n,{requestId:h,arg:d},{getState:g,extra:m}))),[4,Promise.race([M,Promise.resolve(r(d,{dispatch:p,getState:g,extra:m,requestId:h,signal:y.signal,abort:w,rejectWithValue:function(A,S){return new On(A,S)},fulfillWithValue:function(A,S){return new Ai(A,S)}})).then(function(A){if(A instanceof On)throw A;return A instanceof Ai?o(A.payload,h,d,A.meta):o(A,h,d)})])];case 3:return z=Re.sent(),[3,5];case 4:return D=Re.sent(),z=D instanceof On?a(null,h,d,D.payload,D.meta):a(D,h,d),[3,5];case 5:return Be=n&&!n.dispatchConditionRejection&&a.match(z)&&z.meta.condition,Be||p(z),[2,z]}})})}();return Object.assign(E,{abort:w,requestId:h,arg:d,unwrap:function(){return E.then(xu)}})}}return Object.assign(s,{pending:i,rejected:a,fulfilled:o,typePrefix:e})}return t.withTypes=function(){return t},t}();function xu(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function Au(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var wu="task",wi="listener",Pi="completed",In="cancelled",Ef="task-"+In,kf="task-"+Pi,Of=wi+"-"+In,If=wi+"-"+Pi,Ff=function(){function t(e){this.code=e,this.name="TaskAbortError",this.message=wu+" "+In+" (reason: "+e+")"}return t}();var Fn="listenerMiddleware";var Tf=F(Fn+"/add"),Df=F(Fn+"/removeAll"),Lf=F(Fn+"/remove");var Ei,Nf=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:typeof global!="undefined"?global:globalThis):function(t){return(Ei||(Ei=Promise.resolve())).then(t).catch(function(e){return setTimeout(function(){throw e},0)})},Pu=function(t){return function(e){setTimeout(e,t)}},Mf=typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:Pu(10);ci();var H=new L({required:!0,emptyAllowed:!1}),V=new L({required:!1,emptyAllowed:!1}),Ye=new L({required:!0,emptyAllowed:!0}),Eu=({message:t,name:e,stack:r})=>({message:t,name:e,stack:r}),Tn=(t,e)=>{if("required"in e)return{payload:new j({value:e}).validate({value:t}).value};let o=new $({options:{required:!0},values:e}).validate(t);if(o)throw new zr(o);return{payload:t}},N=(t,e)=>{try{return Tn(t,e)}catch(r){return{payload:t,error:Eu(r)}}},ki=(t,e,r,n)=>{let o=`Check the initialState of ${n}`;return Oi(t,e,r,o,"Controller initialization error")},J=(t,e,r,n)=>{let o=`Check the options of ${n}`;return Oi(t,e,r,o,"Controller initialization error")},Oi=(t,e,r,n,o)=>{try{return e.validate(r,n)}catch(i){throw t.logger.error(i,o),i}};var Dn=()=>V,Ii=()=>H,je=F("configuration/updateBasicConfiguration",t=>N(t,{accessToken:V,organizationId:V,platformUrl:V})),ft=F("configuration/updateSearchConfiguration",t=>N(t,{apiBaseUrl:V,pipeline:new L({required:!1,emptyAllowed:!0}),searchHub:V,timezone:V,locale:V,authenticationProviders:new ue({required:!1,each:H})})),gt=F("configuration/updateAnalyticsConfiguration",t=>(rr()&&(t.enabled=!1),N(t,{enabled:new Fe({default:!0}),originContext:Dn(),originLevel2:Dn(),originLevel3:Dn(),apiBaseUrl:V,nextApiBaseUrl:V,runtimeEnvironment:new ze,anonymous:new Fe({default:!1}),deviceId:V,userDisplayName:V,documentLocation:V,trackingId:V,analyticsMode:new L({constrainTo:["legacy","next"],required:!1,default:"legacy"})}))),ht=F("configuration/analytics/disable"),yt=F("configuration/analytics/enable"),pr=F("configuration/analytics/originlevel2",t=>N(t,{originLevel2:Ii()})),fr=F("configuration/analytics/originlevel3",t=>N(t,{originLevel3:Ii()}));function ve(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r}function f(t,e,r,n){function o(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function c(d){try{s(n.next(d))}catch(p){a(p)}}function u(d){try{s(n.throw(d))}catch(p){a(p)}}function s(d){d.done?i(d.value):o(d.value).then(c,u)}s((n=n.apply(t,e||[])).next())})}var T;(function(t){t.search="search",t.click="click",t.custom="custom",t.view="view",t.collect="collect"})(T||(T={}));function ku(){return typeof window!="undefined"}function Ln(){return typeof navigator!="undefined"}function vt(){return typeof document!="undefined"}function Nn(){try{return typeof localStorage!="undefined"}catch{return!1}}function Ou(){try{return typeof sessionStorage!="undefined"}catch{return!1}}function Fi(){return Ln()&&navigator.cookieEnabled}var Iu=[T.click,T.custom,T.search,T.view],Fu=(t,e)=>Iu.indexOf(t)!==-1?Object.assign({language:vt()?document.documentElement.lang:"unknown",userAgent:Ln()?navigator.userAgent:"unknown"},e):e,St=class{static set(e,r,n){var o,i,a,c;n&&(i=new Date,i.setTime(i.getTime()+n)),c=window.location.hostname,c.indexOf(".")===-1?Ti(e,r,i):(a=c.split("."),o=a[a.length-2]+"."+a[a.length-1],Ti(e,r,i,o))}static get(e){for(var r=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){var i=n[o];if(i=i.replace(/^\s+/,""),i.lastIndexOf(r,0)===0)return i.substring(r.length,i.length)}return null}static erase(e){St.set(e,"",-1)}};function Ti(t,e,r,n){document.cookie=`${t}=${e}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function Tu(){return Nn()?localStorage:Fi()?new qe:Ou()?sessionStorage:new bt}var qe=class{getItem(e){return St.get(`${qe.prefix}${e}`)}removeItem(e){St.erase(`${qe.prefix}${e}`)}setItem(e,r,n){St.set(`${qe.prefix}${e}`,r,n)}};qe.prefix="coveo_";var Di=class{constructor(){this.cookieStorage=new qe}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,r){localStorage.setItem(e,r),this.cookieStorage.setItem(e,r,31556926e3)}},bt=class{getItem(e){return null}removeItem(e){}setItem(e,r){}},_t="__coveo.analytics.history",Li=20,Ni=1e3*60,Mi=75,Bt=class{constructor(e){this.store=e||Tu()}addElement(e){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let r=this.getHistoryWithInternalTime();r!=null?this.isValidEntry(e)&&this.setHistory([e].concat(r)):this.setHistory([e])}addElementAsync(e){return f(this,void 0,void 0,function*(){e.internalTime=new Date().getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let r=yield this.getHistoryWithInternalTimeAsync();r!=null?this.isValidEntry(e)&&this.setHistory([e].concat(r)):this.setHistory([e])})}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return f(this,void 0,void 0,function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))})}getHistoryWithInternalTime(){try{let e=this.store.getItem(_t);return e&&typeof e=="string"?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return f(this,void 0,void 0,function*(){try{let e=yield this.store.getItem(_t);return e?JSON.parse(e):[]}catch{return[]}})}setHistory(e){try{this.store.setItem(_t,JSON.stringify(e.slice(0,Li)))}catch{}}clear(){try{this.store.removeItem(_t)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort((n,o)=>(o.internalTime||0)-(n.internalTime||0))[0]:null}cropQueryElement(e){return e.name&&e.value&&e.name.toLowerCase()==="query"&&(e.value=e.value.slice(0,Mi)),e}isValidEntry(e){let r=this.getMostRecentElement();return r&&r.value==e.value?(e.internalTime||0)-(r.internalTime||0)>Ni:!0}stripInternalTime(e){return Array.isArray(e)?e.map(r=>{let{name:n,time:o,value:i}=r;return{name:n,time:o,value:i}}):[]}stripEmptyQuery(e){let{name:r,time:n,value:o}=e;return r&&typeof o=="string"&&r.toLowerCase()==="query"&&o.trim()===""?{name:r,time:n}:e}stripEmptyQueries(e){return e.map(r=>this.stripEmptyQuery(r))}},ji=Object.freeze({__proto__:null,HistoryStore:Bt,MAX_NUMBER_OF_HISTORY_ELEMENTS:Li,MAX_VALUE_SIZE:Mi,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:Ni,STORE_KEY:_t,default:Bt}),Du=(t,e)=>f(void 0,void 0,void 0,function*(){return t===T.view?(yield Lu(e.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},e)):e}),Lu=t=>f(void 0,void 0,void 0,function*(){let e=new Bt,r={name:"PageView",value:t,time:new Date().toISOString()};yield e.addElementAsync(r)}),gr,Nu=new Uint8Array(16);function Mu(){if(!gr&&(gr=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!gr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gr(Nu)}var ju=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function hr(t){return typeof t=="string"&&ju.test(t)}var X=[];for(let t=0;t<256;++t)X.push((t+256).toString(16).slice(1));function qi(t,e=0){return(X[t[e+0]]+X[t[e+1]]+X[t[e+2]]+X[t[e+3]]+"-"+X[t[e+4]]+X[t[e+5]]+"-"+X[t[e+6]]+X[t[e+7]]+"-"+X[t[e+8]]+X[t[e+9]]+"-"+X[t[e+10]]+X[t[e+11]]+X[t[e+12]]+X[t[e+13]]+X[t[e+14]]+X[t[e+15]]).toLowerCase()}function qu(t){if(!hr(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}function Uu(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var Vu="6ba7b810-9dad-11d1-80b4-00c04fd430c8",_u="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Bu(t,e,r){function n(o,i,a,c){var u;if(typeof o=="string"&&(o=Uu(o)),typeof i=="string"&&(i=qu(i)),((u=i)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+o.length);if(s.set(i),s.set(o,i.length),s=r(s),s[6]=s[6]&15|e,s[8]=s[8]&63|128,a){c=c||0;for(let d=0;d<16;++d)a[c+d]=s[d];return a}return qi(s)}try{n.name=t}catch{}return n.DNS=Vu,n.URL=_u,n}var $u=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ui={randomUUID:$u};function Je(t,e,r){if(Ui.randomUUID&&!e&&!t)return Ui.randomUUID();t=t||{};let n=t.random||(t.rng||Mu)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let o=0;o<16;++o)e[r+o]=n[o];return e}return qi(n)}function Hu(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:return e^r^n;case 2:return e&r^e&n^r&n;case 3:return e^r^n}}function Mn(t,e){return t<<e|t>>>32-e}function zu(t){let e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){let a=unescape(encodeURIComponent(t));t=[];for(let c=0;c<a.length;++c)t.push(a.charCodeAt(c))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);let n=t.length/4+2,o=Math.ceil(n/16),i=new Array(o);for(let a=0;a<o;++a){let c=new Uint32Array(16);for(let u=0;u<16;++u)c[u]=t[a*64+u*4]<<24|t[a*64+u*4+1]<<16|t[a*64+u*4+2]<<8|t[a*64+u*4+3];i[a]=c}i[o-1][14]=(t.length-1)*8/Math.pow(2,32),i[o-1][14]=Math.floor(i[o-1][14]),i[o-1][15]=(t.length-1)*8&4294967295;for(let a=0;a<o;++a){let c=new Uint32Array(80);for(let m=0;m<16;++m)c[m]=i[a][m];for(let m=16;m<80;++m)c[m]=Mn(c[m-3]^c[m-8]^c[m-14]^c[m-16],1);let u=r[0],s=r[1],d=r[2],p=r[3],g=r[4];for(let m=0;m<80;++m){let h=Math.floor(m/20),y=Mn(u,5)+Hu(h,s,d,p)+g+e[h]+c[m]>>>0;g=p,p=d,d=Mn(s,30)>>>0,s=u,u=y}r[0]=r[0]+u>>>0,r[1]=r[1]+s>>>0,r[2]=r[2]+d>>>0,r[3]=r[3]+p>>>0,r[4]=r[4]+g>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Qu=Bu("v5",80,zu),Vi=Qu,_i="2.28.23",Bi=t=>`${t.protocol}//${t.hostname}${t.pathname.indexOf("/")===0?t.pathname:`/${t.pathname}`}${t.search}`,$t={pageview:"pageview",event:"event"},jn=class{constructor({client:e,uuidGenerator:r=Je}){this.client=e,this.uuidGenerator=r}},$i=class extends jn{constructor({client:e,uuidGenerator:r=Je}){super({client:e,uuidGenerator:r});this.actionData={},this.pageViewId=r(),this.nextPageViewId=this.pageViewId,this.currentLocation=Bi(window.location),this.lastReferrer=vt()?document.referrer:"",this.addHooks()}getApi(e){switch(e){case"setAction":return this.setAction;default:return null}}setAction(e,r){this.action=e,this.actionData=r}clearData(){this.clearPluginData(),this.action=void 0,this.actionData={}}getLocationInformation(e,r){return Object.assign({hitType:e},this.getNextValues(e,r))}updateLocationInformation(e,r){this.updateLocationForNextPageView(e,r)}getDefaultContextInformation(e){let r={title:vt()?document.title:"",encoding:vt()?document.characterSet:"UTF-8"},n={screenResolution:`${screen.width}x${screen.height}`,screenColor:`${screen.colorDepth}-bit`},o={language:navigator.language,userAgent:navigator.userAgent},i={time:Date.now(),eventId:this.uuidGenerator()};return Object.assign(Object.assign(Object.assign(Object.assign({},i),n),o),r)}updateLocationForNextPageView(e,r){let{pageViewId:n,referrer:o,location:i}=this.getNextValues(e,r);this.lastReferrer=o,this.pageViewId=n,this.currentLocation=i,e===$t.pageview&&(this.nextPageViewId=this.uuidGenerator(),this.hasSentFirstPageView=!0)}getNextValues(e,r){return{pageViewId:e===$t.pageview?this.nextPageViewId:this.pageViewId,referrer:e===$t.pageview&&this.hasSentFirstPageView?this.currentLocation:this.lastReferrer,location:e===$t.pageview?this.getCurrentLocationFromPayload(r):this.currentLocation}}getCurrentLocationFromPayload(e){if(e.page){let r=o=>o.replace(/^\/?(.*)$/,"/$1");return`${(o=>o.split("/").slice(0,3).join("/"))(this.currentLocation)}${r(e.page)}`}else return Bi(window.location)}},Se=class{constructor(e,r){if(!hr(e))throw Error("Not a valid uuid");this.clientId=e,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let e=Math.floor(Date.now()/1e3)-this.creationDate;return e<0||e>Se.expirationTime}validate(e,r){return!this.expired&&this.matchReferrer(e,r)}matchReferrer(e,r){try{let n=new URL(e);return r.some(o=>new RegExp(o.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return!1}}static fromString(e){let r=e.split(".");if(r.length!==2)return null;let[n,o]=r;if(n.length!==32||isNaN(parseInt(o)))return null;let i=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return hr(i)?new Se(i,Number.parseInt(o)*1e3):null}};Se.cvo_cid="cvo_cid";Se.expirationTime=120;var Hi=class extends jn{constructor({client:e,uuidGenerator:r=Je}){super({client:e,uuidGenerator:r})}getApi(e){switch(e){case"decorate":return this.decorate;case"acceptFrom":return this.acceptFrom;default:return null}}decorate(e){return f(this,void 0,void 0,function*(){if(!this.client.getCurrentVisitorId)throw new Error("Could not retrieve current clientId");try{let r=new URL(e),n=yield this.client.getCurrentVisitorId();return r.searchParams.set(Se.cvo_cid,new Se(n,Date.now()).toString()),r.toString()}catch{throw new Error("Invalid URL provided")}})}acceptFrom(e){this.client.setAcceptedLinkReferrers(e)}};Hi.Id="link";var me=Object.keys;function yr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}var qn={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Wu=me(qn).map(t=>qn[t]),Ku=[...Wu].join("|"),Gu=new RegExp(`^(${Ku}$)`),Yu={svcAction:"svc_action",svcActionData:"svc_action_data"},Ju=t=>me(t).filter(e=>t[e]!==void 0).reduce((e,r)=>{let n=qn[r]||r;return Object.assign(Object.assign({},e),{[n]:t[r]})},{}),Xu=t=>Gu.test(t),Zu=[Xu],zi={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},Qi={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},re={action:"pa",list:"pal",listSource:"pls"},vr={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},ed=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],Un={id:"quoteId",affiliation:"quoteAffiliation"},Vn={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},td={add:re,bookmark_add:re,bookmark_remove:re,click:re,checkout:re,checkout_option:re,detail:re,impression:re,remove:re,refund:Object.assign(Object.assign({},re),vr),purchase:Object.assign(Object.assign({},re),vr),quickview:re,quote:Object.assign(Object.assign({},re),Un),review:Object.assign(Object.assign({},re),Vn)},rd=me(zi).map(t=>zi[t]),nd=me(Qi).map(t=>Qi[t]),od=me(re).map(t=>re[t]),id=me(vr).map(t=>vr[t]),ad=me(Vn).map(t=>Vn[t]),sd=me(Un).map(t=>Un[t]),cd=[...rd,"custom"].join("|"),ud=[...nd,"custom"].join("|"),Wi="(pr[0-9]+)",Ki="(il[0-9]+pi[0-9]+)",dd=new RegExp(`^${Wi}(${cd})$`),ld=new RegExp(`^(${Ki}(${ud}))|(il[0-9]+nm)$`),md=new RegExp(`^(${od.join("|")})$`),pd=new RegExp(`^(${id.join("|")})$`),fd=new RegExp(`^${Wi}custom$`),gd=new RegExp(`^${Ki}custom$`),hd=new RegExp(`^(${[...ed,...ad,...sd].join("|")})$`),yd=t=>dd.test(t),vd=t=>ld.test(t),Sd=t=>md.test(t),bd=t=>pd.test(t),Cd=t=>hd.test(t),Rd=[vd,yd,Sd,bd,Cd],xd=[fd,gd],Ad={anonymizeIp:"aip"},wd={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},Pd={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},Ed=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],kd=Object.assign(Object.assign(Object.assign(Object.assign({},Ad),wd),Pd),Ed.reduce((t,e)=>Object.assign(Object.assign({},t),{[e]:e}),{})),_n=Object.assign(Object.assign({},kd),Yu),Od=t=>{let e=!!t.action&&td[t.action]||{};return me(t).reduce((r,n)=>{let o=e[n]||_n[n]||n;return Object.assign(Object.assign({},r),{[o]:t[n]})},{})},Id=me(_n).map(t=>_n[t]),Fd=t=>Id.indexOf(t)!==-1,Td=t=>t==="custom",Dd=t=>[...Rd,...Zu,Fd,Td].some(e=>e(t)),Ld=t=>me(t).reduce((e,r)=>{let n=Nd(r);return n?Object.assign(Object.assign({},e),Md(n,t[r])):Object.assign(Object.assign({},e),{[r]:t[r]})},{}),Nd=t=>{let e;return[...xd].every(r=>{var n;return e=(n=r.exec(t))===null||n===void 0?void 0:n[1],!Boolean(e)}),e},Md=(t,e)=>me(e).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${t}${n}`]:e[n]}),{}),Gi=class{constructor(e){this.opts=e}sendEvent(e,r){return f(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:n,preprocessRequest:o}=this.opts,i=yield this.getQueryParamsForEventType(e),{url:a,payload:c}=yield this.preProcessRequestAsPotentialJSONString(`${n}/analytics/${e}?${i}`,r,o),u=this.encodeForEventType(e,c),s=new Blob([u],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(a,s)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,r,n){return f(this,void 0,void 0,function*(){let o=e,i=r;if(n){let a=yield n({url:e,body:JSON.stringify(r)},"analyticsBeacon"),{url:c,body:u}=a;o=c||e;try{i=JSON.parse(u)}catch(s){console.error("Unable to process the request body as a JSON string",s)}}return{payload:i,url:o}})}encodeForEventType(e,r){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,r):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},r))}getQueryParamsForEventType(e){return f(this,void 0,void 0,function*(){let{token:r,visitorIdProvider:n}=this.opts,o=yield n.getCurrentVisitorId();return[r&&this.isEventTypeLegacy(e)?`access_token=${r}`:"",o?`visitorId=${o}`:"","discardVisitInfo=true"].filter(i=>!!i).join("&")})}isEventTypeLegacy(e){return[T.click,T.custom,T.search,T.view].indexOf(e)!==-1}encodeForLegacyType(e,r){return`${e}Event=${encodeURIComponent(JSON.stringify(r))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter(r=>!!e[r]).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(this.encodeValue(e[r]))}`).join("&")}encodeValue(e){return typeof e=="number"||typeof e=="string"||typeof e=="boolean"?e:JSON.stringify(e)}},Yi=class{sendEvent(e,r){return f(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return f(this,void 0,void 0,function*(){return Promise.resolve()})}},Ji=window.fetch,Bn=class{constructor(e){this.opts=e}sendEvent(e,r){return f(this,void 0,void 0,function*(){let{baseUrl:n,visitorIdProvider:o,preprocessRequest:i}=this.opts,a=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",c={url:`${n}/analytics/${e}${a}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(r)},u=Object.assign(Object.assign({},c),i?yield i(c,"analyticsFetch"):{}),{url:s}=u,d=ve(u,["url"]),p=yield Ji(s,d);if(p.ok){let g=yield p.json();return g.visitorId&&o.setCurrentVisitorId(g.visitorId),g}else{try{p.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,p,r),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return f(this,void 0,void 0,function*(){let{baseUrl:e}=this.opts,r=`${e}/analytics/visit`;yield Ji(r,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(e){return[T.click,T.custom,T.search,T.view].indexOf(e)!==-1}getVisitorIdParam(){return f(this,void 0,void 0,function*(){let{visitorIdProvider:e}=this.opts,r=yield e.getCurrentVisitorId();return r?`?visitor=${r}`:""})}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},Xi=class{constructor(e,r){Nn()&&Fi()?this.storage=new Di:Nn()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new bt),this.client=new Bn(e),this.beaconClient=new Gi(e),window.addEventListener("beforeunload",()=>{let n=r();for(let{eventType:o,payload:i}of n)this.beaconClient.sendEvent(o,i)})}getClientDependingOnEventType(e){return e==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},Zi=class{constructor(e,r){this.storage=r||new bt,this.client=new Bn(e)}getClientDependingOnEventType(e){return this.client}},ea=class{constructor(){this.storage=new bt,this.client=new Yi}getClientDependingOnEventType(e){return this.client}},jd="xx",qd=t=>(t==null?void 0:t.startsWith(jd))||!1,Ud=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function Vd(){return typeof navigator!="undefined"&&navigator.product=="ReactNative"}var _d=["1",1,"yes",!0];function Ht(){return Ln()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some(t=>_d.indexOf(t)!==-1)}var ta="v15",ra={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function Bd(t=ra.default,e=ta,r=!1){if(t=t.replace(/\/$/,""),r)return`${t}/${e}`;let n=t.endsWith("/rest")||t.endsWith("/rest/ua");return`${t}${n?"":"/rest"}/${e}`}var $d="38824e1f-37f5-42d3-8372-a4b8fa9df946",oe=class{get defaultOptions(){return{endpoint:ra.default,isCustomEndpoint:!1,token:"",version:ta,beforeSendHooks:[],afterSendHooks:[]}}get version(){return _i}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Du,Fu].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let r={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};this.runtime=this.options.runtimeEnvironment||this.initRuntime(r),Ht()&&(this.clear(),this.runtime.storage=new bt),this.addEventTypeMapping(T.view,{newEventType:T.view,addClientIdParameter:!0}),this.addEventTypeMapping(T.click,{newEventType:T.click,addClientIdParameter:!0}),this.addEventTypeMapping(T.custom,{newEventType:T.custom,addClientIdParameter:!0}),this.addEventTypeMapping(T.search,{newEventType:T.search,addClientIdParameter:!0})}initRuntime(e){return ku()&&vt()?new Xi(e,()=>{let r=[...this.bufferedRequests];return this.bufferedRequests=[],r}):(Vd()&&console.warn(Ud),new Zi(e))}get storage(){return this.runtime.storage}determineVisitorId(){return f(this,void 0,void 0,function*(){try{return this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Je()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Je()}})}getCurrentVisitorId(){return f(this,void 0,void 0,function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId})}setCurrentVisitorId(e){return f(this,void 0,void 0,function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)})}setClientId(e,r){return f(this,void 0,void 0,function*(){if(hr(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!r)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(Vi(e,Vi(r,$d)))}})}getParameters(e,...r){return f(this,void 0,void 0,function*(){return yield this.resolveParameters(e,...r)})}getPayload(e,...r){return f(this,void 0,void 0,function*(){let n=yield this.resolveParameters(e,...r);return yield this.resolvePayloadForParameters(e,n)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(Je()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(Ht())return null;try{let r=new URL(e).searchParams.get(Se.cvo_cid);if(r==null)return null;let n=Se.fromString(r);return!n||!vt()||!n.validate(document.referrer,this.acceptedLinkReferrers)?null:n.clientId}catch{}return null}resolveParameters(e,...r){return f(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:n=[],addVisitorIdParameter:o=!1,usesMeasurementProtocol:i=!1,addClientIdParameter:a=!1}=this.eventTypeMapping[e]||{};return yield[m=>n.length>0?this.parseVariableArgumentsPayload(n,m):m[0],m=>f(this,void 0,void 0,function*(){return Object.assign(Object.assign({},m),{visitorId:o?yield this.getCurrentVisitorId():""})}),m=>f(this,void 0,void 0,function*(){return a?Object.assign(Object.assign({},m),{clientId:yield this.getCurrentVisitorId()}):m}),m=>i?this.ensureAnonymousUserWhenUsingApiKey(m):m,m=>this.beforeSendHooks.reduce((h,y)=>f(this,void 0,void 0,function*(){let R=yield h;return yield y(e,R)}),m)].reduce((m,h)=>f(this,void 0,void 0,function*(){let y=yield m;return yield h(y)}),Promise.resolve(r))})}resolvePayloadForParameters(e,r){return f(this,void 0,void 0,function*(){let{usesMeasurementProtocol:n=!1}=this.eventTypeMapping[e]||{};return yield[p=>this.setTrackingIdIfTrackingIdNotPresent(p),p=>this.removeEmptyPayloadValues(p,e),p=>this.validateParams(p,e),p=>n?Od(p):p,p=>n?this.removeUnknownParameters(p):p,p=>n?this.processCustomParameters(p):this.mapCustomParametersToCustomData(p)].reduce((p,g)=>f(this,void 0,void 0,function*(){let m=yield p;return yield g(m)}),Promise.resolve(r))})}makeEvent(e,...r){return f(this,void 0,void 0,function*(){let{newEventType:n=e}=this.eventTypeMapping[e]||{},o=yield this.resolveParameters(e,...r),i=yield this.resolvePayloadForParameters(e,o);return{eventType:n,payload:i,log:a=>f(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:n,payload:Object.assign(Object.assign({},i),a)}),yield Promise.all(this.afterSendHooks.map(c=>c(e,Object.assign(Object.assign({},o),a)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(e,...r){return f(this,void 0,void 0,function*(){return(yield this.makeEvent(e,...r)).log({})})}deferExecution(){return new Promise(e=>setTimeout(e,0))}sendFromBuffer(){return f(this,void 0,void 0,function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:r,payload:n}=e;return this.runtime.getClientDependingOnEventType(r).sendEvent(r,n)}})}clear(){this.storage.removeItem("visitorId"),new Bt().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return f(this,void 0,void 0,function*(){return this.makeEvent(T.search,e)})}sendSearchEvent(e){var{searchQueryUid:r}=e,n=ve(e,["searchQueryUid"]);return f(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(n)).log({searchQueryUid:r})})}makeClickEvent(e){return f(this,void 0,void 0,function*(){return this.makeEvent(T.click,e)})}sendClickEvent(e){var{searchQueryUid:r}=e,n=ve(e,["searchQueryUid"]);return f(this,void 0,void 0,function*(){return(yield this.makeClickEvent(n)).log({searchQueryUid:r})})}makeCustomEvent(e){return f(this,void 0,void 0,function*(){return this.makeEvent(T.custom,e)})}sendCustomEvent(e){var{lastSearchQueryUid:r}=e,n=ve(e,["lastSearchQueryUid"]);return f(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(n)).log({lastSearchQueryUid:r})})}makeViewEvent(e){return f(this,void 0,void 0,function*(){return this.makeEvent(T.view,e)})}sendViewEvent(e){return f(this,void 0,void 0,function*(){return(yield this.makeViewEvent(e)).log({})})}getVisit(){return f(this,void 0,void 0,function*(){let r=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=r.visitorId,r})}getHealth(){return f(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,r){this.eventTypeMapping[e]=r}setAcceptedLinkReferrers(e){if(Array.isArray(e)&&e.every(r=>typeof r=="string"))this.acceptedLinkReferrers=e;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(e,r){let n={};for(let o=0,i=r.length;o<i;o++){let a=r[o];if(typeof a=="string")n[e[o]]=a;else if(typeof a=="object")return Object.assign(Object.assign({},n),a)}return n}isKeyAllowedEmpty(e,r){return({[T.search]:["queryText"]}[e]||[]).indexOf(r)!==-1}removeEmptyPayloadValues(e,r){let n=o=>typeof o!="undefined"&&o!==null&&o!=="";return Object.keys(e).filter(o=>this.isKeyAllowedEmpty(r,o)||n(e[o])).reduce((o,i)=>Object.assign(Object.assign({},o),{[i]:e[i]}),{})}removeUnknownParameters(e){return Object.keys(e).filter(n=>{if(Dd(n))return!0;console.log(n,"is not processed by coveoua")}).reduce((n,o)=>Object.assign(Object.assign({},n),{[o]:e[o]}),{})}processCustomParameters(e){let{custom:r}=e,n=ve(e,["custom"]),o={};r&&yr(r)&&(o=this.lowercaseKeys(r));let i=Ld(n);return Object.assign(Object.assign({},o),i)}mapCustomParametersToCustomData(e){let{custom:r}=e,n=ve(e,["custom"]);if(r&&yr(r)){let o=this.lowercaseKeys(r);return Object.assign(Object.assign({},n),{customData:Object.assign(Object.assign({},o),e.customData)})}else return e}lowercaseKeys(e){let r=Object.keys(e),n={};return r.forEach(o=>{n[o.toLowerCase()]=e[o]}),n}validateParams(e,r){let{anonymizeIp:n}=e,o=ve(e,["anonymizeIp"]);return n!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${n}`.toLowerCase())==-1&&(o.anonymizeIp=1),(r==T.view||r==T.click||r==T.search||r==T.custom)&&(o.originLevel3=this.limit(o.originLevel3,128)),r==T.view&&(o.location=this.limit(o.location,128)),(r=="pageview"||r=="event")&&(o.referrer=this.limit(o.referrer,2048),o.location=this.limit(o.location,2048),o.page=this.limit(o.page,2048)),o}ensureAnonymousUserWhenUsingApiKey(e){let{userId:r}=e,n=ve(e,["userId"]);return qd(this.options.token)&&!r?(n.userId="anonymous",n):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:r}=e,n=ve(e,["trackingId"]);return r?e:(n.hasOwnProperty("custom")&&yr(n.custom)&&(n.custom.hasOwnProperty("context_website")||n.custom.hasOwnProperty("siteName"))&&(n.trackingId=n.custom.context_website||n.custom.siteName),n.hasOwnProperty("customData")&&yr(n.customData)&&(n.customData.hasOwnProperty("context_website")||n.customData.hasOwnProperty("siteName"))&&(n.trackingId=n.customData.context_website||n.customData.siteName),n)}limit(e,r){return typeof e!="string"?e:e.substring(0,r)}get baseUrl(){return Bd(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},Z;(function(t){t.contextChanged="contextChanged",t.expandToFullUI="expandToFullUI",t.openUserActions="openUserActions",t.showPrecedingSessions="showPrecedingSessions",t.showFollowingSessions="showFollowingSessions",t.clickViewedDocument="clickViewedDocument",t.clickPageView="clickPageView",t.createArticle="createArticle"})(Z||(Z={}));var l;(function(t){t.interfaceLoad="interfaceLoad",t.interfaceChange="interfaceChange",t.didyoumeanAutomatic="didyoumeanAutomatic",t.didyoumeanClick="didyoumeanClick",t.resultsSort="resultsSort",t.searchboxSubmit="searchboxSubmit",t.searchboxClear="searchboxClear",t.searchboxAsYouType="searchboxAsYouType",t.breadcrumbFacet="breadcrumbFacet",t.breadcrumbResetAll="breadcrumbResetAll",t.documentQuickview="documentQuickview",t.documentOpen="documentOpen",t.omniboxAnalytics="omniboxAnalytics",t.omniboxFromLink="omniboxFromLink",t.searchFromLink="searchFromLink",t.triggerNotify="notify",t.triggerExecute="execute",t.triggerQuery="query",t.undoTriggerQuery="undoQuery",t.triggerRedirect="redirect",t.pagerResize="pagerResize",t.pagerNumber="pagerNumber",t.pagerNext="pagerNext",t.pagerPrevious="pagerPrevious",t.pagerScrolling="pagerScrolling",t.staticFilterClearAll="staticFilterClearAll",t.staticFilterSelect="staticFilterSelect",t.staticFilterDeselect="staticFilterDeselect",t.facetClearAll="facetClearAll",t.facetSearch="facetSearch",t.facetSelect="facetSelect",t.facetSelectAll="facetSelectAll",t.facetDeselect="facetDeselect",t.facetExclude="facetExclude",t.facetUnexclude="facetUnexclude",t.facetUpdateSort="facetUpdateSort",t.facetShowMore="showMoreFacetResults",t.facetShowLess="showLessFacetResults",t.queryError="query",t.queryErrorBack="errorBack",t.queryErrorClear="errorClearQuery",t.queryErrorRetry="errorRetry",t.recommendation="recommendation",t.recommendationInterfaceLoad="recommendationInterfaceLoad",t.recommendationOpen="recommendationOpen",t.likeSmartSnippet="likeSmartSnippet",t.dislikeSmartSnippet="dislikeSmartSnippet",t.expandSmartSnippet="expandSmartSnippet",t.collapseSmartSnippet="collapseSmartSnippet",t.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",t.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",t.sendSmartSnippetReason="sendSmartSnippetReason",t.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",t.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",t.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",t.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",t.openSmartSnippetSource="openSmartSnippetSource",t.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",t.openSmartSnippetInlineLink="openSmartSnippetInlineLink",t.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",t.recentQueryClick="recentQueriesClick",t.clearRecentQueries="clearRecentQueries",t.recentResultClick="recentResultClick",t.clearRecentResults="clearRecentResults",t.noResultsBack="noResultsBack",t.showMoreFoldedResults="showMoreFoldedResults",t.showLessFoldedResults="showLessFoldedResults",t.copyToClipboard="copyToClipboard",t.caseSendEmail="Case.SendEmail",t.feedItemTextPost="FeedItem.TextPost",t.caseAttach="caseAttach",t.caseDetach="caseDetach",t.retryGeneratedAnswer="retryGeneratedAnswer",t.likeGeneratedAnswer="likeGeneratedAnswer",t.dislikeGeneratedAnswer="dislikeGeneratedAnswer",t.openGeneratedAnswerSource="openGeneratedAnswerSource",t.generatedAnswerStreamEnd="generatedAnswerStreamEnd",t.generatedAnswerSourceHover="generatedAnswerSourceHover",t.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",t.generatedAnswerHideAnswers="generatedAnswerHideAnswers",t.generatedAnswerShowAnswers="generatedAnswerShowAnswers",t.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",t.rephraseGeneratedAnswer="rephraseGeneratedAnswer"})(l||(l={}));var $n={[l.triggerNotify]:"queryPipelineTriggers",[l.triggerExecute]:"queryPipelineTriggers",[l.triggerQuery]:"queryPipelineTriggers",[l.triggerRedirect]:"queryPipelineTriggers",[l.queryError]:"errors",[l.queryErrorBack]:"errors",[l.queryErrorClear]:"errors",[l.queryErrorRetry]:"errors",[l.pagerNext]:"getMoreResults",[l.pagerPrevious]:"getMoreResults",[l.pagerNumber]:"getMoreResults",[l.pagerResize]:"getMoreResults",[l.pagerScrolling]:"getMoreResults",[l.facetSearch]:"facet",[l.facetShowLess]:"facet",[l.facetShowMore]:"facet",[l.recommendation]:"recommendation",[l.likeSmartSnippet]:"smartSnippet",[l.dislikeSmartSnippet]:"smartSnippet",[l.expandSmartSnippet]:"smartSnippet",[l.collapseSmartSnippet]:"smartSnippet",[l.openSmartSnippetFeedbackModal]:"smartSnippet",[l.closeSmartSnippetFeedbackModal]:"smartSnippet",[l.sendSmartSnippetReason]:"smartSnippet",[l.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[l.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[l.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[l.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[l.clearRecentQueries]:"recentQueries",[l.recentResultClick]:"recentlyClickedDocuments",[l.clearRecentResults]:"recentlyClickedDocuments",[l.showLessFoldedResults]:"folding",[l.caseDetach]:"case",[l.likeGeneratedAnswer]:"generatedAnswer",[l.dislikeGeneratedAnswer]:"generatedAnswer",[l.openGeneratedAnswerSource]:"generatedAnswer",[l.generatedAnswerStreamEnd]:"generatedAnswer",[l.generatedAnswerSourceHover]:"generatedAnswer",[l.generatedAnswerCopyToClipboard]:"generatedAnswer",[l.generatedAnswerHideAnswers]:"generatedAnswer",[l.generatedAnswerShowAnswers]:"generatedAnswer",[l.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Z.expandToFullUI]:"interface",[Z.openUserActions]:"User Actions",[Z.showPrecedingSessions]:"User Actions",[Z.showFollowingSessions]:"User Actions",[Z.clickViewedDocument]:"User Actions",[Z.clickPageView]:"User Actions",[Z.createArticle]:"createArticle"},Xe=class{constructor(){this.runtime=new ea,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(T.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(T.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(T.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(T.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return _i}};function Hd(t){let e="";return t.filter(r=>{let n=r!==e;return e=r,n})}function zd(t){return t.map(e=>e.replace(/;/g,""))}function na(t){let e=256,r=t.join(";");return r.length<=e?r:na(t.slice(1))}var oa=t=>{let e=zd(t),r=Hd(e);return na(r)};function ia(t){let e=typeof t.partialQueries=="string"?t.partialQueries:oa(t.partialQueries),r=typeof t.suggestions=="string"?t.suggestions:oa(t.suggestions);return Object.assign(Object.assign({},t),{partialQueries:e,suggestions:r})}var Ze=class{constructor(e,r){this.opts=e,this.provider=r;let n=e.enableAnalytics===!1||Ht();this.coveoAnalyticsClient=n?new Xe:new oe(e)}disable(){this.coveoAnalyticsClient instanceof oe&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Xe}enable(){this.coveoAnalyticsClient=new oe(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(l.interfaceLoad)}logInterfaceLoad(){return f(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(l.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return f(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(l.recommendation)}logRecommendation(){return f(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(e,r){return this.makeClickEvent(l.recommendationOpen,e,r)}logRecommendationOpen(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(e){return this.makeSearchEvent(l.staticFilterClearAll,e)}logStaticFilterClearAll(e){return f(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(e){return this.makeSearchEvent(l.staticFilterSelect,e)}logStaticFilterSelect(e){return f(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(e){return this.makeSearchEvent(l.staticFilterDeselect,e)}logStaticFilterDeselect(e){return f(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(l.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return f(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(e){return this.makeSearchEvent(l.interfaceChange,e)}logInterfaceChange(e){return f(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(l.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return f(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(l.didyoumeanClick)}logDidYouMeanClick(){return f(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(e){return this.makeSearchEvent(l.resultsSort,e)}logResultsSort(e){return f(this,void 0,void 0,function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(l.searchboxSubmit)}logSearchboxSubmit(){return f(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(l.searchboxClear)}logSearchboxClear(){return f(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(l.searchboxAsYouType)}logSearchboxAsYouType(){return f(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(e){return this.makeSearchEvent(l.breadcrumbFacet,e)}logBreadcrumbFacet(e){return f(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(l.breadcrumbResetAll)}logBreadcrumbResetAll(){return f(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(e,r){return this.makeClickEvent(l.documentQuickview,e,r)}logDocumentQuickview(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(e,r){return this.makeClickEvent(l.documentOpen,e,r)}logDocumentOpen(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(e){return this.makeSearchEvent(l.omniboxAnalytics,ia(e))}logOmniboxAnalytics(e){return f(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(e){return this.makeSearchEvent(l.omniboxFromLink,ia(e))}logOmniboxFromLink(e){return f(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(l.searchFromLink)}logSearchFromLink(){return f(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(e){return this.makeCustomEvent(l.triggerNotify,e)}logTriggerNotify(e){return f(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(e){return this.makeCustomEvent(l.triggerExecute,e)}logTriggerExecute(e){return f(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(l.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return f(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(e){return this.makeSearchEvent(l.undoTriggerQuery,e)}logUndoTriggerQuery(e){return f(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(e){return this.makeCustomEvent(l.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return f(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(e){return this.makeCustomEvent(l.pagerResize,e)}logPagerResize(e){return f(this,void 0,void 0,function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(e){return this.makeCustomEvent(l.pagerNumber,e)}logPagerNumber(e){return f(this,void 0,void 0,function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(e){return this.makeCustomEvent(l.pagerNext,e)}logPagerNext(e){return f(this,void 0,void 0,function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(e){return this.makeCustomEvent(l.pagerPrevious,e)}logPagerPrevious(e){return f(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(l.pagerScrolling)}logPagerScrolling(){return f(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(e){return this.makeSearchEvent(l.facetClearAll,e)}logFacetClearAll(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(e){return this.makeSearchEvent(l.facetSearch,e)}logFacetSearch(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(e){return this.makeSearchEvent(l.facetSelect,e)}logFacetSelect(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(e){return this.makeSearchEvent(l.facetDeselect,e)}logFacetDeselect(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(e){return this.makeSearchEvent(l.facetExclude,e)}logFacetExclude(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(e){return this.makeSearchEvent(l.facetUnexclude,e)}logFacetUnexclude(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(e){return this.makeSearchEvent(l.facetSelectAll,e)}logFacetSelectAll(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(e){return this.makeSearchEvent(l.facetUpdateSort,e)}logFacetUpdateSort(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(e){return this.makeCustomEvent(l.facetShowMore,e)}logFacetShowMore(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(e){return this.makeCustomEvent(l.facetShowLess,e)}logFacetShowLess(e){return f(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(e){return this.makeCustomEvent(l.queryError,e)}logQueryError(e){return f(this,void 0,void 0,function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return f(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(l.queryErrorBack);return{description:e.description,log:()=>f(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(l.queryErrorBack)})}})}logQueryErrorBack(){return f(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return f(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(l.queryErrorRetry);return{description:e.description,log:()=>f(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(l.queryErrorRetry)})}})}logQueryErrorRetry(){return f(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return f(this,void 0,void 0,function*(){let e=yield this.makeCustomEvent(l.queryErrorClear);return{description:e.description,log:()=>f(this,void 0,void 0,function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(l.queryErrorClear)})}})}logQueryErrorClear(){return f(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(l.likeSmartSnippet)}logLikeSmartSnippet(){return f(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(l.dislikeSmartSnippet)}logDislikeSmartSnippet(){return f(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(l.expandSmartSnippet)}logExpandSmartSnippet(){return f(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(l.collapseSmartSnippet)}logCollapseSmartSnippet(){return f(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(l.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return f(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(l.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return f(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(e,r){return this.makeCustomEvent(l.sendSmartSnippetReason,{reason:e,details:r})}logSmartSnippetFeedbackReason(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(l.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return f(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(l.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return f(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(l.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return f(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(l.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return f(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(e,r){return this.makeClickEvent(l.openSmartSnippetSource,e,r)}logOpenSmartSnippetSource(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(e,r){return this.makeClickEvent(l.openSmartSnippetSuggestionSource,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}makeCopyToClipboard(e,r){return this.makeClickEvent(l.copyToClipboard,e,r)}logCopyToClipboard(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(e,r)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(e,r){return this.makeClickEvent(l.openSmartSnippetInlineLink,e,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},r)}logOpenSmartSnippetInlineLink(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(e,r){return this.makeClickEvent(l.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logOpenSmartSnippetSuggestionInlineLink(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(l.recentQueryClick)}logRecentQueryClick(){return f(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(l.clearRecentQueries)}logClearRecentQueries(){return f(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(e,r){return this.makeCustomEvent(l.recentResultClick,{info:e,identifier:r})}logRecentResultClick(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(l.clearRecentResults)}logClearRecentResults(){return f(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(l.noResultsBack)}logNoResultsBack(){return f(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(e,r){return this.makeClickEvent(l.showMoreFoldedResults,e,r)}logShowMoreFoldedResults(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(l.showLessFoldedResults)}logShowLessFoldedResults(){return f(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(e,r){var n;return{actionCause:r,customData:(n=e.payload)===null||n===void 0?void 0:n.customData}}makeCustomEvent(e,r,n=$n[e]){return f(this,void 0,void 0,function*(){this.coveoAnalyticsClient.getParameters;let o=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(o)),{eventType:n,eventValue:e}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:c})=>a.log({lastSearchQueryUid:c})}})}logCustomEvent(e,r,n=$n[e]){return f(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(e,r,n)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(e,r,n){return f(this,void 0,void 0,function*(){let o=Object.assign(Object.assign({},this.provider.getBaseMetadata()),n),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(o)),{eventType:r,eventValue:e}),a=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:c})=>a.log({lastSearchQueryUid:c})}})}logCustomEventWithType(e,r,n){return f(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(e,r,n)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(e,r){return f(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(e,r)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(e,r){return f(this,void 0,void 0,function*(){let n=yield this.getBaseSearchEventRequest(e,r),o=yield this.coveoAnalyticsClient.makeSearchEvent(n);return{description:this.makeEventDescription(o,e),log:({searchUID:i})=>o.log({searchQueryUid:i})}})}makeClickEvent(e,r,n,o){return f(this,void 0,void 0,function*(){let i=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},n),o))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),a=yield this.coveoAnalyticsClient.makeClickEvent(i);return{description:this.makeEventDescription(a,e),log:({searchUID:c})=>a.log({searchQueryUid:c})}})}logClickEvent(e,r,n,o){return f(this,void 0,void 0,function*(){return(yield this.makeClickEvent(e,r,n,o)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,r){var n,o;return f(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(o=(n=this.provider).getGeneratedAnswerMetadata)===null||o===void 0?void 0:o.call(n)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return f(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,r;return{originContext:(r=(e=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof oe?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",r=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),r&&{splitTestRunVersion:r})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(l.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return f(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(l.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return f(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(l.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return f(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(l.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return f(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(l.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return f(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(l.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return f(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(l.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return f(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(l.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return f(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(l.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return f(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(l.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return f(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(l.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return f(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})})}},Sr=Object.assign({},$t),aa=Object.keys(Sr).map(t=>Sr[t]),zt=class extends $i{constructor({client:e,uuidGenerator:r=Je}){super({client:e,uuidGenerator:r});this.ticket={}}getApi(e){let r=super.getApi(e);if(r!==null)return r;switch(e){case"setTicket":return this.setTicket;default:return null}}addHooks(){this.addHooksForEvent(),this.addHooksForPageView(),this.addHooksForSVCEvents()}setTicket(e){this.ticket=e}clearPluginData(){this.ticket={}}addHooksForSVCEvents(){this.client.registerBeforeSendEventHook((e,...[r])=>aa.indexOf(e)!==-1?this.addSVCDataToPayload(e,r):r),this.client.registerAfterSendEventHook((e,...[r])=>(aa.indexOf(e)!==-1&&this.updateLocationInformation(e,r),r))}addHooksForPageView(){this.client.addEventTypeMapping(Sr.pageview,{newEventType:T.collect,variableLengthArgumentsNames:["page"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addHooksForEvent(){this.client.addEventTypeMapping(Sr.event,{newEventType:T.collect,variableLengthArgumentsNames:["eventCategory","eventAction","eventLabel","eventValue"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addSVCDataToPayload(e,r){var n;let o=Object.assign(Object.assign(Object.assign(Object.assign({},this.getLocationInformation(e,r)),this.getDefaultContextInformation(e)),this.action?{svcAction:this.action}:{}),Object.keys((n=this.actionData)!==null&&n!==void 0?n:{}).length>0?{svcActionData:this.actionData}:{}),i=this.getTicketPayload();return this.clearData(),Object.assign(Object.assign(Object.assign({},i),o),r)}getTicketPayload(){return Ju(this.ticket)}};zt.Id="svc";var br;(function(t){t.click="click",t.flowStart="flowStart"})(br||(br={}));var fe;(function(t){t.enterInterface="ticket_create_start",t.fieldUpdate="ticket_field_update",t.fieldSuggestionClick="ticket_classification_click",t.suggestionClick="suggestion_click",t.suggestionRate="suggestion_rate",t.nextCaseStep="ticket_next_stage",t.caseCancelled="ticket_cancel",t.caseSolved="ticket_cancel",t.caseCreated="ticket_create"})(fe||(fe={}));var Cr;(function(t){t.quit="Quit",t.solved="Solved"})(Cr||(Cr={}));var Hn=class{constructor(e,r){var n;this.options=e,this.provider=r;let o=((n=e.enableAnalytics)!==null&&n!==void 0?n:!0)&&!Ht();this.coveoAnalyticsClient=o?new oe(e):new Xe,this.svc=new zt({client:this.coveoAnalyticsClient})}disable(){this.coveoAnalyticsClient instanceof oe&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Xe,this.svc=new zt({client:this.coveoAnalyticsClient})}enable(){this.coveoAnalyticsClient=new oe(this.options),this.svc=new zt({client:this.coveoAnalyticsClient})}logEnterInterface(e){return this.svc.setAction(fe.enterInterface),this.svc.setTicket(e.ticket),this.sendFlowStartEvent()}logUpdateCaseField(e){return this.svc.setAction(fe.fieldUpdate,{fieldName:e.fieldName}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logSelectFieldSuggestion(e){return this.svc.setAction(fe.fieldSuggestionClick,e.suggestion),this.svc.setTicket(e.ticket),this.sendClickEvent()}logSelectDocumentSuggestion(e){return this.svc.setAction(fe.suggestionClick,e.suggestion),this.svc.setTicket(e.ticket),this.sendClickEvent()}logRateDocumentSuggestion(e){return this.svc.setAction(fe.suggestionRate,Object.assign({rate:e.rating},e.suggestion)),this.svc.setTicket(e.ticket),this.sendClickEvent()}logMoveToNextCaseStep(e){return this.svc.setAction(fe.nextCaseStep,{stage:e==null?void 0:e.stage}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseCancelled(e){return this.svc.setAction(fe.caseCancelled,{reason:Cr.quit}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseSolved(e){return this.svc.setAction(fe.caseSolved,{reason:Cr.solved}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseCreated(e){return this.svc.setAction(fe.caseCreated),this.svc.setTicket(e.ticket),this.sendClickEvent()}sendFlowStartEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",br.flowStart,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}sendClickEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",br.click,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}},Qd=t=>{let e={};return t.caseContext&&Object.keys(t.caseContext).forEach(r=>{var n;let o=(n=t.caseContext)===null||n===void 0?void 0:n[r];if(o){let i=`context_${r}`;e[i]=o}}),e},x=(t,e=!0)=>{let{caseContext:r,caseId:n,caseNumber:o}=t,i=ve(t,["caseContext","caseId","caseNumber"]),a=Qd(t);return Object.assign(Object.assign(Object.assign({CaseId:n,CaseNumber:o},i),!!a.context_Case_Subject&&{CaseSubject:a.context_Case_Subject}),e&&a)},zn=class{constructor(e,r){this.opts=e,this.provider=r;let n=e.enableAnalytics===!1||Ht();this.coveoAnalyticsClient=n?new Xe:new oe(e)}disable(){this.coveoAnalyticsClient instanceof oe&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Xe}enable(){this.coveoAnalyticsClient=new oe(this.opts)}logInterfaceLoad(e){if(e){let r=x(e);return this.logSearchEvent(l.interfaceLoad,r)}return this.logSearchEvent(l.interfaceLoad)}logInterfaceChange(e){let r=x(e);return this.logSearchEvent(l.interfaceChange,r)}logStaticFilterDeselect(e){let r=x(e);return this.logSearchEvent(l.staticFilterDeselect,r)}logFetchMoreResults(e){if(e){let r=x(e);return this.logCustomEvent(l.pagerScrolling,Object.assign(Object.assign({},r),{type:"getMoreResults"}))}return this.logCustomEvent(l.pagerScrolling,{type:"getMoreResults"})}logBreadcrumbFacet(e){let r=x(e);return this.logSearchEvent(l.breadcrumbFacet,r)}logBreadcrumbResetAll(e){if(e){let r=x(e);return this.logSearchEvent(l.breadcrumbResetAll,r)}return this.logSearchEvent(l.breadcrumbResetAll)}logFacetSelect(e){let r=x(e);return this.logSearchEvent(l.facetSelect,r)}logFacetExclude(e){let r=x(e);return this.logSearchEvent(l.facetExclude,r)}logFacetDeselect(e){let r=x(e);return this.logSearchEvent(l.facetDeselect,r)}logFacetUpdateSort(e){let r=x(e);return this.logSearchEvent(l.facetUpdateSort,r)}logFacetClearAll(e){let r=x(e);return this.logSearchEvent(l.facetClearAll,r)}logFacetShowMore(e){let r=x(e,!1);return this.logCustomEvent(l.facetShowMore,r)}logFacetShowLess(e){let r=x(e,!1);return this.logCustomEvent(l.facetShowLess,r)}logQueryError(e){let r=x(e,!1);return this.logCustomEvent(l.queryError,r)}logPagerNumber(e){let r=x(e,!1);return this.logCustomEvent(l.pagerNumber,r)}logPagerNext(e){let r=x(e,!1);return this.logCustomEvent(l.pagerNext,r)}logPagerPrevious(e){let r=x(e,!1);return this.logCustomEvent(l.pagerPrevious,r)}logDidYouMeanAutomatic(e){if(e){let r=x(e);return this.logSearchEvent(l.didyoumeanAutomatic,r)}return this.logSearchEvent(l.didyoumeanAutomatic)}logDidYouMeanClick(e){if(e){let r=x(e);return this.logSearchEvent(l.didyoumeanClick,r)}return this.logSearchEvent(l.didyoumeanClick)}logResultsSort(e){let r=x(e);return this.logSearchEvent(l.resultsSort,r)}logSearchboxSubmit(e){if(e){let r=x(e);return this.logSearchEvent(l.searchboxSubmit,r)}return this.logSearchEvent(l.searchboxSubmit)}logContextChanged(e){let r=x(e);return this.logSearchEvent(Z.contextChanged,r)}logExpandToFullUI(e){let r=x(e);return this.logCustomEvent(Z.expandToFullUI,r)}logOpenUserActions(e){let r=x(e,!1);return this.logCustomEvent(Z.openUserActions,r)}logShowPrecedingSessions(e){let r=x(e,!1);return this.logCustomEvent(Z.showPrecedingSessions,r)}logShowFollowingSessions(e){let r=x(e,!1);return this.logCustomEvent(Z.showFollowingSessions,r)}logViewedDocumentClick(e,r){return this.logCustomEvent(Z.clickViewedDocument,Object.assign(Object.assign({},x(r,!1)),{document:e}))}logPageViewClick(e,r){return this.logCustomEvent(Z.clickPageView,Object.assign(Object.assign({},x(r,!1)),{pageView:e}))}logCreateArticle(e,r){return this.logCustomEvent(Z.createArticle,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logDocumentOpen(e,r,n){return this.logClickEvent(l.documentOpen,e,r,n?x(n,!1):void 0)}logCopyToClipboard(e,r,n){return this.logClickEvent(l.copyToClipboard,e,r,n?x(n,!1):void 0)}logCaseSendEmail(e,r,n){return this.logClickEvent(l.caseSendEmail,e,r,n?x(n,!1):void 0)}logFeedItemTextPost(e,r,n){return this.logClickEvent(l.feedItemTextPost,e,r,n?x(n,!1):void 0)}logDocumentQuickview(e,r,n){let o={documentTitle:e.documentTitle,documentURL:e.documentUrl};return this.logClickEvent(l.documentQuickview,e,r,n?Object.assign(Object.assign({},x(n,!1)),o):o)}logCaseAttach(e,r,n){let o={documentTitle:e.documentTitle,documentURL:e.documentUrl,resultUriHash:e.documentUriHash};return this.logClickEvent(l.caseAttach,e,r,n?Object.assign(Object.assign({},x(n,!1)),o):o)}logCaseDetach(e,r){return this.logCustomEvent(l.caseDetach,r?Object.assign(Object.assign({},x(r,!1)),{resultUriHash:e}):{resultUriHash:e})}logLikeSmartSnippet(e){return this.logCustomEvent(l.likeSmartSnippet,e?x(e,!1):void 0)}logDislikeSmartSnippet(e){return this.logCustomEvent(l.dislikeSmartSnippet,e?x(e,!1):void 0)}logExpandSmartSnippet(e){return this.logCustomEvent(l.expandSmartSnippet,e?x(e,!1):void 0)}logCollapseSmartSnippet(e){return this.logCustomEvent(l.collapseSmartSnippet,e?x(e,!1):void 0)}logOpenSmartSnippetFeedbackModal(e){return this.logCustomEvent(l.openSmartSnippetFeedbackModal,e?x(e,!1):void 0)}logCloseSmartSnippetFeedbackModal(e){return this.logCustomEvent(l.closeSmartSnippetFeedbackModal,e?x(e,!1):void 0)}logSmartSnippetFeedbackReason(e,r,n){return this.logCustomEvent(l.sendSmartSnippetReason,n?Object.assign(Object.assign({},x(n,!1)),{reason:e,details:r}):{reason:e,details:r})}logExpandSmartSnippetSuggestion(e,r){let n="documentId"in e?e:{documentId:e};return this.logCustomEvent(l.expandSmartSnippetSuggestion,r?Object.assign(Object.assign({},x(r,!1)),n):n)}logCollapseSmartSnippetSuggestion(e,r){let n="documentId"in e?e:{documentId:e};return this.logCustomEvent(l.collapseSmartSnippetSuggestion,r?Object.assign(Object.assign({},x(r,!1)),n):n)}logOpenSmartSnippetSource(e,r,n){return this.logClickEvent(l.openSmartSnippetSource,e,r,n?x(n,!1):void 0)}logOpenSmartSnippetSuggestionSource(e,r,n){return this.logClickEvent(l.openSmartSnippetSuggestionSource,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},n?Object.assign(Object.assign({},x(n,!1)),r):r)}logOpenSmartSnippetInlineLink(e,r,n){return this.logClickEvent(l.openSmartSnippetInlineLink,e,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},n?Object.assign(Object.assign({},x(n,!1)),r):r)}logOpenSmartSnippetSuggestionInlineLink(e,r,n){return this.logClickEvent(l.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},n?Object.assign(Object.assign({},x(n,!1)),r):r)}logLikeGeneratedAnswer(e,r){return this.logCustomEvent(l.likeGeneratedAnswer,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logDislikeGeneratedAnswer(e,r){return this.logCustomEvent(l.dislikeGeneratedAnswer,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logOpenGeneratedAnswerSource(e,r){return this.logCustomEvent(l.openGeneratedAnswerSource,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logGeneratedAnswerSourceHover(e,r){return this.logCustomEvent(l.generatedAnswerSourceHover,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logGeneratedAnswerCopyToClipboard(e,r){return this.logCustomEvent(l.generatedAnswerCopyToClipboard,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logGeneratedAnswerHideAnswers(e,r){return this.logCustomEvent(l.generatedAnswerHideAnswers,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logGeneratedAnswerShowAnswers(e,r){return this.logCustomEvent(l.generatedAnswerShowAnswers,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logGeneratedAnswerFeedbackSubmit(e,r){return this.logCustomEvent(l.generatedAnswerFeedbackSubmit,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logRephraseGeneratedAnswer(e,r){return this.logSearchEvent(l.rephraseGeneratedAnswer,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logRetryGeneratedAnswer(e){return this.logSearchEvent(l.retryGeneratedAnswer,e?Object.assign({},x(e,!1)):{})}logGeneratedAnswerStreamEnd(e,r){return this.logCustomEvent(l.generatedAnswerStreamEnd,r?Object.assign(Object.assign({},x(r,!1)),e):e)}logCustomEvent(e,r){return f(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),o=Object.assign(Object.assign({},yield this.getBaseCustomEventRequest(n)),{eventType:$n[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(o)})}logSearchEvent(e,r){return f(this,void 0,void 0,function*(){return this.coveoAnalyticsClient.sendSearchEvent(yield this.getBaseSearchEventRequest(e,r))})}logClickEvent(e,r,n,o){return f(this,void 0,void 0,function*(){let i=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},n),o))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(i)})}logShowMoreFoldedResults(e,r,n){return f(this,void 0,void 0,function*(){return this.logClickEvent(l.showMoreFoldedResults,e,r,n?x(n,!1):void 0)})}logShowLessFoldedResults(e){return f(this,void 0,void 0,function*(){return this.logCustomEvent(l.showLessFoldedResults,e?x(e,!1):void 0)})}getBaseCustomEventRequest(e){return f(this,void 0,void 0,function*(){return Object.assign(Object.assign({},yield this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})})}getBaseSearchEventRequest(e,r){var n,o;return f(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(o=(n=this.provider).getGeneratedAnswerMetadata)===null||o===void 0?void 0:o.call(n)))),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})})}getBaseEventRequest(e){return f(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var e,r;return{originContext:(r=(e=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof oe?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}};var sa=t=>new oe(t).getCurrentVisitorId(),Qn=t=>{let e=new oe(t);e.clear(),e.deleteHttpOnlyVisitorId()},Wn=new ji.HistoryStore,be=(t,e)=>typeof e=="function"?(...r)=>{let n=jt(r[0]);try{return e.apply(e,r)}catch(o){return t.error(o,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Ce=(t,e)=>(...r)=>{let n=jt(r[1]);try{return e.apply(e,r)}catch(o){return t.error(o,"Error in analytics hook. Returning original request."),n}};var ca=["uri","urihash","documentUri","documentUriHash","permanentid","ec_name","ec_brand","ec_category","ec_item_group_id","ec_price","ec_promo_price","ec_shortdesc","ec_thumbnails","ec_images","ec_in_stock","ec_rating","childResults","totalNumberOfChildResults"];var Rr=()=>({id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0});var Ct=()=>"default";var xr="2.42.0";var Wd=t=>{let e=t.configuration.search.locale.split("-")[0];return!e||e.length!==2?"en":e},ge=class{constructor(e){this.getState=e;this.state=e()}getLanguage(){return Wd(this.state)}getBaseMetadata(){let{context:e}=this.state,r=(e==null?void 0:e.contextValues)||{},n={};for(let[o,i]of Object.entries(r)){let a=`context_${o}`;n[a]=i}return n.coveoHeadlessVersion=xr,n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||Ct()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};var Ar=class extends ge{constructor(){super(...arguments);this.initialState=Rr()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var r;return((r=this.getState().productRecommendations)==null?void 0:r.searchUid)||this.initialState.searchUid}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productRecommendations)==null?void 0:e.recommendations.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get responseTime(){var e;return((e=this.state.productRecommendations)==null?void 0:e.duration)||this.initialState.duration}get numberOfResults(){var e;return((e=this.state.productRecommendations)==null?void 0:e.recommendations.length)||this.initialState.recommendations.length}};var wr=class{constructor(e){this.state=e()}getSearchUID(){return null}getOriginLevel1(){return this.state.searchHub||Ct()}},ua=({logger:t,getState:e,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new wr(e)})=>{let i=e(),a=i.configuration.accessToken,c=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,s=i.configuration.analytics.enabled,d=new Hn({enableAnalytics:s,token:a,endpoint:c,runtimeEnvironment:u,preprocessRequest:be(t,n),beforeSendHooks:[Ce(t,r),(p,g)=>(t.info({...g,type:p,endpoint:c,token:a},"Analytics request"),g)]},o);return s||d.disable(),d};var Pr=()=>({url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""});var Er=class extends ge{constructor(){super(...arguments);this.initialState=Pr()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var r;return((r=this.getState().productListing)==null?void 0:r.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},da=({logger:t,getState:e,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new Er(e)})=>{let i=e(),a=i.configuration.accessToken,c=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,s=i.configuration.analytics.enabled,d=new Ze({token:a,endpoint:c,runtimeEnvironment:u,preprocessRequest:be(t,n),beforeSendHooks:[Ce(t,r),(p,g)=>(t.info({...g,type:p,endpoint:c,token:a},"Analytics request"),g)]},o);return s||d.disable(),d};var la=5;var ma=8;function pa(){return{desiredCount:la,numberOfValues:ma,set:{}}}function fa(t){let{activeValue:e,ancestryMap:r}=Kd(t);return e?Gd(e,r):[]}function Kd(t){let e=[...t],r=new Map;for(;e.length>0;){let n=e.shift();if(n.state==="selected")return{activeValue:n,ancestryMap:r};if(r)for(let o of n.children)r.set(o,n);e.unshift(...n.children)}return{}}function Gd(t,e){let r=[];if(!t)return[];let n=t;do r.unshift(n),n=e.get(n);while(n);return r}var Yd=(t,e)=>{var r;return(r=t.categoryFacetSet[e])==null?void 0:r.request};var Kn=(t,e)=>{var n;let r=Yd(t,e);return fa((n=r==null?void 0:r.currentValues)!=null?n:[])};function ga(){return{}}function ha(){return{}}function ya(){return{}}function va(){return{}}function kr(t){var e,r,n,o,i;return{facetSet:(e=t.facetSet)!=null?e:va(),categoryFacetSet:(r=t.categoryFacetSet)!=null?r:ga(),dateFacetSet:(n=t.dateFacetSet)!=null?n:ha(),numericFacetSet:(o=t.numericFacetSet)!=null?o:ya(),automaticFacetSet:(i=t.automaticFacetSet)!=null?i:pa()}}var Or=t=>{let e=[];return Zd(t).forEach((r,n)=>{let o=sl(t,r.facetId),i=il(r,n+1);if(Xd(r)){if(!!!Kn(t,r.facetId).length)return;e.push({...i,...nl(t,r.facetId),facetType:o,state:"selected"});return}r.currentValues.forEach((a,c)=>{if(a.state==="idle")return;let u=Sa(a,c+1,o),s=Jd(r)?ba(a):tl(a);e.push({...i,...u,...s})})}),el(t).forEach((r,n)=>{let o=ol(r,n+1);r.values.forEach((i,a)=>{if(i.state==="idle")return;let c=Sa(i,a+1,"specific"),u=ba(i);e.push({...o,...c,...u})})}),e},Jd=t=>t.type==="specific",Xd=t=>t.type==="hierarchical",Zd=t=>[...Object.values(t.facetSet),...Object.values(t.categoryFacetSet),...Object.values(t.dateFacetSet),...Object.values(t.numericFacetSet)].map(e=>e.request),el=t=>[...Object.values(t.automaticFacetSet.set)].map(e=>e.response),Sa=(t,e,r)=>({state:t.state,valuePosition:e,facetType:r}),tl=t=>({displayValue:`${t.start}..${t.end}`,value:`${t.start}..${t.end}`,start:t.start,end:t.end,endInclusive:t.endInclusive}),ba=t=>({displayValue:t.value,value:t.value}),rl=(t,e)=>Kn(t,e).map(n=>n.value).join(";"),nl=(t,e)=>{let r=1,n=rl(t,e);return{value:n,valuePosition:r,displayValue:n}},ol=(t,e)=>({title:Ca(t.field,t.field),field:t.field,id:t.field,facetPosition:e}),il=(t,e)=>({title:Ca(t.field,t.facetId),field:t.field,id:t.facetId,facetPosition:e}),Ca=(t,e)=>`${t}_${e}`,al=(t,e)=>{var r,n,o,i,a;return((r=t.facetSet[e])==null?void 0:r.request)||((n=t.categoryFacetSet[e])==null?void 0:n.request)||((o=t.dateFacetSet[e])==null?void 0:o.request)||((i=t.numericFacetSet[e])==null?void 0:i.request)||((a=t.automaticFacetSet.set[e])==null?void 0:a.response)},sl=(t,e)=>{let r=al(t,e);return r?r.type:"specific"};var Ir=()=>({q:"",enableQuerySyntax:!1});var Fr=class extends ge{getSearchUID(){var r,n;let e=this.getState();return((r=e.search)==null?void 0:r.searchResponseId)||((n=e.search)==null?void 0:n.response.searchUid)||Te().response.searchUid}getPipeline(){var e;return this.state.pipeline||((e=this.state.search)==null?void 0:e.response.pipeline)||"default"}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getFacetState(){return Or(kr(this.state))}get queryText(){var e;return((e=this.state.query)==null?void 0:e.q)||Ir().q}get responseTime(){var e;return((e=this.state.search)==null?void 0:e.duration)||Te().duration}mapResultsToAnalyticsDocument(){var e;return(e=this.state.search)==null?void 0:e.response.results.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get numberOfResults(){var e;return((e=this.state.search)==null?void 0:e.response.results.length)||Te().response.results.length}},Ra=({logger:t,getState:e,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new Fr(e)})=>{let i=e(),a=i.configuration.accessToken,c=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,s=i.configuration.analytics.enabled,d=new zn({enableAnalytics:s,token:a,endpoint:c,runtimeEnvironment:u,preprocessRequest:be(t,n),beforeSendHooks:[Ce(t,r),(p,g)=>(t.info({...g,type:p,endpoint:c,token:a},"Analytics request"),g)]},o);return s||d.disable(),d};var Tr=class extends ge{constructor(){super(...arguments);this.initialState=Pr()}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var r;return((r=this.getState().productListing)==null?void 0:r.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return(e=this.state.productListing)==null?void 0:e.products.map(r=>({documentUri:r.documentUri,documentUriHash:r.documentUriHash,permanentid:r.permanentid}))}get numberOfResults(){return this.state.productListing.products.length}},xa=({logger:t,getState:e,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new Tr(e)})=>{let i=e(),a=i.configuration.accessToken,c=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,s=i.configuration.analytics.enabled,d=new Ze({token:a,endpoint:c,runtimeEnvironment:u,preprocessRequest:be(t,n),beforeSendHooks:[Ce(t,r),(p,g)=>(t.info({...g,type:p,endpoint:c,token:a},"Analytics request"),g)]},o);return s||d.disable(),d};async function cl({config:t,environment:e,event:r,listenerManager:n}){let{url:o,token:i,mode:a}=t;a!=="disabled"&&(n.call(r),e.send(o,i,r))}var ul=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function dl(t){return typeof t=="string"&&ul.test(t)}function ll(t){let e="visitorId";return{getClientId:()=>{let r=t.get(),n=r.storage,o=n.getItem(e),i=o&&dl(o)?o:r.generateUUID();return n.setItem(e,i),i},clear:()=>{t.get().storage.removeItem(e)}}}var Aa="0.6.8";function ml(t){let{trackingId:e}=t;return{trackingId:e}}function pl(){return`relay@${Aa}`}function wa(t,e,r,n){let{getReferrer:o,getLocation:i,getUserAgent:a}=r,c=ml(e),u=n.getClientId();return Object.freeze({type:t,config:c,ts:Date.now(),source:pl(),clientId:u,userAgent:a(),referrer:o(),location:i()})}function fl(t,e,r,n,o){return{...e,meta:wa(t,r,n,o)}}var gl="*";function hl(){let t=[];function e({type:u,callback:s}){return t.findIndex(d=>d.type===u&&d.callback===s)}function r(u,s){return u.type==="*"||s===u.type}function n(u){return e(u)<0&&t.push(u),()=>c(u.type,u.callback)}function o(u){t.forEach(s=>{if(r(s,u.meta.type))try{s.callback(u)}catch(d){console.error(d)}})}function i(u){if(u===gl)t.length=0;else for(let s=t.length-1;s>=0;s--)t[s].type===u&&t.splice(s,1)}function a(u){let s=e(u);s>=0&&t.splice(s,1)}function c(u,s){s?a({type:u,callback:s}):i(u)}return{add:n,call:o,remove:c}}function Pa({url:t,token:e,trackingId:r,...n}){return Object.freeze({url:t,token:e,trackingId:r,...!!n.mode&&{mode:n.mode}})}function yl(t){let e=Pa(t);return{get:()=>e,update:r=>{e=Pa({...e,...r})}}}function vl(){let t=typeof window!="undefined";return{sendMessage(e){t&&window.postMessage(e,"*")}}}var Gn=Sl();function Sl(){let t="coveo_",e=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return{getItem(r){let n=`${t}${r}=`,o=document.cookie.split(";");for(let i of o){let a=i.replace(/^\s+/,"");if(a.lastIndexOf(n,0)===0)return a.substring(n.length,a.length)}return null},setItem(r,n,o){let i=e(window.location.hostname),a=`;expires=${new Date(new Date().getTime()+o).toUTCString()}`,c=i?`;domain=${i}`:"";document.cookie=`${t}${r}=${n}${a}${c};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function bl(){return{getItem(t){return Gn.getItem(t)||localStorage.getItem(t)},removeItem(t){Gn.removeItem(t),localStorage.removeItem(t)},setItem(t,e){let r=31556952e3;localStorage.setItem(t,e),Gn.setItem(t,e,r)}}}async function Yn(t,e){return fetch(t,e).catch(r=>{throw new Error(`${r.message}: The "host" value is invalid or a network error occured, according to the FetchAPI's response.`,{cause:r})})}function Cl(){let t=document.referrer;return t===""?null:t}function Rl(){return{runtime:"browser",fetch:(t,e)=>Yn(t,e),send:async(t,e,r)=>{let n=navigator.sendBeacon(`${t}?access_token=${e}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(vl().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:t,token:e}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>Cl(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:bl()}}function Ea(){return{getItem(){return null},removeItem(){},setItem(){}}}function xl(){return{runtime:"node",fetch:(t,e)=>Yn(t,e),send:async(t,e,r)=>{let n={"Content-Type":"application/json",Authorization:`Bearer ${e}`};Yn(t,{method:"POST",body:JSON.stringify([r]),headers:n})},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>crypto.randomUUID(),storage:Ea()}}function Al(){return wl()?Rl():xl()}function wl(){try{return typeof window=="object"}catch{return!1}}function Pl(){return{runtime:"null",fetch:()=>Promise.resolve(new Response(JSON.stringify(""))),send:async()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:Ea()}}function El(t){return t.get().mode=="disabled"?Pl():Al()}function kl(t){return{get:()=>Object.freeze(El(t))}}function ka(t){let e=yl(t),r=hl(),n=kl(e),o=ll(n);return{emit:(i,a)=>{let c=e.get(),u=n.get(),s=fl(i,a,c,u,o);return cl({config:c,environment:u,event:s,listenerManager:r})},getMeta:i=>wa(i,e.get(),n.get(),o),on:(i,a)=>r.add({type:i,callback:a}),off:(i,a)=>r.remove(i,a),updateConfig:i=>e.update(i),version:Aa,clearStorage:()=>{o.clear()}}}var Oa=(r=>(r.Ascending="ascending",r.Descending="descending",r))(Oa||{}),Ia=(i=>(i.Relevancy="relevancy",i.QRE="qre",i.Date="date",i.Field="field",i.NoSort="nosort",i))(Ia||{}),Jn=t=>{if(bo(t))return t.map(e=>Jn(e)).join(",");switch(t.by){case"relevancy":case"qre":case"nosort":return t.by;case"date":return`date ${t.order}`;case"field":return`@${t.field} ${t.order}`;default:return""}},Fa=()=>({by:"relevancy"});var lh=new $({values:{by:new Qr({enum:Ia,required:!0}),order:new Qr({enum:Oa}),field:new L}});function Ta(){return Jn(Fa())}var Dr=class extends ge{constructor(){super(...arguments);this.getFacetRequest=e=>{var r,n,o,i,a,c,u,s,d,p;return((n=(r=this.state.facetSet)==null?void 0:r[e])==null?void 0:n.request)||((i=(o=this.state.categoryFacetSet)==null?void 0:o[e])==null?void 0:i.request)||((c=(a=this.state.dateFacetSet)==null?void 0:a[e])==null?void 0:c.request)||((s=(u=this.state.numericFacetSet)==null?void 0:u[e])==null?void 0:s.request)||((p=(d=this.state.automaticFacetSet)==null?void 0:d.set[e])==null?void 0:p.response)}}getFacetState(){return Or(kr(this.getState()))}getPipeline(){var e;return this.state.pipeline||((e=this.state.search)==null?void 0:e.response.pipeline)||Dr.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var r,n;let e=this.getState();return((r=e.search)==null?void 0:r.searchResponseId)||((n=e.search)==null?void 0:n.response.searchUid)||Te().response.searchUid}getSplitTestRunName(){var e;return(e=this.state.search)==null?void 0:e.response.splitTestRun}getSplitTestRunVersion(){var n;let e=!!this.getSplitTestRunName(),r=((n=this.state.search)==null?void 0:n.response.pipeline)||this.state.pipeline||Dr.fallbackPipelineName;return e?r:void 0}getBaseMetadata(){var o,i,a;let e=this.getState(),r=super.getBaseMetadata(),n=(a=(i=(o=e.search)==null?void 0:o.response)==null?void 0:i.extendedResults)==null?void 0:a.generativeQuestionAnsweringId;return n&&(r.generativeQuestionAnsweringId=n),r}getFacetMetadata(e,r){var i;let n=this.getFacetRequest(e),o=(i=n==null?void 0:n.field)!=null?i:"";return{...this.getBaseMetadata(),facetId:e,facetField:o,facetValue:r,facetTitle:`${o}_${e}`}}getFacetClearAllMetadata(e){var o;let r=this.getFacetRequest(e),n=(o=r==null?void 0:r.field)!=null?o:"";return{...this.getBaseMetadata(),facetId:e,facetField:n,facetTitle:`${n}_${e}`}}getFacetSortMetadata(e,r){var i;let n=this.getFacetRequest(e),o=(i=n==null?void 0:n.field)!=null?i:"";return{...this.getBaseMetadata(),facetId:e,facetField:o,criteria:r,facetTitle:`${o}_${e}`}}getRangeFacetBreadcrumbMetadata(e,r){var i;let n=this.getFacetRequest(e),o=(i=n==null?void 0:n.field)!=null?i:"";return{...this.getBaseMetadata(),facetId:e,facetField:o,facetRangeEnd:r.end,facetRangeEndInclusive:r.endInclusive,facetRangeStart:r.start,facetTitle:`${o}_${e}`}}getResultSortMetadata(){var e;return{...this.getBaseMetadata(),resultsSortBy:(e=this.state.sortCriteria)!=null?e:Ta()}}getStaticFilterToggleMetadata(e,r){return{...this.getBaseMetadata(),staticFilterId:e,staticFilterValue:r}}getStaticFilterClearAllMetadata(e){return{...this.getBaseMetadata(),staticFilterId:e}}getUndoTriggerQueryMetadata(e){return{...this.getBaseMetadata(),undoneQuery:e}}getCategoryFacetBreadcrumbMetadata(e,r){var i;let n=this.getFacetRequest(e),o=(i=n==null?void 0:n.field)!=null?i:"";return{...this.getBaseMetadata(),categoryFacetId:e,categoryFacetField:o,categoryFacetPath:r,categoryFacetTitle:`${o}_${e}`}}getOmniboxAnalyticsMetadata(e,r){let n=this.state.querySuggest&&this.state.querySuggest[e],o=n.completions.map(u=>u.expression),i=n.partialQueries.length-1,a=n.partialQueries[i]||"",c=n.responseId;return{...this.getBaseMetadata(),suggestionRanking:o.indexOf(r),partialQuery:a,partialQueries:n.partialQueries.length>0?n.partialQueries:"",suggestions:o.length>0?o:"",querySuggestResponseId:c}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(e){return{...this.getBaseMetadata(),...e}}getGeneratedAnswerMetadata(){var n;let e=this.getState(),r={};return((n=e.generatedAnswer)==null?void 0:n.isVisible)!==void 0&&(r.showGeneratedAnswer=e.generatedAnswer.isVisible),r}get resultURIs(){var e;return(e=this.results)==null?void 0:e.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){var e;return(e=this.state.search)==null?void 0:e.response.results}get queryText(){var e;return((e=this.state.query)==null?void 0:e.q)||Ir().q}get responseTime(){var e;return((e=this.state.search)==null?void 0:e.duration)||Te().duration}get numberOfResults(){var e;return((e=this.state.search)==null?void 0:e.response.totalCountFiltered)||Te().response.totalCountFiltered}},Qt=Dr;Qt.fallbackPipelineName="default";var Da=t=>{let e=t.configuration.accessToken,r=t.configuration.analytics.trackingId,{emit:n}=ka({url:t.configuration.analytics.nextApiBaseUrl,token:e,trackingId:r});return n},La=({logger:t,getState:e,analyticsClientMiddleware:r=(i,a)=>a,preprocessRequest:n,provider:o=new Qt(e)})=>{let i=e(),a=i.configuration.accessToken,c=i.configuration.analytics.apiBaseUrl,u=i.configuration.analytics.runtimeEnvironment,s=i.configuration.analytics.enabled,d=new Ze({token:a,endpoint:c,runtimeEnvironment:u,preprocessRequest:be(t,n),beforeSendHooks:[Ce(t,r),(p,g)=>(t.info({...g,type:p,endpoint:c,token:a},"Analytics request"),g)]},o);return s||d.disable(),d};function Ol(t){return Object.assign(t,{instantlyCallable:!0})}function Il(t,e){let r=i=>Ol(Me(t,i)),n=r(async(i,{getState:a,extra:c})=>{let{analyticsClientMiddleware:u,preprocessRequest:s,logger:d}=c;return await(await e({getState:a,analyticsClientMiddleware:u,preprocessRequest:s,logger:d})).log({state:a(),extra:c})});return Object.assign(n,{prepare:async({getState:i,analyticsClientMiddleware:a,preprocessRequest:c,logger:u})=>{let{description:s,log:d}=await e({getState:i,analyticsClientMiddleware:a,preprocessRequest:c,logger:u});return{description:s,action:r(async(p,{getState:g,extra:m})=>await d({state:g(),extra:m}))}}}),n}var Wt=(t,e,r)=>{function n(...o){let i=o.length===1?{...o[0],__legacy__getBuilder:e(o[0].__legacy__getBuilder),analyticsConfigurator:t,providerClass:r}:{prefix:o[0],__legacy__getBuilder:e(o[1]),__legacy__provider:o[2],analyticsConfigurator:t,providerClass:r};return Dl(i)}return n},Fl=t=>t.configuration.analytics.analyticsMode==="legacy",Tl=t=>t.configuration.analytics.analyticsMode==="next",Dl=({prefix:t,__legacy__getBuilder:e,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:o,analyticsConfigurator:i,providerClass:a})=>(r!=null||(r=c=>new a(c)),Il(t,async({getState:c,analyticsClientMiddleware:u,preprocessRequest:s,logger:d})=>{let p=[],g={log:async({state:b})=>{for(let w of p)await w(b)}},m=c(),h=i({getState:c,logger:d,analyticsClientMiddleware:u,preprocessRequest:s,provider:r(c)}),y=await e(h,c());g.description=y==null?void 0:y.description,p.push(async b=>{Fl(b)&&await Ll(y,r,b,d,h.coveoAnalyticsClient)});let R=Da(m);return p.push(async b=>{if(Tl(b)&&o&&n){let w=n(b);await Ml(R,o,w)}}),g}));async function Ll(t,e,r,n,o){e(()=>r);let i=await(t==null?void 0:t.log({searchUID:e(()=>r).getSearchUID()}));n.info({client:o,response:i},"Analytics response")}var Na=t=>(e,r)=>Promise.resolve({description:{actionCause:"caseAssist"},log:async n=>{t(e,r)}}),Xn=Wt(La,t=>t,Qt),Gh=Wt(ua,Na,wr),Yh=Wt(Ra,Na,Fr),Jh=Wt(da,t=>t,Er),Xh=Wt(xa,t=>t,Tr);var Nl={urihash:new L,sourcetype:new L,permanentid:new L},Zn={uniqueId:H,raw:new $({values:Nl}),title:H,uri:H,clickUri:H,rankingModifier:new L({required:!1,emptyAllowed:!0})};async function Ml(t,e,r){await t(e,r)}var Ma=()=>Xn("analytics/productRecommendations/load",t=>t.makeRecommendationInterfaceLoad(),t=>new Ar(t)),jl=(t,e)=>{var n;let r=((n=e.productRecommendations)==null?void 0:n.recommendations.findIndex(({permanentid:o})=>t.permanentid===o))||0;return ql(t,r)};function ql(t,e){return{collectionName:"",documentAuthor:"",documentPosition:e+1,documentTitle:t.ec_name||"",documentUri:t.documentUri,documentUriHash:t.documentUriHash,documentUrl:t.clickUri,rankingModifier:"",sourceName:"unknown",queryPipeline:""}}var Ul=t=>(t.permanentid||console.warn("Missing field permanentid on productRecommendation. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",t),{contentIDKey:"permanentid",contentIDValue:t.permanentid||""});function Vl(t){return{uniqueId:t.permanentid,title:t.ec_name||"",uri:t.documentUri,clickUri:t.clickUri}}function _l(t){let e=Vl(t);return Object.assign({},...Object.keys(Zn).map(r=>({[r]:e[r]})))}var Bl=t=>new j(Zn).validate(_l(t)),ja=t=>Xn("analytics/productRecommendation/open",(e,r)=>(Bl(t),e.makeRecommendationOpen(jl(t,r),Ul(t))),e=>new Ar(e));function $l(t){return t&&"childResults"in t&&"totalNumberOfChildResults"in t}var Rt=F("productrecommendations/setId",t=>N(t,{id:H})),et=F("productrecommendations/setSku",t=>N(t,{skus:new ue({required:!0,min:1,each:V})})),Lr=F("productrecommendations/setBrand",t=>N(t,{brand:new L({required:!0,emptyAllowed:!0})})),Nr=F("productrecommendations/setCategory",t=>N(t,{category:new L({required:!0,emptyAllowed:!0})})),xt=F("productrecommendations/setAdditionalFields",t=>N(t,{additionalFields:new ue({required:!0,each:V})})),At=F("productrecommendations/setMaxNumberOfRecommendations",t=>N(t,{number:new Qe({required:!0,max:50,min:1})})),Ue=Me("productRecommendations/get",async(t,{getState:e,rejectWithValue:r,extra:{apiClient:n}})=>{let o=e(),i=new Date().getTime(),a=await n.productRecommendations(await Hl(o)),c=new Date().getTime()-i;if(Xo(a))return r(a.error);let u=o.productRecommendations.additionalFields||[];return{recommendations:a.success.results.map(s=>qa(s,{additionalFields:u})),analyticsAction:Ma(),searchUid:a.success.searchUid,duration:c}}),qa=(t,{additionalFields:e})=>{let r=t.raw.ec_price,n=t.raw.ec_promo_price,o=t.raw.ec_in_stock,i={documentUri:t.uri,documentUriHash:t.raw.urihash,permanentid:t.raw.permanentid,clickUri:t.clickUri,ec_name:t.raw.ec_name,ec_brand:t.raw.ec_brand,ec_category:t.raw.ec_category,ec_item_group_id:t.raw.ec_item_group_id,ec_price:r,ec_shortdesc:t.raw.ec_shortdesc,ec_thumbnails:t.raw.ec_thumbnails,ec_images:t.raw.ec_images,ec_promo_price:n===void 0||r!==void 0&&n>=r?void 0:n,ec_in_stock:o===void 0?void 0:o.toLowerCase()==="yes"||o.toLowerCase()==="true",ec_rating:t.raw.ec_rating,additionalFields:e.reduce((a,c)=>({...a,[c]:t.raw[c]}),{}),childResults:[],totalNumberOfChildResults:0};return $l(t)&&(i.childResults=t.childResults.map(a=>qa(a,{additionalFields:e})),i.totalNumberOfChildResults=t.totalNumberOfChildResults),i},Hl=async t=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,...t.configuration.analytics.enabled&&{visitorId:await sa(t.configuration.analytics)},recommendation:t.productRecommendations.id,numberOfResults:t.productRecommendations.maxNumberOfRecommendations,fieldsToInclude:[...ca,...t.productRecommendations.additionalFields||[]],mlParameters:{...t.productRecommendations.skus&&t.productRecommendations.skus.length>0&&{itemIds:t.productRecommendations.skus},...t.productRecommendations.filter.brand&&{brandFilter:t.productRecommendations.filter.brand},...t.productRecommendations.filter.category&&{categoryFilter:t.productRecommendations.filter.category}},actionsHistory:t.configuration.analytics.enabled?Wn.getHistory():[],...t.context&&{context:t.context.contextValues},...t.dictionaryFieldContext&&{dictionaryFieldContext:t.dictionaryFieldContext.contextValues},...t.searchHub&&{searchHub:t.searchHub}});var wt=le(Rr(),t=>{t.addCase(Rt,(e,r)=>{e.id=r.payload.id}).addCase(et,(e,r)=>{e.skus=r.payload.skus}).addCase(Lr,(e,r)=>{e.filter.brand=r.payload.brand}).addCase(Nr,(e,r)=>{e.filter.category=r.payload.category}).addCase(At,(e,r)=>{e.maxNumberOfRecommendations=r.payload.number}).addCase(xt,(e,r)=>{e.additionalFields=r.payload.additionalFields}).addCase(Ue.rejected,(e,r)=>{e.error=r.payload?r.payload:null,e.isLoading=!1}).addCase(Ue.fulfilled,(e,r)=>{e.error=null,e.searchUid=r.payload.searchUid,e.recommendations=r.payload.recommendations,e.isLoading=!1}).addCase(Ue.pending,e=>{e.isLoading=!0})});var Pt=F("searchHub/set",t=>N(t,new L({required:!0,emptyAllowed:!0})));var zl=F("history/undo"),Ql=F("history/redo"),Ay=F("history/snapshot"),wy=Me("history/back",async(t,{dispatch:e})=>{e(zl()),await e(Ve())}),Py=Me("history/forward",async(t,{dispatch:e})=>{e(Ql()),await e(Ve())}),Ve=Me("history/change",async(t,{getState:e})=>e().history.present);var Mr=le(Ct(),t=>{t.addCase(Pt,(e,r)=>r.payload).addCase(Ve.fulfilled,(e,r)=>{var n,o;return(o=(n=r.payload)==null?void 0:n.searchHub)!=null?o:e}).addCase(ft,(e,r)=>r.payload.searchHub||e)});var Ua=le(xr,t=>t);var Va=t=>e=>r=>{var i,a;let n=(i=r.payload)==null?void 0:i.analyticsAction;n!==void 0&&((a=r.payload)==null||delete a.analyticsAction);let o=e(r);return r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r),n!==void 0&&t.dispatch(n),o};var Xa=Ie(Ba());var $a={q:new L,enableQuerySyntax:new Fe,aq:new L,cq:new L,firstResult:new Qe({min:0}),numberOfResults:new Qe({min:0}),sortCriteria:new L,f:new $,fExcluded:new $,cf:new $,nf:new $,df:new $,debug:new Fe,sf:new $,tab:new L,af:new $};var Ha=F("searchParameters/restore",t=>N(t,$a));var Gy=F("tab/register",t=>{let e=new $({values:{id:H,expression:Ye}});return N(t,e)}),za=F("tab/updateActiveTab",t=>N(t,H));var jr=Ie(Qa()),Ga=Ie(Wa()),Ya=Ie(Ka());jr.default.extend(Ya.default);jr.default.extend(Ga.default);var ao="/rest/search/v2",so="/rest/ua",Ja=()=>({organizationId:"",accessToken:"",platformUrl:tn(),search:{apiBaseUrl:`${tn()}${ao}`,locale:"en-US",timezone:jr.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${Ho()}${so}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy"}});function Kl(t,e){if(Ko(t))return t.replace(/^(https:\/\/)platform/,"$1analytics")+so;let n=Go(t,e);return n?nr(e,n.environment).analytics:t}var Za=le(Ja(),t=>t.addCase(je,(e,r)=>{r.payload.accessToken&&(e.accessToken=r.payload.accessToken),r.payload.organizationId&&(e.organizationId=r.payload.organizationId),r.payload.platformUrl&&(e.platformUrl=r.payload.platformUrl,e.search.apiBaseUrl=`${r.payload.platformUrl}${ao}`,e.analytics.apiBaseUrl=Kl(r.payload.platformUrl,e.organizationId))}).addCase(ft,(e,r)=>{r.payload.apiBaseUrl&&(e.search.apiBaseUrl=r.payload.apiBaseUrl),r.payload.locale&&(e.search.locale=r.payload.locale),r.payload.timezone&&(e.search.timezone=r.payload.timezone),r.payload.authenticationProviders&&(e.search.authenticationProviders=r.payload.authenticationProviders)}).addCase(gt,(e,r)=>{q(r.payload.enabled)||(!r.payload.enabled&&e.analytics.enabled&&Qn(e.analytics),e.analytics.enabled=r.payload.enabled),q(r.payload.originContext)||(e.analytics.originContext=r.payload.originContext),q(r.payload.originLevel2)||(e.analytics.originLevel2=r.payload.originLevel2),q(r.payload.originLevel3)||(e.analytics.originLevel3=r.payload.originLevel3),q(r.payload.apiBaseUrl)||(e.analytics.apiBaseUrl=r.payload.apiBaseUrl),q(r.payload.nextApiBaseUrl)||(e.analytics.nextApiBaseUrl=r.payload.nextApiBaseUrl),q(r.payload.trackingId)||(e.analytics.trackingId=r.payload.trackingId),q(r.payload.analyticsMode)||(e.analytics.analyticsMode=r.payload.analyticsMode);let n=(0,Xa.default)();n&&(e.analytics.analyticsMode="next",e.analytics.trackingId=n),q(r.payload.runtimeEnvironment)||(e.analytics.runtimeEnvironment=r.payload.runtimeEnvironment),q(r.payload.anonymous)||(e.analytics.anonymous=r.payload.anonymous),q(r.payload.deviceId)||(e.analytics.deviceId=r.payload.deviceId),q(r.payload.userDisplayName)||(e.analytics.userDisplayName=r.payload.userDisplayName),q(r.payload.documentLocation)||(e.analytics.documentLocation=r.payload.documentLocation)}).addCase(ht,e=>{e.analytics.enabled=!1,Qn(e.analytics)}).addCase(yt,e=>{e.analytics.enabled=!0}).addCase(pr,(e,r)=>{e.analytics.originLevel2=r.payload.originLevel2}).addCase(fr,(e,r)=>{e.analytics.originLevel3=r.payload.originLevel3}).addCase(za,(e,r)=>{e.analytics.originLevel2=r.payload}).addCase(Ha,(e,r)=>{e.analytics.originLevel2=r.payload.tab||e.analytics.originLevel2}));var Et=Za;function Gl(t){return t.instantlyCallable}var es=()=>t=>e=>t(Gl(e)?e():e);var ts=t=>()=>e=>r=>{var o;if(!r.error)return e(r);let n=r.error;if(((o=r.payload)==null?void 0:o.ignored)||t.error(n.stack||n.message||n.name||"Error",`Action dispatch error ${r.type}`,r),r.error.name!=="SchemaValidationError")return e(r)},rs=t=>e=>r=>n=>(t.debug({action:n,nextState:e.getState()},`Action dispatched: ${n.type}`),r(n));function ns(t,e){let r={...t},n,o=i=>(a,c)=>{let u=i(a,c);return n?n(u,c):u};return{get combinedReducer(){let i=jo(Object.entries(e).filter(([a])=>!(a in r)).map(([a,c])=>[a,()=>c]));return o(mr({...i,...r}))},containsAll(i){return Object.keys(i).every(c=>c in r)},add(i){Object.keys(i).filter(a=>!(a in r)).forEach(a=>r[a]=i[a])},addCrossReducer(i){n=i}}}function os(t,e,r){var n,o,i;e===void 0&&(e=50),r===void 0&&(r={});var a=(n=r.isImmediate)!=null&&n,c=(o=r.callback)!=null&&o,u=r.maxWait,s=Date.now(),d=[];function p(){if(u!==void 0){var m=Date.now()-s;if(m+e>=u)return u-m}return e}var g=function(){var m=[].slice.call(arguments),h=this;return new Promise(function(y,R){var b=a&&i===void 0;if(i!==void 0&&clearTimeout(i),i=setTimeout(function(){if(i=void 0,s=Date.now(),!a){var E=t.apply(h,m);c&&c(E),d.forEach(function(k){return(0,k.resolve)(E)}),d=[]}},p()),b){var w=t.apply(h,m);return c&&c(w),y(w)}d.push({resolve:y,reject:R})})};return g.cancel=function(m){i!==void 0&&clearTimeout(i),d.forEach(function(h){return(0,h.reject)(m)}),d=[]},g}function is(t,e){let r=0,n=os(()=>r=0,500);return o=>i=>async a=>{if(!(typeof a=="function"))return i(a);let u=await i(a);if(!Yl(u))return u;if(typeof e!="function")return t.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),u;if(r>=5)return t.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),u;r++,n();let s=await Jl(e);o.dispatch(je({accessToken:s})),o.dispatch(a)}}function Yl(t){var e;return((e=t==null?void 0:t.error)==null?void 0:e.name)===new Mt().name}async function Jl(t){try{return await t()}catch(e){return""}}function as({reducer:t,preloadedState:e,middlewares:r=[],thunkExtraArguments:n,name:o}){return xi({reducer:t,preloadedState:e,devTools:{stateSanitizer:i=>i.history?{...i,history:"<<OMIT>>"}:i,name:o,shouldHotReload:!1},middleware:i=>[...r,...i({thunk:{extraArgument:n}}),rs(n.logger)]})}var Xl={configuration:Et,version:Ua};function Zl(t,e){var a,c;let r=((a=t.configuration.organizationEndpoints)==null?void 0:a.analytics)||void 0,{analyticsClientMiddleware:n,...o}=(c=t.configuration.analytics)!=null?c:{},i={...o,nextApiBaseUrl:`${r}/rest/organizations/${t.configuration.organizationId}/events/v1`,apiBaseUrl:r};return rr()?(e.info("Analytics disabled since doNotTrack is active."),{...i,enabled:!1}):i}function ss(t,e){var u;let r=em(t,e),{accessToken:n,organizationId:o}=t.configuration,{organizationEndpoints:i}=t.configuration,a=(i==null?void 0:i.platform)||t.configuration.platformUrl;om(t)&&r.logger.warn(`The \`platformUrl\` (${t.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),nm(t)?r.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):im(t)&&r.logger.warn(`There is a mismatch between the \`organizationId\` option (${t.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${(u=t.configuration.organizationEndpoints)==null?void 0:u.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),r.dispatch(je({accessToken:n,organizationId:o,platformUrl:a}));let c=Zl(t,r.logger);return c&&r.dispatch(gt(c)),r}function em(t,e){var a;let{reducers:r}=t,n=ns({...Xl,...r},(a=t.preloadedState)!=null?a:{});t.crossReducer&&n.addCrossReducer(t.crossReducer);let o=e.logger,i=tm(t,e,n);return{addReducers(c){n.containsAll(c)||(n.add(c),i.replaceReducer(n.combinedReducer))},dispatch:i.dispatch,subscribe:i.subscribe,enableAnalytics(){i.dispatch(yt())},disableAnalytics(){i.dispatch(ht())},get state(){return i.getState()},logger:o,store:i}}function tm(t,e,r){let{preloadedState:n,configuration:o}=t,i=o.name||"coveo-headless",a=rm(t,e.logger);return as({preloadedState:n,reducer:r.combinedReducer,middlewares:a,thunkExtraArguments:e,name:i})}function rm(t,e){let{renewAccessToken:r}=t.configuration,n=is(e,r);return[es,n,ts(e),Va].concat(t.middlewares||[])}function nm(t){return xe(t.configuration.organizationEndpoints)}function om(t){var e;return!q(t.configuration.platformUrl)||q((e=t.configuration.organizationEndpoints)==null?void 0:e.platform)}function im(t){let{platform:e}=t.configuration.organizationEndpoints;if(xe(e))return!1;let r=nn(e);return r&&r.organizationId!==t.configuration.organizationId}var hs=Ie(gs());function ys(t){return(0,hs.default)({name:"@coveo/headless",level:(t==null?void 0:t.level)||"warn",formatters:{log:t==null?void 0:t.logFormatter}})}function vs(t,e){let r=xm(t),n=Tn,o=Am(t);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:o,logger:e}}function xm(t){let{analytics:e}=t,r=(n,o)=>o;return(e==null?void 0:e.analyticsClientMiddleware)||r}function Am(t){return t.preprocessRequest||Zt}var Ss={organizationId:H,accessToken:H,platformUrl:new L({required:!1,emptyAllowed:!1}),name:new L({required:!1,emptyAllowed:!1}),analytics:new $({options:{required:!1},values:{enabled:new Fe({required:!1}),originContext:new L({required:!1}),originLevel2:new L({required:!1}),originLevel3:new L({required:!1}),analyticsMode:new L({constrainTo:["legacy","next"],required:!1})}})};function bs(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",organizationEndpoints:nr("searchuisamples")}}var Cs=new j({...Ss,searchHub:V,locale:V,timezone:V});function po(){return{...bs(),searchHub:"default"}}var wm={searchHub:Mr,productRecommendations:wt};function Rs(t){let e=ys(t.loggerOptions);Pm(t.configuration,e);let r=Em(t.configuration,e),n={...vs(t.configuration,e),apiClient:r},o={...t,reducers:wm},i=ss(o,n),{searchHub:a,timezone:c,locale:u}=t.configuration;return i.dispatch(ft({timezone:c,locale:u})),q(a)||i.dispatch(Pt(a)),{...i,get state(){return i.state}}}function Pm(t,e){try{Cs.validate(t)}catch(r){throw e.error("Product Recommendation engine configuration error",r),r}}function Em(t,e){return new on({logger:e,preprocessRequest:t.preprocessRequest||Zt,postprocessSearchResponseMiddleware:Zo,postprocessFacetSearchResponseMiddleware:ei,postprocessQuerySuggestResponseMiddleware:ti})}function km(t){return t.addReducers({configuration:Et}),{disableAnalytics:ht,enableAnalytics:yt,setOriginLevel2:pr,setOriginLevel3:fr,updateAnalyticsConfiguration:gt,updateBasicConfiguration:je}}function Om(t){return t.addReducers({productRecommendations:wt}),{getProductRecommendations:Ue,setProductRecommendationsAdditionalFields:xt,setProductRecommendationsBrandFilter:Lr,setProductRecommendationsCategoryFilter:Nr,setProductRecommendationsMaxNumberOfRecommendations:At,setProductRecommendationsRecommenderId:Rt,setProductRecommendationsSkus:et}}function Im(t){return t.addReducers({}),{logProductRecommendationOpen:ja}}var Fm=new ue({each:H,required:!0}),xs=(t,e)=>(N(t,H),Xt(e)?N(e,H):N(e,Fm),{payload:{contextKey:t,contextValue:e}}),rt=F("context/set",t=>{for(let[e,r]of Object.entries(t))xs(e,r);return{payload:t}}),nt=F("context/add",t=>xs(t.contextKey,t.contextValue)),ot=F("context/remove",t=>N(t,H));function As(){return{contextValues:{}}}var Br=le(As(),t=>{t.addCase(rt,(e,r)=>{e.contextValues=r.payload}).addCase(nt,(e,r)=>{e.contextValues[r.payload.contextKey]=r.payload.contextValue}).addCase(ot,(e,r)=>{delete e.contextValues[r.payload]}).addCase(Ve.fulfilled,(e,r)=>{!r.payload||(e.contextValues=r.payload.context.contextValues)})});function Tm(t){return t.addReducers({context:Br}),{addContext:nt,removeContext:ot,setContext:rt}}var kt=F("dictionaryFieldContext/set",t=>{let e=new $({options:{required:!0}}),r=N(t,e).error;if(r)return{payload:t,error:r};let n=Object.values(t),o=new ue({each:Ye}),i=N(n,o).error;return i?{payload:t,error:i}:{payload:t}}),Ot=F("dictionaryFieldContext/add",t=>{let e=new $({options:{required:!0},values:{field:Ye,key:Ye}});return N(t,e)}),It=F("dictionaryFieldContext/remove",t=>N(t,Ye));function ws(){return{contextValues:{}}}var $r=le(ws(),t=>{t.addCase(kt,(e,r)=>{e.contextValues=r.payload}).addCase(Ot,(e,r)=>{let{field:n,key:o}=r.payload;e.contextValues[n]=o}).addCase(It,(e,r)=>{delete e.contextValues[r.payload]}).addCase(Ve.fulfilled,(e,r)=>{!r.payload||(e.contextValues=r.payload.dictionaryFieldContext.contextValues)})});function Dm(t){return t.addReducers({dictionaryFieldContext:$r}),{addContext:Ot,removeContext:It,setContext:kt}}function Lm(t){return t.addReducers({searchHub:Mr}),{setSearchHub:Pt}}function _e(t){let e,r=new Map,n=()=>r.size===0,o=i=>{try{let a=JSON.stringify(i),c=e!==a;return e=a,c}catch(a){return console.warn('Could not detect if state has changed, check the controller "get state method"',a),!0}};return{subscribe(i){i();let a=Symbol(),c;return n()&&(e=JSON.stringify(this.state),c=t.subscribe(()=>{o(this.state)&&r.forEach(u=>u())})),r.set(a,i),()=>{r.delete(a),n()&&c&&c()}},get state(){return{}}}}var W={additionalFields:new ue({required:!1,each:V}),skus:new ue({required:!1,each:V}),maxNumberOfRecommendations:new Qe({required:!1,max:50,min:1,default:5})},Nm=new j({id:H,...W}),ne=(t,e={})=>{if(!Mm(t))throw at;let r=_e(t),{dispatch:n}=t,o=()=>t.state,i=J(t,Nm,e.options,"buildBaseProductRecommendationsList");return n(Rt({id:i.id})),n(At({number:i.maxNumberOfRecommendations})),i.additionalFields&&n(xt({additionalFields:i.additionalFields})),i.skus&&n(et({skus:i.skus})),{...r,setSkus(a){n(et({skus:a}))},refresh(){n(Ue())},get state(){let{skus:a,maxNumberOfRecommendations:c,recommendations:u,error:s,isLoading:d}=o().productRecommendations;return{skus:a,maxNumberOfRecommendations:c,recommendations:u,error:s,isLoading:d}}}};function Mm(t){return t.addReducers({productRecommendations:wt,configuration:Et}),!0}var jm=new j({sku:new L({required:!0,emptyAllowed:!1}),maxNumberOfRecommendations:W.maxNumberOfRecommendations,additionalFields:W.additionalFields});function Ps(t,e){let r=J(t,jm,e.options,"buildFrequentlyBoughtTogetherList"),n=ne(t,{...e,options:{maxNumberOfRecommendations:r.maxNumberOfRecommendations,additionalFields:r.additionalFields,skus:[r.sku],id:"frequentBought"}}),{setSkus:o,...i}=n;return{...i,setSku(a){o([a])},get state(){let{skus:a,...c}=n.state;return{...c,sku:a[0]}}}}var qm=new j({...W});function Es(t,e){let r=J(t,qm,e.options,"buildCartRecommendationsList");return ne(t,{...e,options:{...r,id:"cart"}})}var Um=new j({...W});function ks(t,e){let r=J(t,Um,e.options,"buildFrequentlyViewedTogetherList");return ne(t,{...e,options:{...r,id:"frequentViewed"}})}var Vm=new j({maxNumberOfRecommendations:W.maxNumberOfRecommendations,additionalFields:W.additionalFields});function Os(t,e={}){let r=J(t,Vm,e.options,"buildPopularBoughtRecommendationsList"),n=ne(t,{...e,options:{...r,id:"popularBought"}}),{setSkus:o,...i}=n;return{...i,get state(){let{skus:a,...c}=n.state;return{...c}}}}var _m=new j({maxNumberOfRecommendations:W.maxNumberOfRecommendations,additionalFields:W.additionalFields});function Is(t,e={}){let r=J(t,_m,e.options,"buildPopularViewedRecommendationsList"),n=ne(t,{...e,options:{...r,id:"popularViewed"}}),{setSkus:o,...i}=n;return{...i,get state(){let{skus:a,...c}=n.state;return{...c}}}}var Bm=new j({maxNumberOfRecommendations:W.maxNumberOfRecommendations,additionalFields:W.additionalFields});function Fs(t,e){let r=J(t,Bm,e.options,"buildUserInterestRecommendationsList"),n=ne(t,{...e,options:{...r,id:"user"}}),{setSkus:o,...i}=n;return{...i,get state(){let{skus:a,...c}=n.state;return{...c}}}}var $m=["caseId","caseNumber"],Hm={caseId:"caseContext",caseNumber:"caseContext"},Hr=class extends Error{constructor(e){super(`The key "${e}" is reserved for internal use. Use ${Hm[e]} to set this value.}`)}};function fo(t){return $m.includes(t)}var zm=new j({values:new $({options:{required:!1}})});function Ts(t,e={}){if(!Km(t))throw at;let r=_e(t),{dispatch:n}=t,o=()=>t.state,i=ki(t,zm,e.initialState,"buildContext");return i.values&&n(rt(i.values)),{...r,get state(){return{values:o().context.contextValues}},set(a){n(rt(a))},...o().configuration.analytics.analyticsMode==="legacy"?Qm(n):Wm(n)}}var Qm=t=>({add(e,r){t(nt({contextKey:e,contextValue:r}))},remove(e){t(ot(e))}}),Wm=t=>({add(e,r){if(fo(e))throw new Hr(e);t(nt({contextKey:e,contextValue:r}))},remove(e){if(fo(e))throw new Hr(e);t(ot(e))}});function Km(t){return t.addReducers({context:Br}),!0}function Ds(t,e){return Ts(t,e)}function Ls(t){if(!Gm(t))throw at;let e=_e(t),{dispatch:r}=t,n=()=>t.state;return{...e,get state(){return{values:n().dictionaryFieldContext.contextValues}},set(o){r(kt(o))},add(o,i){r(Ot({field:o,key:i}))},remove(o){r(It(o))}}}function Gm(t){return t.addReducers({dictionaryFieldContext:$r}),!0}var Ym=new j({...W});function Ns(t,e){let r=J(t,Ym,e.options,"buildFrequentlyViewedSameCategoryList");return ne(t,{...e,options:{...r,id:"frequentViewedSameCategory"}})}var Jm=new j({...W});function Ms(t,e){let r=J(t,Jm,e.options,"buildFrequentlyViewedDifferentCategoryList");return ne(t,{...e,options:{...r,id:"frequentViewedDifferentCategory"}})}ho();
/**
 * @license
 *
 * Copyright 2023 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
}));
//# sourceMappingURL=headless.js.map
